{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83d\ude80Bem-Vindo ao Portal de Documenta\u00e7\u00e3o da Facile Sistemas!","text":"<p>P\u00e1gina destinada a centralizar as documenta\u00e7\u00f5es e manuais das aplica\u00e7\u00f5es desenvolvidas e comercializadas pela Facile Sistemas.</p> <p>Aqui no Facile Docs, voc\u00ea encontra as informa\u00e7\u00f5es necess\u00e1rias para implantar, configurar e utilizar todas as nossas ferramentas. </p> <p>Nossas aplica\u00e7\u00f5es s\u00e3o para uso e benef\u00edcio dos nossos clientes, caso voc\u00ea queira utilizar nossas solu\u00e7\u00f5es em sua empresa entre em contato com nossa equipe comercial clicando aqui ou enviando e-mail para comercial@facilesistemas.com.br .</p>"},{"location":"#aplicacoes-disponiveis","title":"Aplica\u00e7\u00f5es dispon\u00edveis","text":""},{"location":"#facile-xml-e","title":"Facile XML-e","text":"<p>O mais completo gerenciador de NF-e, CT-e e NFS-e diretamente no seu ERP. </p> <p>Otimize tempo, diminua os processos, tenha seguran\u00e7a e economize!</p> <ul> <li> <p>Download de XML</p> </li> <li> <p>Facilitadores de lan\u00e7amento e checagem de pedidos</p> </li> <li> <p>Gest\u00e3o por KPI erelat\u00f3rios</p> </li> <li> <p>Alerta de impostos</p> </li> <li> <p>Diretamente do SEFAZ, sem nuvem!</p> </li> </ul>"},{"location":"#cifa-automacao-financeira","title":"CIFA - Automa\u00e7\u00e3o Financeira","text":"<p>Estamos colaborando para a constru\u00e7\u00e3o do futuro das integra\u00e7\u00f5es com as institui\u00e7\u00f5es banc\u00e1rias.</p> <ul> <li> <p>Nunca mais utilize CNAB</p> </li> <li> <p>Rob\u00f4s fazendo o trabalho pesado do financeiro da sua empresa</p> </li> <li> <p>T\u00edtulos conciliados automaticamente</p> </li> <li> <p>Tecnologia de ponta com seguran\u00e7a</p> </li> <li> <p>Comunica\u00e7\u00e3o via API diretamente com a institui\u00e7\u00e3o banc\u00e1ria</p> </li> </ul>"},{"location":"#farm-integracao-de-apis","title":"FARM - Integra\u00e7\u00e3o de API's","text":"<p>Interligando aplica\u00e7\u00f5es de ponta a ponta atrav\u00e9s de rob\u00f4s inteligentes.</p> <ul> <li> <p>ERP comunicando com e-commerces </p> </li> <li> <p>For\u00e7as de vendas atualizando diretamente com seus sistemas</p> </li> <li> <p>REST ou SOAP, para o FARM n\u00e3o importa!</p> </li> <li> <p>Agendamentos personalizados</p> </li> </ul>"},{"location":"#facin-sales","title":"Facin Sales","text":"<p>Potencialize suas vendas externas com essa excelente ferramenta, tornando o processo de venda simples e \u00e1gil.</p> <p>Controle o estoque de sua empresa, clientes e fluxo de mercadorias, integrado ao ERP Protheus com tecnologias modernas da Web e Mobile.</p> <ul> <li> <p>Permita que suas vendas externas ocorram com mais velocidade e qualidade, independente da conex\u00e3o com a internet-</p> </li> <li> <p>For\u00e7a de Vendas Autonomia e agilidade em seu sistema para garantir o melhor fluxo de vendas para voc\u00ea e o seu cliente.</p> </li> <li> <p>Tecnologia Moderna Experimente o que h\u00e1 de mais novo no mercado de tecnologia, unindo a pot\u00eancia das vendas no celular com a qualidade de gest\u00e3o em um Painel Web.</p> </li> <li> <p>Controle na palma da m\u00e3o Tenha controle total de suas mercadorias, estoque, clientes e vendas!</p> </li> </ul>"},{"location":"#principais-funcionalidades","title":"Principais Funcionalidades","text":"<p>\u2714 Aplicativo off-line (venda mesmo sem internet) \u2714 Multi empresas e filiais \u2714 Funciona independente de outros sistemas integrados \u2714 Cadastro e controle de Prospects e Clientes \u2714 M\u00faltiplas tabelas de pre\u00e7o e frete \u2714 Controle de metas dos vendedores \u2714 Controle de comiss\u00f5es \u2714 Registro de vendas n\u00e3o realizadas \u2714 Or\u00e7amentos por e-mail e WhatsApp \u2714 Painel de Gest\u00e3o Web</p> <p>Entre v\u00e1rias outras...</p>"},{"location":"#suporte","title":"Suporte","text":"<p>Para suporte espec\u00edfico favor registrar o ticket no portal: Central de Tickets</p>"},{"location":"cifa/","title":"Introdu\u00e7\u00e3o","text":""},{"location":"cifa/#cifa-central-inteligencia-financeira-automatica","title":"CIFA - Central Intelig\u00eancia Financeira Autom\u00e1tica","text":""},{"location":"cifa/#como-funciona-o-sistema-cifa","title":"Como funciona o sistema CIFA...","text":"<p>Reduza em at\u00e9 99% o trabalho de  concilia\u00e7\u00e3o da cobran\u00e7a Banc\u00e1ria</p> <ul> <li>Emita seus boletos automaticamente</li> <li>Disponibilize para seus clientes em todas as plataformas</li> <li>Cliente pagou? \u00d3timo, deixa que n\u00f3s conciliamos para voc\u00ea</li> <li>Acelera os processos financeiros</li> <li>Evita erros humanos e preju\u00edzos com retrabalho</li> <li>Gera liberdade para que seu neg\u00f3cio possa crescer</li> </ul> <p>Gostaria de ver funcionando na pr\u00e1tica!</p>"},{"location":"cifa/#video-de-apresentacao-da-ferramenta","title":"V\u00eddeo de apresenta\u00e7\u00e3o da ferramenta","text":""},{"location":"cifa/download-patch/","title":"Download do Patch","text":""},{"location":"cifa/download-patch/#patch-atualizado-cifa","title":"\u2b07\ufe0fPatch Atualizado CIFA","text":"<p>Fa\u00e7a o download do patch atualizado compat\u00edvel com a vers\u00e3o do seu ERP.</p> <p>Clique aqui para baixar</p> <p>Quando aplicar o patch de implanta\u00e7\u00e3o, dever\u00e1 ser utilizado o compatibilizador:\u00a0U_UPDCFBD</p>"},{"location":"xmle/","title":"\ud83d\udcc3Facile XML-e","text":""},{"location":"xmle/#o-que-e","title":"O que \u00e9?","text":"<p>O mais completo gerenciador de NF-e, CT-e e NFS-e diretamente no seu ERP. </p> <p>Otimize tempo, diminua os processos, tenha seguran\u00e7a e economize!</p> <p>Uma ferramenta integrada ao ERP visando controle e agilidade nos processos de entrada de documento eletr\u00f4nico e Confronto de Impostos.</p>"},{"location":"xmle/#posso-testar","title":"Posso testar?","text":"<p>Sim, voc\u00ea pode estar aplicando o Facile XML-e em seu ERP e experimenta-lo de forma totalmente gratu\u00edta e sem compromisso, n\u00e3o precisa assinar nada para isso!</p> <p>Basta enviar um e-mail para: xmle@facilesistemas.com.br</p>"},{"location":"xmle/#como-funciona","title":"Como Funciona?","text":"<p>A Ferramenta FACILE XML-e possui uma rotina que trabalha de maneira autom\u00e1tica e transparente, monitorando no SEFAZ os documentos fiscais emitidos pelos fornecedores e disponibilizando diversas funcionalidades no ERP como: Manifesta\u00e7\u00e3o do Destinat\u00e1rio, Importa\u00e7\u00e3o do XML, Relat\u00f3rios, Confronto de Impostos calculados pelo ERP versus Impostos do XML, entre outros.</p> <p></p>"},{"location":"xmle/#_1","title":"Introdu\u00e7\u00e3o","text":""},{"location":"xmle/#principais-beneficios","title":"Principais Benef\u00edcios","text":"<ul> <li> <p>Download e XML</p> </li> <li> <p>Facilitadores de lan\u00e7amento e checagem de pedidos</p> </li> <li> <p>Gest\u00e3o por KPI erelat\u00f3rios</p> </li> <li> <p>Alerta de impostos</p> </li> <li> <p>Controle total sobre os documentos eletr\u00f4nicos emitidos contra a sua empresa</p> </li> <li> <p>Atender a lei de manifesta\u00e7\u00e3o do destinat\u00e1rio</p> </li> <li> <p>Convers\u00e3o de Unidade de Medida personalizada por Fornecedor</p> </li> <li> <p>Diversos Pontos de Entrada para customiza\u00e7\u00f5es</p> </li> <li> <p>Diretamente do SEFAZ, sem nuvem!</p> </li> </ul> <p></p>"},{"location":"xmle/#e-ainda-tem-mais","title":"E ainda tem mais...","text":"<ul> <li> <p>Consulta avan\u00e7ada de produtos, diminuindo os erros na amarra\u00e7\u00e3o Produto X fornecedor</p> </li> <li> <p>Cadastro de Fornecedor baseado no XML</p> </li> <li> <p>Impress\u00e3o da DANFE/DACTE baseado no XML direto no ERP</p> </li> <li> <p>Exporta\u00e7\u00e3o do XML para arquivo no computador</p> </li> <li> <p>Ferramenta pronta para a valida\u00e7\u00e3o do CEST</p> </li> <li> <p>Amarra\u00e7\u00e3o Pedido de Compras X CT-e</p> </li> <li> <p>Regras inteligentes para gera\u00e7\u00e3o autom\u00e1tica do documento de entrada</p> </li> </ul>"},{"location":"xmle/#_2","title":"Introdu\u00e7\u00e3o","text":""},{"location":"xmle/#checkdoc","title":"CheckDoc","text":""},{"location":"xmle/#_3","title":"Introdu\u00e7\u00e3o","text":""},{"location":"xmle/#confronto-de-impostos","title":"Confronto de Impostos","text":""},{"location":"xmle/#_4","title":"Introdu\u00e7\u00e3o","text":""},{"location":"xmle/#configuracoes-simplificadas","title":"Configura\u00e7\u00f5es simplificadas","text":""},{"location":"xmle/#_5","title":"Introdu\u00e7\u00e3o","text":""},{"location":"xmle/#suporte","title":"Suporte","text":"<p>Para suporte espec\u00edfico favor registrar o ticket no portal: Central de Tickets</p>"},{"location":"xmle/dicionario-dados/","title":"\ud83d\udcc5Dicion\u00e1rio de Dados","text":"<p>Segue documenta\u00e7\u00e3o do dicion\u00e1rio de dados criado pela ferramenta.</p>"},{"location":"xmle/dicionario-dados/#tabela-zzw-produto-x-fornecedor-xml-e","title":"Tabela ZZW - Produto x Fornecedor XML-e","text":""},{"location":"xmle/dicionario-dados/#campos","title":"Campos","text":"Campo Tipo Tam. Dec. Descri\u00e7\u00e3o Completa ZZW_FILIAL C 2 0 Filial Filial do Sistema ZZW_FORNEC C 6 0 Fornecedor Codigo do Fornecedor ZZW_LOJA C 2 0 Loja Loja do Fornecedor ZZW_NOMFOR C 40 0 Nome Fornec. Nome do Fornecedor ZZW_CODPRF C 30 0 Cod.Prod.For Codigo do Produto no Forn ZZW_PRODUT C 15 0 Produto Codigo do Produto ZZW_NOMPRO C 40 0 Descricao Nome do Produto ZZW_SEGUM C 2 0 Seg.Uni.Med. Segunda Unidade de Medida ZZW_CONV N 5 2 Fator Conv. Fator Conversao ZZW_TIPCON C 1 0 Tipo de Conv Tipo de Conversao ZZW_DPRODF C 90 0 Desc.Prd.For Descricao Prod Fornecedor ZZW_CLIFOR C 1 0 Cliente/Forn Cliente ou Fornecedor"},{"location":"xmle/dicionario-dados/#indices","title":"\u00cdndices","text":"Ordem Chave 1 ZZW_FILIAL + ZZW_FORNEC + ZZW_LOJA + ZZW_CODPRF + ZZW_PRODUT 2 ZZW_FILIAL + ZZW_FORNEC + ZZW_LOJA + ZZW_PRODUT 3 ZZW_FILIAL + ZZW_CLIFOR + ZZW_FORNEC + ZZW_LOJA + ZZW_CODPRF + ZZW_PRODUT"},{"location":"xmle/dicionario-dados/#_1","title":"Dicion\u00e1rio de Dados","text":""},{"location":"xmle/dicionario-dados/#tabela-zzz-documentos-gerenciados","title":"Tabela ZZZ - Documentos Gerenciados","text":""},{"location":"xmle/dicionario-dados/#campos_1","title":"Campos","text":"Campo Tipo Tam. Dec. Descri\u00e7\u00e3o Completa ZZZ_FILIAL C 2 0 Filial Filial do Sistema ZZZ_SITDOC C 1 0 Sit. NF-e Situacao da Nota Fiscal ZZZ_TIPO C 1 0 Tipo XML Tipo de XML ZZZ_STATUS C 1 0 Manif. Atual Status da Manifestacao ZZZ_DOC C 9 0 Nota Fiscal Numero da Nota Fiscal ZZZ_SERIE C 3 0 Serie Serie da Nota Fiscal ZZZ_EMISNF D 8 0 Emissao NF Data Emissao da NF ZZZ_CNPJ C 14 0 CNPJ Fornece CNPJ Fornecedor ZZZ_NOEMIT C 60 0 Nome/Razao Nome/Razao ZZZ_CHAVE C 60 0 Chave NF Chave da Nota Fiscal ZZZ_CODEVE C 3 0 Cod.Evento Status do Evento ZZZ_XML M 10 0 XML XML ZZZ_DTRECB D 8 0 Data Recebto Data de Recebimento ZZZ_ORIGEM C 1 0 Origem XML Origem XML ZZZ_OK C 4 0 OK OK ZZZ_VLDOC N 13 2 Valor NF-e Valor NF-e ZZZ_ANONFE C 4 0 Ano Emissao Ano Emissao NFe ZZZ_MESNFE C 2 0 Mes Emissao Mes Emissao da NFE ZZZ_IEEMIT C 11 0 Inscr. Est. Inscricao Estadual emiten ZZZ_DESRES C 150 0 Desc.Proces. Descricao do Processament ZZZ_CODRET C 3 0 Cod.Process. Status da Resposta ZZZ_DTREC D 8 0 Data Aut. Data recebimento ZZZ_UF C 2 0 Estado Estado de Origem ZZZ_ENVMAI C 1 0 Mail Enviado E-Mail Enviado ZZZ_NSU C 40 0 NSU NSU ZZZ_PEDCHK C 1 0 Ped. Checado Pedido Compra verificado ZZZ_PEDOBS M 10 0 Obs Ped Comp Observacao Pedido Compra ZZZ_YHORA C 5 0 Hora Hora do download XML ZZZ_ECKDOC C 1 0 Email CkDoc Email Enviado pelo CKDoc ZZZ_PDF M 10 0 Doc. PDF Documento PDF ZZZ_PROVID C 50 0 Provider Provedor de XML"},{"location":"xmle/dicionario-dados/#_2","title":"Dicion\u00e1rio de Dados","text":""},{"location":"xmle/dicionario-dados/#indices_1","title":"\u00cdndices","text":"Ordem Chave 1 ZZZ_FILIAL + ZZZ_CHAVE 2 ZZZ_FILIAL + ZZZ_CNPJ + ZZZ_DOC + ZZZ_SERIE 3 ZZZ_FILIAL + ZZZ_DOC + ZZZ_SERIE + ZZZ_CNPJ 4 ZZZ_FILIAL + ZZZ_EMISNF + ZZZ_CNPJ"},{"location":"xmle/dicionario-dados/#_3","title":"Dicion\u00e1rio de Dados","text":""},{"location":"xmle/dicionario-dados/#tabela-sd1-itens-documento-de-entrada","title":"Tabela SD1 - Itens Documento de Entrada","text":""},{"location":"xmle/dicionario-dados/#campos_2","title":"Campos","text":"Campo Tipo Tam. Dec. Descri\u00e7\u00e3o Completa D1_ZPEDIDO C 6 0 Pedido Temp Pedido Temporario D1_ZITEMPD C 4 0 Item Temp Item Temporario D1_ZITEMOR C 4 0 Item Orig Item Original D1_ZNFIMP C 1 0 NF Importada NF Importada D1_ZITEXML C 5 0 Item no XML Item no XML"},{"location":"xmle/dicionario-dados/#tabela-sx6-parametros-do-sistema","title":"Tabela SX6 - Par\u00e2metros do Sistema","text":"Par\u00e2metros Tipo Descri\u00e7\u00e3o ZZ_ARMZPED L Informa se busca o Armazem do Produto no Pedido de Compras (C7_LOCAL) ZZ_AUTHLOG C Nome de usu\u00e1rio fornecido pela Facile ZZ_AUTHPSW C Senha fornecida pela Facile ZZ_CERTCA C Caminho do arquivo CA.PEM ZZ_CERTKEY C Caminho do arquivo KEY.PEM ZZ_CERTPRI C Caminho do arquivo CERT.PEM ZZ_CIENAUT L Manifesta ci\u00eancia da opera\u00e7\u00e3o automaticamente? ZZ_CLASSIF L Ativa a abertura da classifica\u00e7\u00e3o do documento automaticamente ao gerar pr\u00e9-nota? ZZ_CODEAUT L Ativa autentica\u00e7\u00e3o na Facile ZZ_CONFAUT C Tipo de tratativa para transmissao da confirmacao da operacao ZZ_CONFFIS L Ativa integra\u00e7\u00e3o com o m\u00f3dulo ACD Protheus para confer\u00eancia Cega pelo\u00a0FACILE\u00a0XML-e. Necess\u00e1rio tamb\u00e9m ativar o MV_CONFFIS. ZZ_CTECAUT L Ativa a importa\u00e7\u00e3o autom\u00e1tica do CTE de Compra ZZ_CTECSPE L Especie do CTE de compra na entrada. Caso n\u00e3o exista, \u00e9 definido como CTE. ZZ_CTEVAUT L Ativa a importa\u00e7\u00e3o autom\u00e1tica do CTE de Venda ZZ_CTEVSPE L Especie do CTE de venda na entrada. Caso n\u00e3o exista, \u00e9 definido como CTE. ZZ_DADOSB1 L Busca dados cont\u00e1beis no cadastro\u00a0do\u00a0produto. ZZ_DCTECP N At\u00e9 quantos dias para tr\u00e1s deve buscar os CT-e de Compra ZZ_DCTEVD N At\u00e9 quantos dias para tr\u00e1s deve buscar os CT-e de Venda ZZ_DEBUG L Ativa o modo Debug no console do appserver ZZ_DELMAIL L Deleta o e-mail da caixa de correio apos o download do XML? ZZ_DESTFIS C Destinatarios para workflow de\u00a0 mudan\u00e7as de status das NFe ZZ_FILATIV L Desabilita a baixa de determinada Filial\u00a0no\u00a0FACILE\u00a0XML-e. Preencher como .F. para desativar a filial. ZZ_GRPBLOQ C Id dos Grupos de Usu\u00e1rios autorizados a bloquear/desbloquear documentos, separados por barra. Ex.: 000001/000010/000025 ZZ_MAILXML L Ativa busca de XML no e-mail ZZ_MUDASE3 L Possibilita o usu\u00e1rio de alterar a s\u00e9rie da NFS-e no momento do lan\u00e7amento ZZ_NFSEAUT L Ativa a importa\u00e7\u00e3o autom\u00e1tica da NFS-e ZZ_NFSESER C Altera a s\u00e9rie padr\u00e3o das NFS-e. Importante: S\u00f3 utilizar\u00e1 a s\u00e9rie personalizada caso n\u00e3o exista s\u00e9rie no XML da NFS-e. ZZ_NFSESPE C Altera a esp\u00e9cie padr\u00e3o das NFS-e ZZ_OPERNFS C Tipo de opera\u00e7\u00e3o para busca de TES Inteligente na NFSe ZZ_OPERCOM C Tipo de opera\u00e7\u00e3o para entrada normal ZZ_OPECTEC C Tipo de opera\u00e7\u00e3o para busca de TES Inteligente no CTE ZZ_OPECTEV C Tipo de opera\u00e7\u00e3o para busca de TES Inteligente no CTE ZZ_OPERTRA C Tipo de opera\u00e7\u00e3o para transfer\u00eancias ZZ_PCCTE L Ativa a solicita\u00e7\u00e3o de pedido de compras na entrada de CTE de Venda ZZ_PCOBRIG L Obrigat\u00f3rio vincular pedido de compra em todos os itens ZZ_POPCNT C Conta de e-mail para conex\u00e3o POP ZZ_POPEND C Endereco do servidor POP de e-mail ZZ_POPPSW C Senha da Conta de e-mail para conex\u00e3o POP ZZ_POPSSL L Utiliza conexao segura para acesso POP ao e-mail ZZ_PRODCTE C Produto padr\u00e3o para entrada de CT-e ZZ_PSWENTR C Senha que autoriza entrada com diverg\u00eancia de impostos ZZ_TESCTE C TES padr\u00e3o para entrada de CT-e ZZ_TESCTEC C TES padr\u00e3o para entrada de CT-e de Compra ZZ_TIMEUPD N Tempo de refresh da tela de gest\u00e3o \u00e0 vista (minutos) ZZ_ULTNSU C Ultimo NSU de\u00a0busca\u00a0para\u00a0NFe ZZ_UPDEAN L Atualiza o EAN no campo B1_CODBAR de acordo com o XML ZZ_VERSAOM C Vers\u00e3o do webservice Sefaz ZZ_VLDCEST L Ativa a validacao do CEST ZZ_VLDCOFI L Ativa valida\u00e7\u00e3o de COFINS na classifica\u00e7\u00e3o ZZ_VLDICMS L Ativa valida\u00e7\u00e3o de ICMS na classifica\u00e7\u00e3o ZZ_VLDIPI L Ativa valida\u00e7\u00e3o de IPI na classifica\u00e7\u00e3o ZZ_VLDNCM C Regra de valida\u00e7\u00e3o de NCM na classifica\u00e7\u00e3o ZZ_VLDNFE L Desativa (.T.) a tela de confronto de dados entre XML e ERP ZZ_VLDPIS L Ativa valida\u00e7\u00e3o de PIS na classifica\u00e7\u00e3o ZZ_VLDST L Ativa valida\u00e7\u00e3o de ICMS ST na classifica\u00e7\u00e3o ZZ_XMLAUTO L Informa se ir\u00e1 baixar o XML automaticamente via JOB"},{"location":"xmle/download-patch/","title":"Download do Patch","text":""},{"location":"xmle/download-patch/#patch-atualizado-facile-xml-e","title":"\u2b07\ufe0fPatch Atualizado Facile XML-e","text":"<p>Fa\u00e7a o download do patch atualizado compat\u00edvel com a vers\u00e3o do seu ERP.</p> <p>Clique aqui para baixar</p> <p>Quando aplicar o patch de atualiza\u00e7\u00e3o, favor aplicar no RPO de Produ\u00e7\u00e3o e no RPO do FACILE\u00a0XML-e.</p>"},{"location":"xmle/download-patch/#como-verificar-a-versao-atual-do-facile-xml-e-na-sua-base","title":"Como verificar a vers\u00e3o atual do Facile XML-e na sua base?","text":"<p>Abra o Central XML-e (PTX0001) no canto superior esquerdo da tela est\u00e1 a vers\u00e3o da ferramenta ap\u00f3s o \"XML-e\", exemplo abaixo.</p> <p> Figura 1: Vers\u00e3o do patch</p>"},{"location":"xmle/prefeituras/","title":"Prefeituras Homologadas","text":"<p>O Facile XML-e j\u00e1 est\u00e1 100% integrado ao NFS-e Nacional, ambiente em que ser\u00e1 concentrada a emiss\u00e3o de todas as NFS-e do Brasil (semelhante ao que ocorre com a NF-e atrav\u00e9s do Sefaz Nacional).</p> <p>A cada dia que passa mais prefeituras aderem a NFS-e Nacional, em pouco tempo teremos todas as prefeituras neste ambiente que j\u00e1 \u00e9 integrado automaticamente ao Facile XML-e.</p> <p>Segue link com a rela\u00e7\u00e3o de prefeituras que j\u00e1 aderiram a NFS-e Nacional: Prefeituras Homologadas</p> <p>S\u00e3o 1022 prefeituras aderidas neste momento (Mar\u00e7o) e esse n\u00famero vem aumentando a cada m\u00eas.</p>"},{"location":"xmle/release-notes/","title":"\ud83d\udcddNotas de Vers\u00e3o","text":"<p>Detalhes das atualiza\u00e7\u00f5es liberadas da ferramenta.</p>"},{"location":"xmle/release-notes/#versao-4335070","title":"Vers\u00e3o 4.33.5070","text":"<p>31/03/2025</p> <ul> <li>MELHORIA: Impress\u00e3o da DANFSe (Nota Fiscal de Servi\u00e7o) importadas via WebService de prefeituras</li> <li>MELHORIA: Inclu\u00eddo funcionalidade de lan\u00e7amento de CTE de Venda complementar</li> <li>MELHORIA: Adicionado o monitoramento em seguida a manifesta\u00e7\u00e3o</li> <li>MELHORIA: Inclu\u00eddo entrada de NF-e de complemento de IPI</li> <li>MELHORIA: Criado ponto de entrada CHECKPED para informar o pedido de compra na execu\u00e7\u00e3o do CheckDoc</li> <li>MELHORIA: Criado novo JOB no CheckDoc para reprocessar as an\u00e1lises sem o envio do workflow</li> <li>BUG: Corrigido erro de vari\u00e1vel inv\u00e1lida ao buscar os dados do CTE Completo</li> <li>BUG: Corre\u00e7\u00e3o na atualiza\u00e7\u00e3o da legenda ap\u00f3s a transmiss\u00e3o da confirma\u00e7\u00e3o da opera\u00e7\u00e3o</li> </ul>"},{"location":"xmle/release-notes/#versao-4335069","title":"Vers\u00e3o 4.33.5069","text":"<p>31/01/2025</p> <ul> <li>MELHORIA: Criado par\u00e2metro ZZ_CTEOSPE para indicar a especie (F1_ESPECIE) a ser utilizada na entrada do CTE</li> <li>MELHORIA: Inclu\u00eddo data de fabrica\u00e7\u00e3o da devolu\u00e7\u00e3o de venda</li> <li>MELHORIA: Disponibilizando a funcionalidade para cadastro de fornecedor para as NF-e, e ampliando para disponibilizar a mesma automa\u00e7\u00e3o para clientes</li> <li>MELHORIA: Impress\u00e3o da DANFSe (Nota Fiscal de Servi\u00e7o)</li> <li>BUG: Corre\u00e7\u00e3o para desbloquear o documento ap\u00f3s transmitir a confirma\u00e7\u00e3o da opera\u00e7\u00e3o.</li> <li>BUG: Ajuste para CTE Complementar de compra</li> </ul>"},{"location":"xmle/release-notes/#versao-4335068","title":"Vers\u00e3o 4.33.5068","text":"<p>Para essa vers\u00e3o, favor executar o compatibilizador apropriado para o seu ambiente.</p> <p>04/12/2024</p> <ul> <li>MELHORIA: Novo campo para identificar o tipo de documento na tabela ZZZ</li> <li>MELHORIA: Novo campo para identificar se a NF \u00e9 de Entrada ou Sa\u00edda do fornecedor</li> <li>MELHORIA: Refatorado o html do e-mail de documentos cancelados para ficar mais leve e clean</li> <li>MELHORIA: Somente atualizar o status da manifesta\u00e7\u00e3o (ZZZ_STATUS) quando for aceito pelo Sefaz entrando no Monitorar</li> <li>MELHORIA: Informa\u00e7\u00e3o do CFOP no relat\u00f3rio de documentos</li> <li>MELHORIA: Inclus\u00e3o da baixa dos XMLs do CTEOS</li> <li>BUG: Corre\u00e7\u00e3o no relat\u00f3rio de documentos PTXR008 na busca da UF do fornecedor</li> </ul>"},{"location":"xmle/release-notes/#versao-4335067","title":"Vers\u00e3o 4.33.5067","text":"<p>28/10/2024</p> <ul> <li>MELHORIA: Inclu\u00eddo op\u00e7\u00e3o de estornar a classifica\u00e7\u00e3o da NF-e</li> <li>MELHORIA: Inclu\u00eddo mais op\u00e7\u00f5es de filtro na rotina de monitoramento da manifesta\u00e7\u00e3o</li> <li>BUG: Inclu\u00eddo as informa\u00e7\u00f5es complementares do CT-e no DACTE</li> <li>BUG: Corre\u00e7\u00e3o no \"Buscar Sefaz\" do CT-e</li> <li>BUG: Passar a tratar o tipo de CT-e para imprimir o DACTE</li> </ul>"},{"location":"xmle/release-notes/#versao-4335066","title":"Vers\u00e3o 4.33.5066","text":"<p>18/09/2024</p> <ul> <li>MELHORIA: Inclu\u00eddo o ponto de entrada PX011CTE tamb\u00e9m na rotina de entrada autom\u00e1tica de CTE</li> <li>MELHORIA: Adicionado a funcionalidade de importa\u00e7\u00e3o de NF-e de complemento de ICMS</li> <li>MELHORIA: Adicionado a informa\u00e7\u00e3o da UF do fornecedor no relat\u00f3rio de status das NF-e</li> <li>BUG: Mudan\u00e7a na URL da prefeitura de Cachoeiro de Itapemirim</li> <li>BUG: Removido valida\u00e7\u00e3o de status do documento ao acessar rotina de exportar XML</li> <li>BUG: Corre\u00e7\u00e3o na atualiza\u00e7\u00e3o da legenda ap\u00f3s excluir um CTE de Compras lan\u00e7ado</li> <li>BUG: Corre\u00e7\u00e3o no primeiro painel do gest\u00e3o a vista (Notas n\u00e3o classificadas)</li> <li>BUG: Corre\u00e7\u00e3o para liberar o bloqueio de entrada de documento quando \u00e9 realizado a manifesta\u00e7\u00e3o da confirma\u00e7\u00e3o da opera\u00e7\u00e3o</li> </ul>"},{"location":"xmle/release-notes/#versao-4335065","title":"Vers\u00e3o 4.33.5065","text":"<p>01/08/2024</p> <ul> <li>BUG: Ajustes no checkdoc para ambiente Oracle</li> <li>BUG: Corre\u00e7\u00e3o na legenda para NF de opera\u00e7\u00e3o n\u00e3o realizada</li> <li>BUG: inclu\u00eddo c\u00f3digo do item no execauto da NF-e</li> <li>MELHORIA: Inclus\u00e3o da busca de NFS-e direto na prefeitura de Uberaba-MG</li> </ul>"},{"location":"xmle/release-notes/#versao-4335064","title":"Vers\u00e3o 4.33.5064","text":"<p>26/06/2024</p> <ul> <li>MELHORIA: Criado parametro ZZ_CTECBLQ para bloquear entrada de CTE de Compra quando tiver NF vinculada que ainda n\u00e3o est\u00e1 classificada</li> <li>MELHORIA: Funcionalidade para exportar as DANFE/DACTE em lote</li> <li>MELHORIA: Desenvolvido fun\u00e7\u00e3o U_PTX0060_Importa_Xml(cStringXml) para importar uma NF-e ou CT-e passando diretamente a string do XML, mantendo o padr\u00e3o da ferramenta</li> <li>MELHORIA: Alterado para n\u00e3o abrir tela de amarra\u00e7\u00e3o ao cancelar a tela de tipo de documento</li> <li>BUG: Corre\u00e7\u00e3o no compatibilizador para criar o campo D1_ZNFIMP e F1_ZNFIMP</li> </ul>"},{"location":"xmle/release-notes/#versao-4335063","title":"Vers\u00e3o 4.33.5063","text":"<p>06/06/2024</p> <ul> <li>MELHORIA: Criado campo F1_ZNFIMP para informar que o documento foi importado pelo Facile XML-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335062","title":"Vers\u00e3o 4.33.5062","text":"<p>22/05/2024</p> <ul> <li>BUG: Corrigido francionamento para NFS-e</li> <li>BUG: Inclu\u00eddo tratativa de pedido por fornecedor vinculado na busca avan\u00e7ada de produtos</li> <li>BUG: Inclu\u00eddo preenchimento do campo D1_ZNFIMP na entrada dos CTE</li> <li>BUG: Ajuste na tela de confronto de impostos para melhor visualiza\u00e7\u00e3o em resolu\u00e7\u00f5es menores</li> </ul>"},{"location":"xmle/release-notes/#versao-4335061","title":"Vers\u00e3o 4.33.5061","text":"<p>23/04/2024</p> <ul> <li>MELHORIA: Criado workflow para envio de e-mail avisando ao comprador quando o pedido de compras dele der entrada pela NF (par\u00e2metro ZZ_AVISENT = .T.)</li> <li>BUG: Corrigido busca na SF1 para NFS-e na op\u00e7\u00e3o de excluir o documento</li> </ul>"},{"location":"xmle/release-notes/#versao-4335060","title":"Vers\u00e3o 4.33.5060","text":"<p>03/2024</p> <ul> <li>BUG: Corrigido para n\u00e3o importar XML do computador que n\u00e3o possui assinatura digital</li> <li>MELHORIA: Criado ponto de entrada P07GERAENT que \u00e9 chamado ao clicar no bot\u00e3o \"Gerar Entrada\"</li> <li>MELHORIA: Criado ponto de entrada P018SF1 para manipular o array de cabe\u00e7alho da NFe</li> <li>BUG: Corre\u00e7\u00e3o no sequencial de NSU para NFS-e Nacional</li> </ul>"},{"location":"xmle/release-notes/#versao-4335059","title":"Vers\u00e3o 4.33.5059","text":"<p>27/02/2024</p> <ul> <li>BUG: Corre\u00e7\u00e3o de vari\u00e1vel na entrada em lote</li> <li>MELHORIA: Informa\u00e7\u00e3o do vencimento da primeira parcela na tela de entrada de CTE de Compras</li> <li>BUG: Corre\u00e7\u00e3o para n\u00e3o apresentar a tela de manifesta\u00e7\u00e3o quando configurado para manifestar a confirma\u00e7\u00e3o automaticamente</li> </ul>"},{"location":"xmle/release-notes/#versao-4335058","title":"Vers\u00e3o 4.33.5058","text":"<p>12/01/2024</p> <ul> <li>MELHORIA: Incluido no ponto de entrada SAVEZZZ a informa\u00e7\u00e3o se o documento j\u00e1 existia na ZZZ</li> <li>MELHORIA: Relat\u00f3rio de status dos documentos</li> <li>MELHORIA: Possibilidade de desativar a verifica\u00e7\u00e3o do IPI quando a CST for 99</li> </ul>"},{"location":"xmle/release-notes/#versao-4335057","title":"Vers\u00e3o 4.33.5057","text":"<p>04/12/2023</p> <ul> <li>BUG: Ajuste para impress\u00e3o da Danfe quando n\u00e3o h\u00e1 a chave da NFE da referenciada</li> <li>MELHORIA: Cria\u00e7\u00e3o de nova legenda para pr\u00e9-nota bloqueada para confer\u00eancia fisica</li> <li>MELHORIA: Fracionamento autom\u00e1tico de acordo com os lotes do produto</li> <li>BUG: Corrigido vinculo com pr\u00e9-nota de transfer\u00eancia</li> </ul>"},{"location":"xmle/release-notes/#versao-4335056","title":"Vers\u00e3o 4.33.5056","text":"<p>09/11/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o para importa\u00e7\u00e3o de CTE com CPF no destinat\u00e1rio</li> <li>MELHORIA: Inclu\u00eddo possibilidade de informar o range de data para buscar a NF referenciada no CTE de compra</li> <li>MELHORIA: Alterado a Busca CTE Sefaz manual utilizando o novo processo de download de CTEs</li> </ul>"},{"location":"xmle/release-notes/#versao-4335055","title":"Vers\u00e3o 4.33.5055","text":"<p>19/10/2023</p> <ul> <li>MELHORIA: Rotina para importar v\u00e1rios XMLs do computador simultaneamente</li> </ul>"},{"location":"xmle/release-notes/#versao-4335054","title":"Vers\u00e3o 4.33.5054","text":"<p>06/10/2023</p> <ul> <li>MELHORIA: Criado parametro ZZ_BUSCAPC para deixar j\u00e1 marcado a pesquisa de produtos com pedido de compra</li> <li>MELHORIA: Inclu\u00eddo o XML dos parametros do ponto de entrada P018COLS</li> </ul>"},{"location":"xmle/release-notes/#versao-4335053","title":"Vers\u00e3o 4.33.5053","text":"<p>18/09/2023</p> <ul> <li>MELHORIA: Alterado para n\u00e3o precisar do Parm2 para realizar a autentica\u00e7\u00e3o dos JOBs</li> <li>BUG: Removido a busca da logo da empresa na impress\u00e3o do DACTE</li> <li>MELHORIA: Inclus\u00e3o de entrada de CT-e de compras referenciado a beneficiamento e devolu\u00e7\u00e3o</li> </ul>"},{"location":"xmle/release-notes/#versao-4335052","title":"Vers\u00e3o 4.33.5052","text":"<p>28/08/2023</p> <ul> <li>MELHORIA: Criado dois par\u00e2metros para alterar a data de busca dos CTEs de compra (ZZ_DCTECP) e dos CTEs de venda (ZZ_DCTEVD) na rotina de classifica\u00e7\u00e3o autom\u00e1tica</li> <li>BUG: Removido as NFS-e do primeiro painel do gest\u00e3o a vista, ser\u00e1 desenvolvido um painel pr\u00f3pria para a NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335051","title":"Vers\u00e3o 4.33.5051","text":"<p>14/08/2023</p> <ul> <li>BUG: Tratativa no relat\u00f3rio de entradas para a NFS-e</li> <li>MELHORIA: Inclu\u00eddo download da NFS-e Nacional via webservice</li> <li>BUG: Ajuste autom\u00e1tico do tamanho do campo do C\u00f3digo do Produto do Fornecedor</li> </ul>"},{"location":"xmle/release-notes/#versao-4335050","title":"Vers\u00e3o 4.33.5050","text":"<p>27/07/2023</p> <ul> <li>MELHORIA: Criado ponto de entrada PTXF1SER para manipular a s\u00e9rie dos documentos</li> <li>MELHORIA: Inclus\u00e3o de novos campos na entrada da NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335049","title":"Vers\u00e3o 4.33.5049","text":"<p>21/07/2023</p> <ul> <li>BUG: Corrigido importa\u00e7\u00e3o de CTE de compra com amarra\u00e7\u00e3o em NF de importa\u00e7\u00e3o (formul\u00e1rio pr\u00f3prio)</li> </ul>"},{"location":"xmle/release-notes/#versao-4335048","title":"Vers\u00e3o 4.33.5048","text":"<p>14/07/2023</p> <ul> <li>MELHORIA: Inclu\u00eddo o c\u00f3digo do cliente/fornecedor na tela de gerar entrada</li> <li>MELHORIA: Inclu\u00eddo op\u00e7\u00e3o de pesquisa e filtro na tela de amarra\u00e7\u00e3o de produtos x fornecedor</li> </ul>"},{"location":"xmle/release-notes/#versao-4335047","title":"Vers\u00e3o 4.33.5047","text":"<p>14/07/2023</p> <ul> <li>MELHORIA: Inclu\u00eddo a informa\u00e7\u00e3o de UF e munic\u00edpio de origem/destino ativando par\u00e2metro ZZ_UFTRANS</li> <li>MELHORIA: Inclu\u00eddo a informa\u00e7\u00e3o do Tipo de Frete na entrada de NF-e</li> <li>MELHORIA: Melhorado para que no CTE ao informar a TES seja sempre em letras mai\u00fasculas</li> <li>MELHORIA: Inclus\u00e3o da op\u00e7\u00e3o de \"Formato de Tabela\" na impress\u00e3o de relat\u00f3rio de CTEs</li> </ul>"},{"location":"xmle/release-notes/#versao-4335046","title":"Vers\u00e3o 4.33.5046","text":"<p>14/07/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o na pagina\u00e7\u00e3o para download de NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335045","title":"Vers\u00e3o 4.33.5045","text":"<p>11/07/2023</p> <ul> <li>MELHORIA: Alterado fun\u00e7\u00e3o de filtro do browse para n\u00e3o perder a funcionalidade de filtrar a tela</li> </ul>"},{"location":"xmle/release-notes/#versao-4335044","title":"Vers\u00e3o 4.33.5044","text":"<p>07/07/2023</p> <ul> <li>MELHORIA: Criado ponto de entrada PTX01FIL que permite filtrar o browse de documentos XMLs</li> </ul>"},{"location":"xmle/release-notes/#versao-4335043","title":"Vers\u00e3o 4.33.5043","text":"<p>07/07/2023</p> <ul> <li>BUG: Ajuste na s\u00e9rie para buscar a NFe para classificar</li> <li>BUG: Ajuste para n\u00e3o enviar o campo do IPI quando for zerado</li> </ul>"},{"location":"xmle/release-notes/#versao-4335042","title":"Vers\u00e3o 4.33.5042","text":"<p>03/07/2023</p> <ul> <li>MELHORIA: Inclu\u00eddo informa\u00e7\u00e3o do Tipo de Frete na rotina de Entrada em Lote</li> <li>BUG: Corre\u00e7\u00e3o na busca por pedido de compra</li> </ul>"},{"location":"xmle/release-notes/#versao-4335041","title":"Vers\u00e3o 4.33.5041","text":"<p>27/06/2023</p> <ul> <li>MELHORIA: Desenvolvido novo JOB para realizar a manifesta\u00e7\u00e3o e download de XMLs que ficaram pra tr\u00e1s</li> </ul>"},{"location":"xmle/release-notes/#versao-4335040","title":"Vers\u00e3o 4.33.5040","text":"<p>23/06/2023</p> <ul> <li>BUG: Mudan\u00e7a no nome do objeto da tela para evitar conflito com o padr\u00e3o (PTX0018)</li> </ul>"},{"location":"xmle/release-notes/#versao-4335039","title":"Vers\u00e3o 4.33.5039","text":"<p>20/06/2023</p> <ul> <li>BUG: Alterado forma de ler o IPI do XML no confronto para casos em que n\u00e3o possui base e aliquota, mas possui valor de IPI</li> <li>MELHORIA: Incluido a informa\u00e7\u00e3o de total da NF na tela de confronto de impostos</li> </ul>"},{"location":"xmle/release-notes/#versao-4335038","title":"Vers\u00e3o 4.33.5038","text":"<p>16/06/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o na convers\u00e3o de unidade de medida padr\u00e3o do Protheus</li> <li>BUG: Corre\u00e7\u00e3o na valida\u00e7\u00e3o de NF-e antes do ponto de entrada P018PROPRIO</li> </ul>"},{"location":"xmle/release-notes/#versao-4335037","title":"Vers\u00e3o 4.33.5037","text":"<p>10/06/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o na impress\u00e3o do valor do ICMS na Danfe</li> <li>MELHORIA: Impress\u00e3o de DACTE direto na pasta</li> </ul>"},{"location":"xmle/release-notes/#versao-4335036","title":"Vers\u00e3o 4.33.5036","text":"<p>29/05/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o nos JOB para ignorar as filiais com o par\u00e2metro ativo (ZZ_FILATIV)</li> <li>BUG: Corre\u00e7\u00e3o na op\u00e7\u00e3o de classificar pr\u00e9-nota quando n\u00e3o encontra o documento na SF1</li> <li>BUG: Corre\u00e7\u00e3o na tela de gest\u00e3o a vista para banco de dados Oracle</li> </ul>"},{"location":"xmle/release-notes/#versao-4335035","title":"Vers\u00e3o 4.33.5035","text":"<p>15/05/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o da falha ao encontrar a NFS-e na rotina de classifica\u00e7\u00e3o</li> <li>BUG: Alterado o CONCAT no gest\u00e3o a vista para compatibilizar com vers\u00e3o antiga do SQL Server</li> </ul>"},{"location":"xmle/release-notes/#versao-4335034","title":"Vers\u00e3o 4.33.5034","text":"<p>12/05/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o em novo de user function para evitar duplicidade</li> </ul>"},{"location":"xmle/release-notes/#versao-4335033","title":"Vers\u00e3o 4.33.5033","text":"<p>09/05/2023</p> <ul> <li>MELHORIA: Criado ponto de entrada PTCTEDAD para permitir manipular os dados do CTE antes do lan\u00e7amento</li> <li>BUG: Corre\u00e7\u00e3o na entrada de NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335032","title":"Vers\u00e3o 4.33.5032","text":"<p>02/05/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o no endere\u00e7o do tomador para prefeitura de SP</li> <li>MELHORIA: Criado ponto de entrda PTCLIFOR para que seja poss\u00edvel customizar a busca de cliente/fornecedor</li> </ul>"},{"location":"xmle/release-notes/#versao-4335031","title":"Vers\u00e3o 4.33.5031","text":"<p>23/04/2023</p> <ul> <li>MELHORIA: Adicionado a importa\u00e7\u00e3o autom\u00e1tica de NFS-e via webservice para a prefeitura de Cariacica/ES</li> <li>MELHORIA: Criado parametro ZZ_MUDASE3 para ativar a possibilidade do usu\u00e1rio mudar a s\u00e9rie da NFS-e no momento do lan\u00e7amento</li> <li>BUG: Corre\u00e7\u00e3o na exclus\u00e3o de NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335030","title":"Vers\u00e3o 4.33.5030","text":"<p>11/04/2023</p> <ul> <li>BUG: Ajustes em mensagens de CTE</li> <li>BUG: Tratamento para CTE de Complemento</li> <li>MELHORIA: Reestruturado para entrada de mais prefeituras</li> </ul>"},{"location":"xmle/release-notes/#versao-4335029","title":"Vers\u00e3o 4.33.5029","text":"<p>30/03/2023</p> <ul> <li>BUG: Corrigido para n\u00e3o considerar NF-e de devolu\u00e7\u00e3o no CheckDoc</li> <li>BUG: Corrigido erro ao exportar XMLs</li> </ul>"},{"location":"xmle/release-notes/#versao-4335028","title":"Vers\u00e3o 4.33.5028","text":"<p>29/03/2023</p> <ul> <li>MELHORIA: Adicionado a importa\u00e7\u00e3o autom\u00e1tica de NFS-e via webservice para a prefeitura de Nova Friburgo/RJ</li> <li>MELHORIA: Adicionado a importa\u00e7\u00e3o autom\u00e1tica de NFS-e via webservice para a prefeitura de Ipatinga/MG</li> <li>MELHORIA: Incluido informa\u00e7\u00e3o de vencimento de certificado na tela principal</li> <li>MELHORIA: Adicionado a importa\u00e7\u00e3o de Lote, Fabrica\u00e7\u00e3o e Vencimento para produtos que controlam lote (B1_RASTRO igual a L ou S)</li> <li>BUG: Corre\u00e7\u00e3o para importa\u00e7\u00e3o de PDF de NFS-e contendo mais de um item de servi\u00e7o</li> <li>BUG: Corre\u00e7\u00e3o na transmiss\u00e3o autom\u00e1tica da confirma\u00e7\u00e3o da opera\u00e7\u00e3o quando utiliza a op\u00e7\u00e3o Classificar NF-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335027","title":"Vers\u00e3o 4.33.5027","text":"<p>28/03/2023</p> <ul> <li>MELHORIA: Adicionado a importa\u00e7\u00e3o autom\u00e1tica de NFS-e via webservice para a prefeitura de Cachoeiro de Itapemirim/ES</li> </ul>"},{"location":"xmle/release-notes/#versao-4335026","title":"Vers\u00e3o 4.33.5026","text":"<p>27/03/2023</p> <ul> <li>MELHORIA: Adicionado bot\u00e3o para exclus\u00e3o da amarra\u00e7\u00e3o produto x fornecedor na tela principal de entrada</li> <li>MELHORIA: Ajuste na mensagem de XML n\u00e3o baixado para orientar melhor o usu\u00e1rio</li> <li>BUG: Corrigido relat\u00f3rio para informa\u00e7\u00e3o da NFS-e na coluna TIPO</li> </ul>"},{"location":"xmle/release-notes/#versao-4335025","title":"Vers\u00e3o 4.33.5025","text":"<p>20/03/2023</p> <ul> <li>BUG: Corrigido tratamento para formatos de datas diferentes</li> </ul>"},{"location":"xmle/release-notes/#versao-4335024","title":"Vers\u00e3o 4.33.5024","text":"<p>17/03/2023</p> <ul> <li>BUG: Corrigido importa\u00e7\u00e3o da SA5 que estava duplicando registros</li> <li>MELHORIA: Criado ponto de entrada P018ZZW para a\u00e7\u00f5es ap\u00f3s inclus\u00e3o da amarra\u00e7\u00e3o produto x fornecedor</li> </ul>"},{"location":"xmle/release-notes/#versao-4335023","title":"Vers\u00e3o 4.33.5023","text":"<p>16/03/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o no controle de hor\u00e1rio de execu\u00e7\u00e3o do JOB</li> <li>BUG: Configurado para o Busca Avan\u00e7ada Sefaz desconsiderar filiais inativas</li> <li>MELHORIA: Inclu\u00eddo na exporta\u00e7\u00e3o de XML a op\u00e7\u00e3o para exportar CTe e NFe juntos</li> </ul>"},{"location":"xmle/release-notes/#versao-4335022","title":"Vers\u00e3o 4.33.5022","text":"<p>01/03/2023</p> <ul> <li>MELHORIA: Criado ponto de entrada que permite utilizar formul\u00e1rio pr\u00f3prio P018PROPRIO</li> </ul>"},{"location":"xmle/release-notes/#versao-4335021","title":"Vers\u00e3o 4.33.5021","text":"<p>24/02/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o na gera\u00e7\u00e3o da DANFE</li> </ul>"},{"location":"xmle/release-notes/#versao-4335020","title":"Vers\u00e3o 4.33.5020","text":"<p>15/02/2023</p> <ul> <li>BUG: Corre\u00e7\u00e3o na importa\u00e7\u00e3o de PDF para appserver no linux e vers\u00e3o 12.1.27</li> </ul>"},{"location":"xmle/release-notes/#versao-4335019","title":"Vers\u00e3o 4.33.5019","text":"<p>09/02/2023</p> <ul> <li>MELHORIA: Ponto de entrada para manipular a ZZZ ap\u00f3s grava\u00e7\u00e3o: SAVEZZZ</li> <li>BUG: Ajuste no execauto da MATA116 para que ainda est\u00e1 com a rotina desatualizada (criado parametro ZZ_OLDM116)</li> </ul>"},{"location":"xmle/release-notes/#versao-4335018","title":"Vers\u00e3o 4.33.5018","text":"<p>04/02/2023</p> <ul> <li>MELHORIA: Desenvolvido busca de NFS-e na prefeitura de SP via WebService</li> <li>BUG: Corrigido importa\u00e7\u00e3o de XML do computador para CPF</li> </ul>"},{"location":"xmle/release-notes/#versao-4335017","title":"Vers\u00e3o 4.33.5017","text":"<p>25/01/2023</p> <ul> <li>MELHORIA: Criado novo campo a ser utilizado pela NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335016","title":"Vers\u00e3o 4.33.5016","text":"<p>23/01/2023</p> <ul> <li>BUG: Corrigido status do CTE</li> </ul>"},{"location":"xmle/release-notes/#versao-4335015","title":"Vers\u00e3o 4.33.5015","text":"<p>19/01/2023</p> <ul> <li>BUG: Corrigido falha ao alterar pr\u00e9-nota de NF-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335014","title":"Vers\u00e3o 4.33.5014","text":"<p>18/01/2023</p> <ul> <li>NOVIDADE: Criado relat\u00f3rio para Gest\u00e3o de CTE de Venda</li> </ul>"},{"location":"xmle/release-notes/#versao-4335013","title":"Vers\u00e3o 4.33.5013","text":"<p>17/01/2023</p> <ul> <li>BUG: Corrigido erro ao realizar entrada em lote</li> </ul>"},{"location":"xmle/release-notes/#versao-4335012","title":"Vers\u00e3o 4.33.5012","text":"<p>16/01/2023</p> <ul> <li>NOVIDADE: Permite classificar CTE diretamente da Central XML-e</li> <li>NOVIDADE: Criado ponto de entrada P09ALTPN para controlar quem pode classificar a NFE e CTE</li> </ul>"},{"location":"xmle/release-notes/#versao-4335011","title":"Vers\u00e3o 4.33.5011","text":"<p>13/01/2023</p> <ul> <li>NOVIDADE: Criado a tabela FACX003 para gest\u00e3o dos CTEs</li> <li>NOVIDADE: Inclu\u00eddo importa\u00e7\u00e3o de CTE no controle de NSUs (FACX002)</li> <li>NOVIDADE: Criado ponto de entrada P018COLS para manipular o aCols do documento de entrada antes do execauto</li> <li>BUG: Corre\u00e7\u00e3o na importa\u00e7\u00e3o de NFe onde o destinat\u00e1rio \u00e9 CPF</li> <li>BUG: Corre\u00e7\u00e3o para exclus\u00e3o de pr\u00e9-nota de CTE diretamente da Central XML-e</li> <li>BUG: Corre\u00e7\u00e3o no congelamento ao dar entrada em CTE</li> <li>BUG: Corrigido peso bruto e liquido na DANFE</li> </ul>"},{"location":"xmle/release-notes/#versao-4335010","title":"Vers\u00e3o 4.33.5010","text":"<p>04/01/2022</p> <ul> <li> <p>NOVIDADE: Criado novo compatibilizador \u00fanico para dicion\u00e1rio na System (U_UPDXSYS)</p> </li> <li> <p>BUG: Inclu\u00eddo novas valida\u00e7\u00f5es ao importar NFS-e via PDF</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4335009","title":"Vers\u00e3o 4.33.5009","text":"<p>22/12/2022</p> <ul> <li> <p>NOVIDADE: Inclu\u00eddo nova tabela para registrar todos os NSUs</p> </li> <li> <p>NOVIDADE: Desenvolvido para salvar os NSUs das NF-e</p> </li> <li> <p>NOVIDADE: Denvolvido classe e JOB para buscar no sefaz os NSUs faltantes</p> </li> <li> <p>NOVIDADE: Criado tela para demonstrar a carta de corre\u00e7\u00e3o</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4335008","title":"Vers\u00e3o 4.33.5008","text":"<p>22/12/2022</p> <ul> <li> <p>NOVIDADE: Inclu\u00eddo a informa\u00e7\u00e3o do armaz\u00e9m do pedido na tela principal de entrada de doc.</p> </li> <li> <p>NOVIDADE: Inclu\u00eddo op\u00e7\u00e3o de visualizar, alterar e excluir pr\u00e9-nota</p> </li> <li> <p>NOVIDADE: Inclu\u00eddo op\u00e7\u00e3o de visualizar e excluir documento de entrada</p> </li> <li> <p>BUG: Removido os documentos bloqueados dos relat\u00f3rios</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4335007","title":"Vers\u00e3o 4.33.5007","text":"<p>22/12/2022</p> <ul> <li>NOVIDADE: Criado ponto de entrada P011ITEM para manipular os itens da SD1 no CTE de venda</li> </ul>"},{"location":"xmle/release-notes/#versao-4335006","title":"Vers\u00e3o 4.33.5006","text":"<p>21/12/2022</p> <ul> <li>NOVIDADE: Inclu\u00eddo campo Tipo de Produto no filtro de regras por processo</li> </ul>"},{"location":"xmle/release-notes/#versao-4335005","title":"Vers\u00e3o 4.33.5005","text":"<p>19/12/2022</p> <ul> <li>NOVIDADE: Finalizado a primeira vers\u00e3o da importa\u00e7\u00e3o autom\u00e1tica do CTE de venda</li> </ul>"},{"location":"xmle/release-notes/#versao-4335004","title":"Vers\u00e3o 4.33.5004","text":"<p>16/12/2022</p> <ul> <li> <p>BUG: Corre\u00e7\u00e3o na descri\u00e7\u00e3o do produto na tela de entrada</p> </li> <li> <p>BUG: Tratativa para n\u00e3o permitir XML sem filial</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4335003","title":"Vers\u00e3o 4.33.5003","text":"<p>08/12/2022</p> <ul> <li> <p>NOVIDADE: Cria parametro para permitir grupos de usu\u00e1rios a bloquear entrada de documento</p> </li> <li> <p>NOVIDADE: Inclu\u00eddo informa\u00e7\u00e3o da unidade de pedido do XML, produto e pedido de compras na tela de entrada</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4335002","title":"Vers\u00e3o 4.33.5002","text":"<p>01/12/2022</p> <ul> <li>BUG: Corre\u00e7\u00e3o na gera\u00e7\u00e3o da devolu\u00e7\u00e3o de venda</li> </ul>"},{"location":"xmle/release-notes/#versao-4335001","title":"Vers\u00e3o 4.33.5001","text":"<p>01/12/2022</p> <ul> <li>NOVIDADE: Implantado melhoria de importa\u00e7\u00e3o de NFS-e</li> </ul>"},{"location":"xmle/release-notes/#versao-4335000","title":"Vers\u00e3o 4.33.5000","text":"<p>22/11/2022</p> <ul> <li> <p>NOVIDADE: \u00a0Entrada de beneficiamento</p> </li> <li> <p>NOVIDADE: \u00a0Bloqueio de entrada</p> </li> <li> <p>NOVIDADE: \u00a0Nova legenda</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4331042","title":"Vers\u00e3o 4.33.1042","text":"<p>10/11/2022</p> <ul> <li>Ajuste no PTX008 para o ponto de entrada de numero de documento</li> </ul>"},{"location":"xmle/release-notes/#versao-4331041","title":"Vers\u00e3o 4.33.1041","text":"<p>09/11/2022</p> <ul> <li>Corre\u00e7\u00e3o no execauto do CTE (MATA116) ap\u00f3s atualiza\u00e7\u00e3o da Totvs</li> </ul>"},{"location":"xmle/release-notes/#versao-4331040","title":"Vers\u00e3o 4.33.1040","text":"<p>08/11/2022</p> <ul> <li> <p>Corre\u00e7\u00e3o no busca quando a empresa utiliza CPF no sigamat</p> </li> <li> <p>Corre\u00e7\u00e3o no PTX0008 para utilizar a nova rotina de numero de documento</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4331039","title":"Vers\u00e3o 4.33.1039","text":"<p>03/11/2022</p> <ul> <li>Criado ponto de entrada P007CTE</li> </ul>"},{"location":"xmle/release-notes/#versao-4331038","title":"Vers\u00e3o 4.33.1038","text":"<p>01/11/2022</p> <ul> <li>Ajuste na ordena\u00e7\u00e3o da SD1 quando possui convers\u00e3o de unidade de medida</li> </ul>"},{"location":"xmle/release-notes/#versao-4331037","title":"Vers\u00e3o 4.33.1037","text":"<p>28/10/2022</p> <ul> <li>Removido valida\u00e7\u00e3o de cnpj raiz nos jobs</li> </ul>"},{"location":"xmle/release-notes/#versao-4331036","title":"Vers\u00e3o 4.33.1036","text":"<p>26/10/2022</p> <ul> <li>Criado parametro ZZ_ORDEDIC para indicar se deve ordenar o array de itens de acordo com a SD1</li> </ul>"},{"location":"xmle/release-notes/#versao-4331035","title":"Vers\u00e3o 4.33.1035","text":"<p>24/10/2022</p> <ul> <li> <p>Corre\u00e7\u00e3o no update das legendas</p> </li> <li> <p>Corre\u00e7\u00e3o na cria\u00e7\u00e3o de arquivos de logs</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4331034","title":"Vers\u00e3o 4.33.1034","text":"<p>20/10/2022</p> <ul> <li>Cria\u00e7\u00e3o de ponto de entrada XCarregDados para alterar a filial de destino do XML</li> </ul>"},{"location":"xmle/release-notes/#versao-4331033","title":"Vers\u00e3o 4.33.1033","text":"<p>14/10/2022</p> <ul> <li>Corre\u00e7\u00e3o na fun\u00e7\u00e3o de valida\u00e7\u00e3o de impostos</li> </ul>"},{"location":"xmle/release-notes/#versao-4331032","title":"Vers\u00e3o 4.33.1032","text":"<p>13/10/2022</p> <ul> <li>Melhoria para gravar na ZZW a descri\u00e7\u00e3o do produto que vem no XML</li> </ul>"},{"location":"xmle/release-notes/#versao-4331031","title":"Vers\u00e3o 4.33.1031","text":"<p>11/10/2022</p> <ul> <li> <p>Corre\u00e7\u00e3o na impress\u00e3o do CTE na tag CEP</p> </li> <li> <p>Melhoria para preencher o campo D1_DFABRIC atrav\u00e9s da tag dFab</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4331030","title":"Vers\u00e3o 4.33.1030","text":"<p>05/10/2022</p> <ul> <li>Ajuste no checkdoc autom\u00e1tico e workflow</li> </ul>"},{"location":"xmle/release-notes/#versao-4331029","title":"Vers\u00e3o 4.33.1029","text":"<p>30/09/2022</p> <ul> <li> <p>Melhoria no checkdoc para incluir filial e cnpj no assunto do workflow</p> </li> <li> <p>Considerar pedido de compras faltando zeros a esquerda no xPED</p> </li> <li> <p>Melhorado processo dos JOBS para controle de semaforo e logs</p> </li> </ul>"},{"location":"xmle/release-notes/#versao-4331028","title":"Vers\u00e3o 4.33.1028","text":"<p>26/09/2022</p> <ul> <li>Corre\u00e7\u00e3o na query de exporta\u00e7\u00e3o de XML para banco de dados Oracle</li> </ul>"},{"location":"xmle/release-notes/#versao-4331027","title":"Vers\u00e3o 4.33.1027","text":"<p>14/09/2022</p> <ul> <li>Corrigido erro ap\u00f3s incluir novas colunas no grid de pedido de compras</li> </ul>"},{"location":"xmle/release-notes/#versao-4331026","title":"Vers\u00e3o 4.33.1026","text":"<p>11/09/2022</p> <ul> <li>Melhoria incluindo valores do pedido de compra</li> </ul>"},{"location":"xmle/release-notes/#versao-4331025","title":"Vers\u00e3o 4.33.1025","text":"<p>06/09/2022</p> <ul> <li>Inclu\u00eddo tratamento de serie 3 digitos para CTE</li> </ul>"},{"location":"xmle/release-notes/#versao-4331024","title":"Vers\u00e3o 4.33.1024","text":"<p>01/09/2022</p> <ul> <li>Alterado para n\u00e3o exportar XML de documento cancelado</li> </ul>"},{"location":"xmle/anexos/email-fornecedores/","title":"Modelo de e-mail para Fornecedores","text":"<p>Ao aderir a nova ferramenta, \u00e9 recomendado que informe os fornecedores para que possam se adequar a ferramenta tamb\u00e9m. Segue abaixo um esqueleto de e-mail que pode ser enviado aos seus fornecedores.</p> <p></p> <p>Prezado (a), boa tarde! </p> <p>Solicitamos especial apoio aos\u00a0nossos fornecedores quanto as observa\u00e7\u00f5es contidas em\u00a0nossos Pedidos de Compra, pois \u00e9\u00a0de extrema import\u00e2ncia para estabelecer conformidade com as nossas especifica\u00e7\u00f5es.</p> <p>Nesta mensagem\u00a0em especial, queremos tratar sobre os campos\u00a0no arquivo XML das NFes:\u00a0\"XPed\"\u00a0e\u00a0\"nItemPed\".\u00a0Esses campos correspondem ao n\u00famero do pedido e o item do pedido.</p> <p>Esclarecemos que\u00a0temos uma melhoria para importa\u00e7\u00e3o autom\u00e1tica dos arquivos XML's com o objetivo de eliminar\u00a0erros com a digita\u00e7\u00e3o e ainda\u00a0aumentar a produtividade no processo de\u00a0recebimento das mercadorias.</p> <p>Estes campos\u00a0dever\u00e3o ser preenchidos conforme o exemplo abaixo:</p> <ul><li>XPed:\u00a0079358</li><li>nItemPed:\u00a00001</li></ul> <p>Lembramos que j\u00e1 \u00e9 uma observa\u00e7\u00e3o destaque em nossos pedidos de compra, mas infelizmente alguns fornecedores n\u00e3o est\u00e3o atendendo. Pe\u00e7o agilizar os ajustes necess\u00e1rios para que at\u00e9 o dia\u00a031/12/2023\u00a0todos os arquivos\u00a0XML j\u00e1 tenham a informa\u00e7\u00e3o correta.</p> <p> </p> <p>IMPORTANTE: Informamos que a partir do dia 01/01/2023,\u00a0n\u00e3o ser\u00e1 poss\u00edvel o recebimento de mercadorias com\u00a0\"XML\" sem o preenchimento correto dos campos em quest\u00e3o.\u00a0</p> <p> </p> <p>- Para os fornecedores obrigados a emiss\u00e3o de Nota Fiscal Eletr\u00f4nica, a NF s\u00f3 ser\u00e1 aceita e registrada com envio do arquivo XML para\u00a0nfe@com.br\u00a0(Conforme AJUSTE SINIEF 07/05, \u00a7 7\u00ba);</p><p>- \u00c9 OBRIGAT\u00d3RIO CONSTAR NA NFe O N\u00daMERO DESTE PEDIDO (Tags: xPed e nItemPed)</p> <p> </p> <p> </p> <p>Atenciosamente, </p> <p></p> -FIM-"},{"location":"xmle/instalacao/aplicar-patch/","title":"\ud83e\uddd1\u200d\ud83d\udcbbAplicando o Patch","text":"<p>A implanta\u00e7\u00e3o da ferramenta se inicia com a aplica\u00e7\u00e3o do patch de programa no reposit\u00f3rio de programas (RPO) do ERP.  </p> <p>Caso n\u00e3o possua o patch atualizado da ferramenta, baixe em: P\u00e1gina de download</p>"},{"location":"xmle/instalacao/aplicar-patch/#como-aplicar-patch","title":"Como aplicar patch?","text":"<p>Basta seguir o manual oficial do ERP:</p> <p>Automa\u00e7\u00e3o Fiscal - Configura\u00e7\u00e3o - Configurando e aplicando pacotes pelo VSCODE \u2013 Central de Atendimento TOTVS</p>"},{"location":"xmle/instalacao/compatibilizador/","title":"Passo 02 - Compatibilizador","text":""},{"location":"xmle/instalacao/compatibilizador/#compatibilizador","title":"\ud83e\udd16Compatibilizador","text":"<p>A ferramenta utiliza tabelas, campos, \u00edndices e par\u00e2metros customizados, com isso precisamos executar o compatibilizador para que sejam criados corretamente. </p> <p>Para aplica\u00e7\u00e3o do compatibilizador, basta chamar no programa inicial do ERP conforme conforme tipo de dicion\u00e1rio utilizado.</p> <p>ATEN\u00c7\u00c3O: Dever\u00e1 ser utilizado APENAS UMA DAS DUAS OP\u00c7\u00d5ES de acordo com a implanta\u00e7\u00e3o do seu Protheus.</p>"},{"location":"xmle/instalacao/compatibilizador/#dicionario-no-banco-de-dados","title":"Dicion\u00e1rio no Banco de Dados","text":"<p>Dever\u00e1 ser utilizado o compatibilizador: U_UPDDICBD</p> <p></p>"},{"location":"xmle/instalacao/compatibilizador/#dicionario-na-system","title":"Dicion\u00e1rio na SYSTEM","text":"<p>Dever\u00e1 ser utilizado o compatibilizador: U_UPDXSYS</p> <p></p>"},{"location":"xmle/instalacao/compatibilizador/#o-que-foi-criado","title":"O que foi criado?","text":"<p>Para saber tudo que foi criado pelo nosso compatibilizador, basta acessar a documenta\u00e7\u00e3o:</p> <p>Dicion\u00e1rio de Dados</p>"},{"location":"xmle/instalacao/configura-jobs/","title":"\ud83d\udc7eConfigurando os Jobs","text":"<p>Os Jobs s\u00e3o respons\u00e1veis pela automatiza\u00e7\u00e3o dos processos na ferramenta, como por exemplo, buscar as chaves e os seus respectivos XML diretamente do SEFAZ e tamb\u00e9m outros processos como workflows e CheckDoc.</p> <p>Existem duas op\u00e7\u00f5es para configura\u00e7\u00e3o dos jobs, sendo via ONSTART no appserver.ini (recomendado) ou via Schedule do ERP.</p>"},{"location":"xmle/instalacao/configura-jobs/#via-onstart-no-appserverini","title":"Via OnStart no AppServer.ini","text":"<p>Nesse modo os JOBs ser\u00e3o executados diretamente no appserver em quest\u00e3o e em intervalos de acordo com um prazo configurado (n\u00e3o \u00e9 poss\u00edvel configurar o n\u00famero de execu\u00e7\u00f5es e nem o hor\u00e1rio exato da execu\u00e7\u00e3o igual no Schedule).</p> <p>Para um melhor resultar e evitar conflitos de processamento, recomendamos criar dois appservers exclusivos para execu\u00e7\u00e3o desses Jobs, sendo:</p> <ul> <li> <p>Appserver_Facile_Xml01: Respons\u00e1vel pelo download dos documentos</p> </li> <li> <p>Appserver_Facile_Xml02: Respons\u00e1vel pela revalida\u00e7\u00e3o dos documentos</p> </li> </ul> <p>Obs.: Os nomes das pastas do appserver aqui mencionados s\u00e3o apenas sugest\u00f5es, fique a vontade para altera-los.</p> <p>Vamos configurar:</p>"},{"location":"xmle/instalacao/configura-jobs/#appserver_facile_xml01","title":"Appserver_Facile_Xml01","text":"<p>Crie um novo appserver baseado no appserver de produ\u00e7\u00e3o e renomeie para \"appserver_facile_xml01\".</p> <p></p> <p>Entre na pasta criada e altere o arquivo appserver.ini configurando RPO exclusivo para esse servi\u00e7o e no final do arquivo configure os JOBs conforme abaixo:</p> <pre><code>;;Job Respons\u00e1vel por baixar as NF-e no Sefaz\n[PTXJ001]\nMAIN=U_PTXJ001\nENVIRONMENT=FACILE\nnparms=2\nParm1=01\nParm2=01\n\n;;Job respons\u00e1vel por realizar o download do CT-e no Sefaz\n[PTXJ003]\nMAIN=U_PTXJ003\nENVIRONMENT=FACILE\nnparms=2\nParm1=01\nParm2=01\n\n;;Job respons\u00e1vel por realizar o download do XML da NFS-e\n[PTXJ008]\nMAIN=U_PTXJ008\nENVIRONMENT=FACILE\nnparms=2\nParm1=01\nParm2=01\n\n;;Tag respons\u00e1vel por inicializar e controlar os jobs\n[ONSTART]\nJOBS=PTXJ001,PTXJ003,PTXJ008\nREFRESHRATE=4000\n</code></pre>"},{"location":"xmle/instalacao/configura-jobs/#explicando-as-tags","title":"Explicando as TAGs","text":"<p>MAIN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Nome do programa ser chamado</p> <p>ENVIRONMENT  =&gt; Ambiente que o JOB ser\u00e1 execuado</p> <p>nparms\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Quantidade de par\u00e2metros a serem utilizados</p> <p>Parm1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Informe o c\u00f3digo da empresa (igual ao cEmpAnt)</p> <p>Parm2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Informe o c\u00f3digo da primeira filial (igual ao cFilAnt)</p> <p>REFRESHRATE\u00a0\u00a0\u00a0\u00a0=&gt; Intervalo de tempo (em segundos) para que execu\u00e7\u00e3o do JOB</p> <p>Basta salvar o appserver.ini com essas altera\u00e7\u00f5es.</p>"},{"location":"xmle/instalacao/configura-jobs/#appserver_facile_xml02","title":"Appserver_Facile_Xml02","text":"<p>Crie um novo appserver baseado no appserver de produ\u00e7\u00e3o e renomeie para \"appserver_facile_xml02\".</p> <p></p> <p>Entre na pasta criada e altere o arquivo appserver.ini configurando RPO exclusivo para esse servi\u00e7o e no final do arquivo configure os JOBs conforme abaixo:</p> <pre><code>;;Job Respons\u00e1vel por revalidar os documentos no Sefaz\n[PTXJ004]\nMAIN=U_PTXJ004\nENVIRONMENT=FACILE\nnparms=2\nParm1=01\nParm2=01\n\n;;Tag respons\u00e1vel por inicializar e controlar os jobs\n[ONSTART]\nJOBS=PTXJ004\nREFRESHRATE=4000\n</code></pre>"},{"location":"xmle/instalacao/configura-jobs/#explicando-as-tags_1","title":"Explicando as TAGs","text":"<p>MAIN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Nome do programa ser chamado</p> <p>ENVIRONMENT =&gt; Ambiente que o JOB ser\u00e1 execuado</p> <p>nparms\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Quantidade de par\u00e2metros a serem utilizados</p> <p>Parm1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Informe o c\u00f3digo da empresa (igual ao cEmpAnt)</p> <p>Parm2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0=&gt; Informe o c\u00f3digo da primeira filial (igual ao cFilAnt)</p> <p>REFRESHRATE\u00a0\u00a0\u00a0\u00a0=&gt; Intervalo de tempo (em segundos) para que execu\u00e7\u00e3o do JOB</p> <p>Basta salvar o appserver.ini com essas altera\u00e7\u00f5es.</p> <p><p>Aten\u00e7\u00e3o: Esses quatro Schedules a seguir s\u00f3 dever\u00e3o ser utilizados se seu servidor Protheus estiver num servidor na Nuvem TOTVS T-Cloud, do contr\u00e1rio, N\u00c3O utilizar o procedimento abaixo.</p>"},{"location":"xmle/instalacao/configura-jobs/#via-schedule-do-erp","title":"Via Schedule do ERP","text":"<p>Acesse o ambiente Configurador (SIGACFG)</p> <p>Ambiente &gt; Schedule &gt; Schedule</p> <p>Obs.: O servi\u00e7o de schedule e seu Agent j\u00e1 deve estar configurados e funcionando, segue documenta\u00e7\u00e3o oficial:</p> <p>Schedule - Como agendar a execu\u00e7\u00e3o de rotinas - Frameworksp - TDN</p> <p>Acesse a vis\u00e3o \"Schedule &gt; Agendamentos &gt; Cadastro\"</p> <p></p>"},{"location":"xmle/instalacao/configura-jobs/#ptxj001-baixa-de-nf-e","title":"PTXJ001 - Baixa de NF-e","text":"<p>Deve ser configurado um agendamento do PTXJ001 para cada grupo de empresas e selecionar apenas a primeira filial.</p> <p>Exemplo:</p> <p>Empresa 01 e possui as filiais 0101, 0102 e 0103</p> <p>O campo \"Empresa/Filial\" ficar\u00e1: 01/0101;</p> <p>Realize o cadastro do primeiro JOB seguindo o exemplo abaixo:</p> <p></p> <p>Lembre-se de alterar o \"Ambiente\" e \"Empresa/Filial\" conforme o seu cen\u00e1rio.</p> <p>Antes de confimar o cadastro, vamos configurar a recorr\u00eancia do JOB (clicando no bot\u00e3o parecido com: \ud83d\udd04\ufe0f).</p> <p>Na tela de recorr\u00eancia:</p> <p></p> <p>Obs.: O SEFAZ por padr\u00e3o bloqueio consultas repetidas em menos de 1 hora de intervalo.</p> <p>Agora sim podemos confirmar a tela de recorr\u00eancia e a tela de cadastro do agendamento \u2714\ufe0f.</p>"},{"location":"xmle/instalacao/configura-jobs/#ptxj003-baixa-de-ct-e","title":"PTXJ003 - Baixa de CT-e","text":"<p>Deve ser configurado um agendamento do PTXJ003 para cada grupo de empresas e selecionar apenas a primeira filial.</p> <p>Exemplo:</p> <p>Empresa 01 e possui as filiais 0101, 0102 e 0103</p> <p>O campo \"Empresa/Filial\" ficar\u00e1: 01/0101;</p> <p>Realize o cadastro do segundo JOB seguindo o exemplo abaixo:</p> <p></p> <p>Lembre-se de alterar o \"Ambiente\" e \"Empresa/Filial\" conforme o seu cen\u00e1rio.</p> <p>Antes de confimar o cadastro, vamos configurar a recorr\u00eancia do JOB (clicando no bot\u00e3o parecido com: \ud83d\udd04\ufe0f).</p> <p>Na tela de recorr\u00eancia:</p> <p></p> <p>Obs.: O SEFAZ por padr\u00e3o bloqueio consultas repetidas em menos de 1 hora de intervalo.</p> <p>Agora sim podemos confirmar a tela de recorr\u00eancia e a tela de cadastro do agendamento \u2714\ufe0f.</p>"},{"location":"xmle/instalacao/configura-jobs/#ptxj004-revalidacao-de-nf-e-e-ct-e","title":"PTXJ004 - Revalida\u00e7\u00e3o de NF-e e CT-e","text":"<p>Deve ser configurado um agendamento do PTXJ003 para cada grupo de empresas e selecionar apenas a primeira filial.</p> <p>Exemplo:</p> <p>Empresa 01 e possui as filiais 0101, 0102 e 0103</p> <p>O campo \"Empresa/Filial\" ficar\u00e1: 01/0101;</p> <p>Realize o cadastro do terceiro JOB seguindo o exemplo abaixo:</p> <p></p> <p>Lembre-se de alterar o \"Ambiente\" e \"Empresa/Filial\" conforme o seu cen\u00e1rio.</p> <p>Antes de confimar o cadastro, vamos configurar a recorr\u00eancia do JOB (clicando no bot\u00e3o parecido com: \ud83d\udd04\ufe0f).</p> <p>Na tela de recorr\u00eancia:</p> <p></p> <p>Obs.: O SEFAZ por padr\u00e3o bloqueio consultas repetidas em menos de 1 hora de intervalo.</p> <p>Agora sim podemos confirmar a tela de recorr\u00eancia e a tela de cadastro do agendamento \u2714\ufe0f.</p>"},{"location":"xmle/instalacao/configura-jobs/#ptxj008-download-do-xml-da-nfs-e","title":"PTXJ008 - Download do XML da NFS-e","text":"<p>Deve ser configurado um agendamento do PTXJ008 para cada grupo de empresas e selecionar apenas a primeira filial.</p> <p>Exemplo:</p> <p>Empresa 01 e possui as filiais 0101, 0102 e 0103</p> <p>O campo \"Empresa/Filial\" ficar\u00e1: 01/0101;</p> <p>Realize o cadastro do segundo JOB seguindo o exemplo abaixo:</p> <p></p> <p>Lembre-se de alterar o \"Ambiente\" e \"Empresa/Filial\" conforme o seu cen\u00e1rio.</p> <p>Antes de confimar o cadastro, vamos configurar a recorr\u00eancia do JOB (clicando no bot\u00e3o parecido com: \ud83d\udd04\ufe0f).</p> <p>Na tela de recorr\u00eancia:</p> <p></p> <p>Obs.: O SEFAZ por padr\u00e3o bloqueio consultas repetidas em menos de 1 hora de intervalo.</p> <p>Agora sim podemos confirmar a tela de recorr\u00eancia e a tela de cadastro do agendamento \u2714\ufe0f.</p>"},{"location":"xmle/instalacao/configura-jobs/#rpo-do-job","title":"RPO do JOB","text":"<p>O RPO do ambiente que executa os JOBs precisa estar com o patch da ferramenta aplicado e recomendamos que n\u00e3o seja compartilhado com outros ambientes. No caso do Schedule, ir\u00e1 utilizar o pr\u00f3prio RPO do ambiente Schedule e tamb\u00e9m necessita do patch aplicado.</p> <p>Obs.: Os appserver.ini criados dever\u00e3o apontar para esse RPO com o patch aplicado.</p>"},{"location":"xmle/instalacao/configura-jobs/#parametros-de-autenticacao","title":"Par\u00e2metros de autentica\u00e7\u00e3o","text":"<p>Dever\u00e1 ser configurado os par\u00e2metros abaixo com as credenciais fornecidas pela Facile Sistemas:</p>"},{"location":"xmle/instalacao/configura-jobs/#zz_authlog","title":"ZZ_AUTHLOG","text":"<p>Descri\u00e7\u00e3o: Usu\u00e1rio para autentica\u00e7\u00e3o na Facile Sistemas</p>"},{"location":"xmle/instalacao/configura-jobs/#zz_authpsw","title":"ZZ_AUTHPSW","text":"<p>Descri\u00e7\u00e3o: Senha para autentica\u00e7\u00e3o na Facile Sistemas</p> <p>Ainda n\u00e3o tem as credenciais? </p> <p>Basta enviar um e-mail para: xmle@facilesistemas.com.br</p>"},{"location":"xmle/instalacao/menus/","title":"\ud83c\udfafCriando os Menus","text":"<p>No menu teremos as principais rotinas da ferramenta, com isso basta seguirmos a cria\u00e7\u00e3o abaixo:</p> <p>Acesse o ambiente Configurador (SIGACFG) </p> <p>Ambiente &gt; Cadastros &gt; Menus</p> <p>Selecione o menu desejado, no nosso exemplo ser\u00e1 o Compras, e clique no bot\u00e3o \u201cOK\u201d</p> <p></p> <p>No quadro da esquerda, clique no primeiro n\u00edvel da \u00e1rvore \u201cCompras\u201d e clique no bot\u00e3o \u201cAdicionar &gt;&gt;\u201d para que o menu seja enviado para o quadro da direita.</p>"},{"location":"xmle/instalacao/menus/#grupo-de-menus","title":"Grupo de Menus","text":"<p>No quadro da direita, clique na pasta \u201c&amp;Atualiza\u00e7\u00f5es\u201d e depois clique no bot\u00e3o \u201cNovo Grupo\u201d.</p> <p>Na tela que abrir digite: \u201cFACILE XML-e\u201d nos tr\u00eas campos, com isso teremos criado o grupo de menu da ferramenta.</p> <p></p>"},{"location":"xmle/instalacao/menus/#ptx0001-central-xml-e","title":"PTX0001 - Central XML-e","text":"<p>Agora vamos criar os itens desse grupo de menu, conforme passos abaixo:</p> <p>Primeiramente clique na pasta criada \u201cFACILE XML-e\u201d, com isso informamos que os itens ser\u00e3o criados dentro desse grupo de menus.</p> <p>Clique no bot\u00e3o \u201cNovo Item\u201d e preencha as Descri\u00e7\u00f5es: \u201cCentral XML-e\u201d, Programa: \u201cPTX0001\u201d e configure conforme a imagem abaixo, em seguida clique em \u201cOK\u201d para salvar:</p> <p></p>"},{"location":"xmle/instalacao/menus/#ptx0017-xml-e-a-vista","title":"PTX0017 - XML-e a Vista","text":"<p>Vamos para o pr\u00f3ximo item de menu:</p> <p>Clique no bot\u00e3o \u201cNovo Item\u201d e preencha as Descri\u00e7\u00f5es: \u201cXML-e a Vista\u201d, Programa: \u201cPTX0017\u201d e configure conforme a imagem abaixo, em seguida clique em \u201cOK\u201d para salvar:</p> <p></p>"},{"location":"xmle/instalacao/menus/#ptx0030-produto-x-fornecedor","title":"PTX0030 - Produto x Fornecedor","text":"<p>Vamos para o pr\u00f3ximo item de menu:</p> <p>Clique no bot\u00e3o \u201cNovo Item\u201d e preencha as Descri\u00e7\u00f5es: \u201cProd. X Fornecedor\u201d, Programa: \u201cPTX0030\u201d e configure conforme a imagem abaixo, em seguida clique em \u201cOK\u201d para salvar:</p> <p></p>"},{"location":"xmle/instalacao/menus/#ptx0052-regras-por-processo","title":"PTX0052 - Regras por Processo","text":"<p>Vamos para o pr\u00f3ximo item de menu:</p> <p>Clique no bot\u00e3o \u201cNovo Item\u201d e preencha as Descri\u00e7\u00f5es: \u201cRegras por Processo\u201d, Programa: PTX0052 e configure conforme a imagem abaixo, em seguida clique em \u201cOK\u201d para salvar:</p> <p></p>"},{"location":"xmle/instalacao/menus/#finalizando-o-menu","title":"Finalizando o Menu","text":"<p>Para finalizar, vamos salvar o nosso menu para que j\u00e1 possa ser utilizado no m\u00f3dulo de Compras.</p> <p>Clique no bot\u00e3o \u201cGerar\u201d e na janela que abrir preencha conforme a imagem abaixo e clique no bot\u00e3o \u201cGerar\u201d dessa nova janela.</p> <p></p> <p>Confirme a gera\u00e7\u00e3o do menu e informe que deseja substituir o atual.</p> <p>Com isso finalizamos o Menu e a instala\u00e7\u00e3o da ferramenta FACILE XML-e!!</p>"},{"location":"xmle/instalacao/ponto-entrada-padrao/","title":"\ud83d\udd35Pontos de Entrada","text":"<p>Para o melhor aproveitamento da ferramenta utilizamos pontos de entrada disponibilizados pelo ERP, possibilitando intera\u00e7\u00f5es e automa\u00e7\u00f5es em diferentes momentos do documento de entrada.</p> <p>ATEN\u00c7\u00c3O: Caso seu ERP esteja no T-Cloud do fabricante (n\u00e3o permite compila\u00e7\u00e3o), solicitar \u00e0 FACILE um patch com os principais pontos de entrada para aplica\u00e7\u00e3o!</p>"},{"location":"xmle/instalacao/ponto-entrada-padrao/#mt100tok","title":"MT100TOK","text":"<p>Uso necess\u00e1rio para o correto funcionamento da ferramenta</p> <p>Utilizamos esse ponto de entrada para realizar a valida\u00e7\u00e3o dos impostos no momento da classifica\u00e7\u00e3o do documento de entrada.</p> <p>Sugerimos incluir o c\u00f3digo abaixo no final do fonte, logo antes do RETURN (caso tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>If lValido .And. AllTrim( FunName() ) $ \"MATA103/PTX0007/PTX0018/PTX0008/PTX0001\"\n    lValido := U_PTX0010()\nEndIf\n</code></pre> <p>Segue exemplo do ponto de entrada completo que poder\u00e1 ser utilizado (caso **N\u00c3O ** tenha o P.E. j\u00e1 aplicado ERP).</p> <pre><code>User Function MT100TOK()\n\n    Local aArea   := GetArea()\n    local lValido := ParamIxb[1]\n\n    If lValido .And. AllTrim( FunName() ) $ \"MATA103/PTX0007/PTX0018/PTX0008/PTX0001\"\n\n        lValido := U_PTX0010()\n\n    EndIf\n\n    RestArea(aArea)\n\nReturn lValido\n</code></pre>"},{"location":"xmle/instalacao/ponto-entrada-padrao/#mt103pn","title":"MT103PN","text":"<p>Uso necess\u00e1rio para o correto funcionamento da ferramenta</p> <p>Utilizamos esse ponto de entrada para realizar a checagem da TES e do pedido de compra nos itens do documento de entrada.</p> <p>Sugerimos incluir o c\u00f3digo abaixo no final do fonte, logo antes do RETURN (caso tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>If FwIsInCallStack(\"U_PTX0001\")\n    FWMsgRun(, {|| U_PTX0015(.T.) }, \"Processando!\", \"Calculando impostos, aguarde...\")         \nEndIf\n</code></pre> <p>Segue exemplo do ponto de entrada completo que poder\u00e1 ser utilizado (caso **N\u00c3O ** tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>User Function MT103PN()\n\n    If FwIsInCallStack(\"U_PTX0001\")\n        FWMsgRun(, {|| U_PTX0015(.T.) }, \"Processando!\", \"Calculando impostos, aguarde...\")         \n    EndIf\n\nReturn\u00a0.T.\n</code></pre>"},{"location":"xmle/instalacao/ponto-entrada-padrao/#mt140pc","title":"MT140PC","text":"<p>Esse ponto de entrada dever\u00e1 ser utilizado exclusivamente na situa\u00e7\u00e3o em que a empresa utilize o par\u00e2metro **MV_PCNFE ** ativo.</p> <p>Utilizamos o ponto de entrada para informar ao sistema que naquele momento da inclus\u00e3o da Pr\u00e9-Nota pela ferramenta n\u00e3o ser\u00e1 necess\u00e1rio realizar a valida\u00e7\u00e3o do pedido de compra.</p> <p>Obs.: A utiliza\u00e7\u00e3o desse ponto de entrada n\u00e3o atrapalha no processo padr\u00e3o adotado pelo MV_PCNFE.</p> <p>Segue exemplo do ponto de entrada que poder\u00e1 ser utilizado:</p> <pre><code>User Function MT140PC()\n\n    //|Apenas na rotina Facile XML-e |\n    If !FwIsInCallStack(\"U_PTX0001\")\n        Return Nil\n    EndIf\n\nReturn .F.\n</code></pre>"},{"location":"xmle/manuais/att-cd/","title":"12 - Atualiza\u00e7\u00e3o de Certificado digital","text":""},{"location":"xmle/manuais/att-cd/#atualizacao-do-certificado-digital","title":"Atualiza\u00e7\u00e3o do Certificado Digital","text":""},{"location":"xmle/manuais/att-cd/#passo-a-passo","title":"Passo a Passo","text":""},{"location":"xmle/manuais/att-cd/#observacoes-iniciais","title":"Observa\u00e7\u00f5es iniciais","text":"<p>Importa\u00e7\u00e3o do certificado digital para comunica\u00e7\u00e3o com o SEFAZ.</p> <p>Importante: O arquivo do certificado digital precisa estar no mesmo computador que estiver realizando o procedimento, seja na esta\u00e7\u00e3o do usu\u00e1rio ou no servidor.</p> ***OBSERVA\u00c7\u00c3O:***  Caso o seu usu\u00e1rio tenha acesso a v\u00e1rias filiais na mesma tela (m\u00faltiplas filiais no browse), \u00e9 necess\u00e1rio estar com a FILIAL a ser atualizada filtrada no browse para que o certificado seja vinculado corretamente a filial!"},{"location":"xmle/manuais/att-cd/#passo-01","title":"Passo 01","text":"<p>Com usu\u00e1rio admin, abra a tela do FACILE XML-e.</p> <p> Figura 1: Tela do FACILE XML-e </p>"},{"location":"xmle/manuais/att-cd/#passo-02","title":"Passo 02","text":"<p>V\u00e1 na op\u00e7\u00e3o em Outras A\u00e7\u00f5es &gt; Manuten\u00e7\u00e3o TI &gt; Wiz. Config.</p> <p> Figura 2: Op\u00e7\u00e3o Wiz. Config. </p>"},{"location":"xmle/manuais/att-cd/#passo-03","title":"Passo 03","text":"<p>Avance at\u00e9 a tela abaixo.</p> <p> Figura 3: Assistente de configura\u00e7\u00e3o </p> <p>Informe o caminho do arquivo do certificado digital (.PFX) e a sua senha de autentica\u00e7\u00e3o, processo parecido com o realizado na configura\u00e7\u00e3o do TSS.</p> <p>Caso n\u00e3o possua o .PFX ou tenha alguma dificuldade na importa\u00e7\u00e3o do certificado digital, poder\u00e1 ser utilizado os arquivo \u201c.PEM\u201d gerados pelo TSS, bastando informar o caminho dos arquivos nos seguintes par\u00e2metros:</p> <p>ZZ_CERTKEY: caminho para o arquivo \u201ckey.pem\u201d no Protheus_Data.     Exemplo: \\FACILE\\9901_key.pem </p> <p>ZZ_CERTPRI: caminho para o arquivo \u201ccert.pem\u201d no Protheus_Data.     Exemplo:\\FACILE\\9901_cert.pem                                                                                     </p> <p>ZZ_CERTKEY: caminho para o arquivo \u201cca.pem\u201d no Protheus_Data.     Exemplo: \\FACILE\\9901_ca.pem </p> -FIM-"},{"location":"xmle/manuais/cancelar-cte/","title":"20 - Cancelar Conhecimento de Frete","text":""},{"location":"xmle/manuais/cancelar-cte/#cancelar-conhecimento-de-frete","title":"Cancelar Conhecimento de Frete","text":""},{"location":"xmle/manuais/cancelar-cte/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo do cancelamento do conhecimento de frete \u00e9 cancelar o CTe de Compra. Isso \u00e9 poss\u00edvel atrav\u00e9s da Central XML-e.</p>"},{"location":"xmle/manuais/cancelar-cte/#como-usar","title":"Como usar?","text":"<p>Na Central XML-e, ir em Outras A\u00e7\u00f5es &gt;&gt; Documento de entrada &gt;&gt; Nt Conhecimento Frete Padr\u00e3o, conforme imagem abaixo. </p> <p> Figura 1: Acesso \u00e0 rotina pela Central XML-e </p> <p>Na op\u00e7\u00e3o \"Quanto a Nota\", escolha a op\u00e7\u00e3o \"Excluir NF de Conhec. Frete\", conforme imagem abaixo.</p> <p> Figura 2: Escolher op\u00e7\u00e3o de exclus\u00e3o de CTe </p> <p>Ap\u00f3s isso, preencha os filtros \"Data Inicial\", \"Data Final\" e \"Fornecedor\".</p> <p> Figura 3: Preenchimento de filtros </p> <p>Clique em \"Confirma\" para que o sistema efetue a busca dos CTes com base no filtro escolhido.</p> <p> Figura 4: Bot\u00e3o de confirmar </p> <p>A tela seguinte apresentar\u00e1 os CTes encontrados. Basta escolher um CTe e clicar no bot\u00e3o \"Excluir\", para que a tela de Exclus\u00e3o de Documento de Entrada apare\u00e7a.</p> <p> Figura 5: Tela p\u00f3s-filtro </p> <p>Os dados j\u00e1 vir\u00e3o preenchidos automaticamente. Confirme se est\u00e3o corretos e clique em \"Confirmar\".</p> <p> Figura 6: Tela de dados e confirma\u00e7\u00e3o da exclus\u00e3o </p> -FIM-"},{"location":"xmle/manuais/checkdoc/","title":"09 - CheckDoc","text":""},{"location":"xmle/manuais/checkdoc/#checkdoc","title":"Checkdoc","text":""},{"location":"xmle/manuais/checkdoc/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo do CheckDoc \u00e9 realizar uma an\u00e1lise do XML recebido do Sefaz e verificar no ERP Protheus se as informa\u00e7\u00f5es contidas nele est\u00e3o corretas.</p> <p>Ser\u00e1 verificado:</p> <ul> <li>Dados do fornecedor</li> <li>Dados dos produtos</li> <li>Dados dos pedidos de compra</li> </ul>"},{"location":"xmle/manuais/checkdoc/#como-usar","title":"Como usar?","text":"<p>Para que um documento seja analisado pelo CheckDoc, basta selecion\u00e1-lo na tela principal da Central XML-e e chamar a ferramenta conforme demonstrado na imagem abaixo:</p> <p>Caminho: Central XML-e/Outras A\u00e7\u00f5es/CheckDoc</p> <p> Figura 1: Checkdoc no \"Outras a\u00e7\u00f5es</p> <p>Ser\u00e1 apresentado a imagem abaixo com as op\u00e7\u00f5es \u201cVisualizar an\u00e1lise atual\u201d, \u201cRealizar nova an\u00e1lise\u201d e \u201cFechar\u201d.</p> <p> Figura 2: Realiza a an\u00e1lise do Documento Fiscal</p> <p>A op\u00e7\u00e3o \u201cVisualizar an\u00e1lise atual\u201d ir\u00e1 demonstrar o resultado da \u00faltima an\u00e1lise do CheckDoc nesse documento e a op\u00e7\u00e3o \u201cRealizar nova an\u00e1lise\u201d ir\u00e1 executar todas as verifica\u00e7\u00f5es novamente e gerar um novo resultado.</p> <p>Ao selecionar a op\u00e7\u00e3o de realizar nova an\u00e1lise, basta aguardar o processamento terminar e voc\u00ea j\u00e1 poder\u00e1 visualizar o resultado da an\u00e1lise.</p> <p> Figura 3: Visualizar resultado da an\u00e1lise</p> <p>Clicando em \u201cSIM\u201d, ser\u00e1 solicitado a pasta onde o relat\u00f3rio em HTML ser\u00e1 salvo e em seguida j\u00e1 o abrir\u00e1 automaticamente.</p> <p> Figura 4: Salvar relat\u00f3rio</p> <p>O cabe\u00e7alho do relat\u00f3rio demonstra os principais dados do documento, como n\u00famero, s\u00e9rie, valor, natureza da opera\u00e7\u00e3o etc.</p> <p> Figura 5: Cabe\u00e7alho relat\u00f3rio</p>"},{"location":"xmle/manuais/checkdoc/#fornecedor","title":"Fornecedor","text":"<p>No setor \u201cFornecedor\u201d ser\u00e1 realizado a an\u00e1lise das informa\u00e7\u00f5es do fornecedor que est\u00e1 no Protheus e as informa\u00e7\u00f5es que est\u00e3o no XML.</p> <p> Figura 6: Compara\u00e7\u00e3o dos dados do Fornecedor</p> <p>S\u00e3o geradas duas linhas, sendo a primeira com os dados do XML e a segunda com os dados encontrados no Protheus (isso se o fornecedor estiver cadastrado no Protheus).</p> <p>As colunas com inconsist\u00eancia nas informa\u00e7\u00f5es s\u00e3o destacadas em vermelho para melhor identifica\u00e7\u00e3o.</p> <p>\u00c9 poss\u00edvel configurar quais colunas que deseja auditar conforme abaixo:</p> <p>Criar um par\u00e2metro com o nome ZZ_FORNC1 do tipo l\u00f3gico, ent\u00e3o se o conte\u00fado dele for .T. a coluna ser\u00e1 auditada.</p> <p>O n\u00famero no final do par\u00e2metro ZZ_FORNC1 corresponde a posi\u00e7\u00e3o da coluna em quest\u00e3o, contando da esquerda para a direita, portando se quiser auditar a coluna CNPJ/CPF, por exemplo, dever\u00e1 ativar o par\u00e2metro ZZ_FORNC4.</p>"},{"location":"xmle/manuais/checkdoc/#validacoes-do-fornecedor","title":"Valida\u00e7\u00f5es do fornecedor","text":"<ul> <li> <p>ZZ_FORNC1  - Origem (XML e ERP)</p> </li> <li> <p>ZZ_FORNC2  - Valida a raz\u00e3o social</p> </li> <li> <p>ZZ_FORNC3  - Valida o nome fantasia</p> </li> <li> <p>ZZ_FORNC4  - Valida o CNPJ</p> </li> <li> <p>ZZ_FORNC5  - Valida a inscri\u00e7\u00e3o estadual</p> </li> <li> <p>ZZ_FORNC6  - Valida o bairro</p> </li> <li> <p>ZZ_FORNC7  - Valida o c\u00f3digo munic\u00edpio</p> </li> <li> <p>ZZ_FORNC8  - Valida o Munic\u00edpio</p> </li> <li> <p>ZZ_FORNC9  - Valida a UF</p> </li> <li> <p>ZZ_FORNC10 - Valida o CEP</p> </li> </ul>"},{"location":"xmle/manuais/checkdoc/#produtos","title":"Produtos","text":"<p>No setor \u201cProdutos\u201d ser\u00e1 realizado a an\u00e1lise das informa\u00e7\u00f5es do produto e pedido de compra que est\u00e1 no Protheus e as informa\u00e7\u00f5es que est\u00e3o no XML.</p> <p> Figura 7: Compara\u00e7\u00e3o dos dados dos Produtos</p> <p>S\u00e3o geradas duas linhas para cada item do XML, sendo a primeira com os dados do XML e a segunda com os dados encontrados no Protheus (isso se o fornecedor enviar os dados do pedido de compra nas tags corretas ou pelo menos j\u00e1 existir a amarra\u00e7\u00e3o Produto x Fornecedor).</p> <p>As colunas com inconsist\u00eancia nas informa\u00e7\u00f5es s\u00e3o destacadas em vermelho para melhor identifica\u00e7\u00e3o.</p> <p>\u00c9 poss\u00edvel configurar quais colunas que deseja auditar conforme abaixo:</p> <p>Criar um par\u00e2metro com o nome ZZ_PRODC1 do tipo l\u00f3gico, ent\u00e3o se o conte\u00fado dele for .T. a coluna ser\u00e1 auditada.</p> <p>O n\u00famero no final do par\u00e2metro ZZ_PRODC1 corresponde a posi\u00e7\u00e3o da coluna em quest\u00e3o, contando da esquerda para a direita, portando se quiser auditar a coluna \u201cNumero PC\u201d, por exemplo, dever\u00e1 ativar o par\u00e2metro ZZ_PRODC6.</p>"},{"location":"xmle/manuais/checkdoc/#validacoes-dos-produtos","title":"Valida\u00e7\u00f5es dos produtos","text":"<ul> <li> <p>ZZ_PRODC1   - Valida o total de itens no xml</p> </li> <li> <p>ZZ_PRODC3   - Valida se o c\u00f3digo do produto</p> </li> <li> <p>ZZ_PRODC4   - Valida a descri\u00e7\u00e3o do produto </p> </li> <li> <p>ZZ_PRODC5   - Valida o NCM do produto </p> </li> <li> <p>ZZ_PRODC6   - Valida se o n\u00famero do pedido de compra est\u00e1 igual ao do XML</p> </li> <li> <p>ZZ_PRODC7   - Valida se o n\u00famero da ordem dos itens 001,002,...</p> </li> <li> <p>ZZ_PRODC8   - Valida a quantidade</p> </li> <li> <p>ZZ_PRODC9   - Valida o pre\u00e7o unit\u00e1rio</p> </li> <li> <p>ZZ_PRODC10  - Valida o pre\u00e7o total do item </p> </li> <li> <p>ZZ_PRODC11  - Valida a unidade de medida</p> </li> <li> <p>ZZ_PRODC12  - Valida o tipo do frete CIF ou FOB</p> </li> </ul> -FIM-"},{"location":"xmle/manuais/devol-venda/","title":"10 - Devolu\u00e7\u00e3o de Venda","text":""},{"location":"xmle/manuais/devol-venda/#devolucao-de-venda","title":"Devolu\u00e7\u00e3o de Venda","text":""},{"location":"xmle/manuais/devol-venda/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objeto desse manual \u00e9 demonstrar a utiliza\u00e7\u00e3o da funcionalidade de devolu\u00e7\u00e3o de vendas pela Central XML-e.</p> <p>Ser\u00e1 verificado:</p> <ul> <li>Vendas realizadas para o cliente.</li> <li>Demonstra as quantidades j\u00e1 devolvidas por nota fiscal de venda.</li> <li>Permite f\u00e1cil amarra\u00e7\u00e3o entre a nota de venda e o item devolvido.</li> </ul>"},{"location":"xmle/manuais/devol-venda/#como-usar","title":"Como usar?","text":"<p>Para que seja realizado a devolu\u00e7\u00e3o da venda, basta selecionar o documento desejado na tela principal da Central XML-e e chamar a ferramenta conforme demonstrado na imagem abaixo:</p> <p> Figura 01: Op\u00e7\u00e3o 'Devolu\u00e7\u00e3o Venda' </p> <p>Ser\u00e1 apresentado uma nova tela conforme a imagem abaixo:</p> <p> Figura 02: Filtrar notas de sa\u00edda </p> <p>No formul\u00e1rio \u201cDocumentos de Sa\u00edda\u201d ir\u00e1 demonstrar todas as notas fiscais de vendas para o cliente em quest\u00e3o que ainda possuem saldo a serem devolvidos. Esse formul\u00e1rio possui um filtro inteligente para que a busca pelo documento/item devolvido seja mais r\u00e1pida e f\u00e1cil.</p> <p>No formul\u00e1rio \u201cSimula\u00e7\u00e3o da Devolu\u00e7\u00e3o\u201d demonstra os itens devolvidos pelo cliente.</p> <p>Para vincular o item da venda com o item devolvido, basta dar 2 cliques no item desejado no formul\u00e1rio de cima (note que a legenda do item selecionado vai ficar verde) e dar 2 cliques no item do XML devolvido pelo cliente (o item tamb\u00e9m ficar\u00e1 verde).</p> <p>Ap\u00f3s realizar a amarra\u00e7\u00e3o de todos os itens com seus respectivos documento de sa\u00edda, basta clicar no bot\u00e3o confirmar para iniciar o processo de gera\u00e7\u00e3o do documento de sa\u00edda.</p> <p> Figura 03: Op\u00e7\u00e3o 'Confirmar' </p> <p>A partir desse momento a rotina seguir\u00e1 o fluxo normal do processo de entrada de documentos da Central XML-e. Basta conferir os dados gerados e concluir a entrada do documento fiscal.</p> -FIM-"},{"location":"xmle/manuais/entrada-lote/","title":"13 - Entrada em Lote","text":""},{"location":"xmle/manuais/entrada-lote/#entrada-em-lote","title":"Entrada em Lote","text":""},{"location":"xmle/manuais/entrada-lote/#objetivo","title":"Objetivo","text":"<p>Facilitar a entrada massiva de: Pr\u00e9-notas e Documento de Entrada, sempre que, exista previamente o cadastro de fornecedores, e a rala\u00e7\u00e3o de produtos x fornecedor na Central XML.</p> <p>Observa\u00e7\u00e3o: A rotina usa os XML\u00b4s baixados.</p> <p>Para utilizar a funcionalidade, acesse a central xml-e devidamente configurada em seu menu no Protheus e selecione: Central Xml &gt; Outras A\u00e7\u00f5es &gt; Entrada em Lote.</p> <ul> <li>Como na imagem abaixo:</li> </ul> <p> Figura 1: Op\u00e7\u00e3o entrada em lote </p>"},{"location":"xmle/manuais/entrada-lote/#definir-os-filtros-para-receber-os-xmls","title":"Definir os filtros para receber os XMLs","text":"<p> Figura 2: Tela de Par\u00e2metros </p> <ul> <li>Filial de; at\u00e9: Selecionar a filial;</li> <li>Documento de; at\u00e9: N\u00fameros de documentos de entrada;</li> <li>Serie de; at\u00e9: S\u00e9ries dos documentos de entrada; </li> </ul> <p> Figura 3: Tela de Par\u00e2metros </p> <ul> <li>CNPJ de; at\u00e9: CNPJ\u00b4s dos fornecedores \u2013 num\u00e9rico sem formata\u00e7\u00e3o-;</li> <li>Emiss\u00e3o de; at\u00e9: Datas das entradas das notas;</li> <li>Tipo de Documento: Nf-e ou CT-e; </li> </ul> <p>Caso os filtros n\u00e3o encontrem concord\u00e2ncia com os dados no sistema (datas, documentos, cnpj e etc.), ser\u00e1 apresentada a tela abaixo.</p> <p> Figura 4: Erro nos filtros dos Par\u00e2metros </p> <p>Nessa situa\u00e7\u00e3o, refa\u00e7a os filtros e tente de novo.</p> <p>Ap\u00f3s fazer o passo anterior voc\u00ea ver\u00e1 uma nova tela com os XML\u00b4s.</p> <p> Figura 5: Pr\u00e9-Nota em Lote </p> <p>Para selecionar todos os xmls, \u00e9 necess\u00e1rio apertas duas vezes na coluna em amarelo, agora, se quer selecionar os xmls individualmente, \u00e9 necess\u00e1rio apertar duas vezes cada quadradinho referente a cada xml.</p>"},{"location":"xmle/manuais/entrada-lote/#gerar-pre-nota","title":"Gerar Pr\u00e9-Nota","text":"<p>Ap\u00f3s selecionar os xmls que deseja, clicar em \"Gerar Pr\u00e9-nota\".</p> <p> Figura 6: Resultado do Processamento em Lote </p> <p>Foi gerada a pre-nota..!</p> <p>Em seguida, fechar a tela de entrada em lote e sair da rotina Central-xml para atualizar o status.</p> <p> Figura 7: Tela Principal da Central XML-e com as Legendas </p> <p>Essa nota fica com amarelo: \u201cdocumento com pr\u00e9-nota\u201d</p> <p>Acessse a rotina padr\u00e3o \u201cPre Nota Entrada\u201d, e verifique que j\u00e1 esta essa nota.</p> <p>OBS.: pode excluir a prenota e repetir o processo em lote.</p>"},{"location":"xmle/manuais/entrada-lote/#gerar-documento-de-entrada","title":"Gerar Documento de Entrada","text":"<p>Ao apertar o bot\u00e3o \"Gerar Doc. Entrada\", aparecer\u00e1 a tela abaixo.</p> <p> Figura 8: Informar TES e Condi\u00e7\u00e3o de Pagamento </p> <p>Informar TES e condi\u00e7\u00e3o de Pagamento.</p> <p>OBS.: Esta rotina dara entrada em notas, sem considerar obrigatoriedade de pedidos de compra. S\u00f3 recomendada para entradas de notas com a mesma TES e condi\u00e7\u00e3o de pagamento.</p> <p>Mostra a tela confrontando os dados de impostos do XML, e o que esta calculando nas configura\u00e7oes de impostos do Protheus.</p> <p> Figura 9: Confronto de dados de impostos do XML </p> <p>Se tiver inconsistencias, vai avisar se deseja mesmo assim, dar entrada na nota. S\u00f3 podera dar entrada se tiver a senha que autoriza.</p> <p>Obs: no cabe\u00e7aho de totais, mostra os impostos procipais, e no detalhe, mostra as divergencias ou n\u00e3o,  por item (use a barra de rolagem)</p> <p>Ap\u00f3s \u201cSALVAR\u201d, pode verificar na rotina padrao protheus: \u201cDocumanto de Entrada\u201d, a nota de entrada.</p>"},{"location":"xmle/manuais/entrada-lote/#erros-nos-processos-gerar-pre-nota-e-gerar-documento-de-entrada","title":"Erros nos processos, Gerar Pr\u00e9-Nota e Gerar Documento de Entrada","text":"<p> Figura 10: Poss\u00edveis erros na Entrada em Lote </p> <p>Caso o xml esteja sem vinculo com dados do Portheus, por exemplo: Fornecedor ou codigo de produto ralacionado. </p> <p>Sera apresentado o aviso de erro.</p> -FIM-"},{"location":"xmle/manuais/fracionar-itens/","title":"05 - Processo de fracionar itens","text":""},{"location":"xmle/manuais/fracionar-itens/#processo-de-fracionar-itens","title":"Processo de Fracionar Itens","text":""},{"location":"xmle/manuais/fracionar-itens/#fracionar-itens","title":"Fracionar itens","text":"<p>Escolha o item a ser fracionado e clique duas vezes nele, nisso ser\u00e1 aberto uma tela com a op\u00e7\u00e3o de Fracionar Item: </p> <p> Figura 1: In\u00edcio do processo para fracionamento de itens </p> <p>Selecione a op\u00e7\u00e3o \u201cFracionar Item\u201d: </p> <p> Figura 2: Tela com op\u00e7\u00e3o para fracionar item </p> <p>Digite a quantidade para o segundo item: </p> <p> Figura 3: Tela para receber a quantidade fracionada </p> <p>Veja que o item foi fracionado na quantidade informada: </p> <p> Figura 4: Exibi\u00e7\u00e3o do item fracionado </p> <p>Para vincular o pedido de compra no item fracionado, de novamente um duplo clique no item e dessa vez escolha a op\u00e7\u00e3o \u201cAlterar pedido de compra\u201d:</p> <p> Figura 5: Item para alterar o PC </p> <p>Selecione a op\u00e7\u00e3o \u201cAlterar Pedido de Compra\u201d: </p> <p> Figura 6: Alterar Pedido de Compra </p> <p>Selecione o pedido de compra na nova tela:</p> <p> Figura  7: Selecionando PC </p> <p>Selecione o segundo item e novamente d\u00ea um duplo clique para escolher o pedido de compra: </p> <p> Figura 8: Associar segundo item a PC </p> <p>Clique em \u201cAlterar Pedido de Compra\u201d:</p> <p> Figura 9: Alterar Pedido de Compra do segundo item </p> <p>Selecione o pedido de compra para o segundo item:</p> <p> Figura 10: Selecionando PC do segundo item </p> <p>Veja que os itens fracionados est\u00e3o vinculados aos pedidos de compras selecionados: </p> <p> Figura 11: Itens associados \u00e0 PC </p> <p>Na tela para classifica\u00e7\u00e3o, ser\u00e1 gerado dois itens com as quantidades fracionadas: </p> <p> Figura 12: Classifica\u00e7\u00e3o com item fracionado </p> <p>E cada item ter\u00e1 a amarra\u00e7\u00e3o com o seu respectivo pedido de compra: </p> <p> Figura 13: Classifica\u00e7\u00e3o com amarra\u00e7\u00e3o de Item x PC </p> -FIM-"},{"location":"xmle/manuais/importacao-manual/","title":"04 - Importa\u00e7\u00e3o de XML manual","text":""},{"location":"xmle/manuais/importacao-manual/#importacao-de-xml-manual","title":"Importa\u00e7\u00e3o de XML manual","text":""},{"location":"xmle/manuais/importacao-manual/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo da importa\u00e7\u00e3o manual \u00e9 realizar manualmente a importa\u00e7\u00e3o de arquivos XML pontuais, de acordo com a necessidade.</p>"},{"location":"xmle/manuais/importacao-manual/#como-usar","title":"Como usar?","text":"<p>Na Central XML-e, ir em Outras A\u00e7\u00f5es &gt;&gt; Importa XML Computador, conforme imagem abaixo. </p> <p> Figura 1: Acesso \u00e0 rotina pela Central XML-e </p> <p>Na janela de sele\u00e7\u00e3o, escolher o diret\u00f3rio onde est\u00e3o os arquivos XML.</p> <p> Figura 2: Escolher diret\u00f3rio </p> <p>Na tela da rotina, basta selecionar os arquivos desejados. \u00c9 importante prestar aten\u00e7\u00e3o na legenda, apenas arquivos com legenda cinza podem ser importados.</p> <p> Figura 3: Tela de importa\u00e7\u00e3o </p> <p>Ap\u00f3s isso, a mudan\u00e7a de status indicar\u00e1 se a importa\u00e7\u00e3o foi bem-sucedida. Para finalizar, basta sair da rotina.</p> <p> Figura 4: Tela p\u00f3s importa\u00e7\u00e3o e legendas </p> -FIM-"},{"location":"xmle/manuais/manifestacao-lote/","title":"08 - Manifesta\u00e7\u00e3o em lote","text":""},{"location":"xmle/manuais/manifestacao-lote/#manifestacao-em-lote","title":"Manifesta\u00e7\u00e3o em lote","text":""},{"location":"xmle/manuais/manifestacao-lote/#processo-de-manifestacao-do-destinatario-em-lote","title":"Processo de manifesta\u00e7\u00e3o do destinat\u00e1rio em lote","text":"<p>Na rotina Central XML-e acessar \u201cOutras A\u00e7\u00f5es\u201d e depois \u201cManifesta\u00e7\u00e3o em Lote\u201d.</p> <p> Figura 1: Op\u00e7\u00e3o no menu 'Manifesta\u00e7\u00e3o em Lote' </p> <p>Ser\u00e1 permitido realizar diversos tipos de filtros diferentes nas perguntas logo no in\u00edcio da rotina:</p> <p> Figura 2: Tela de Par\u00e2metros </p> <p>Outros filtros poder\u00e3o ser realizados diretamente na tela de manifesta\u00e7\u00e3o em lote. Selecione as chaves que deseja selecionar marcando um [X] nelas e clique no bot\u00e3o \u201cManifestar\u201d.</p> <p> Figura 3: Sele\u00e7\u00e3o para Manifestar </p> <p>Ser\u00e1 solicitado qual o tipo de manifesta\u00e7\u00e3o deseja realizar:</p> <p> Figura 4: Sele\u00e7\u00e3o do tipo de Manifesta\u00e7\u00e3o </p> <p>Ao final do processamento ser\u00e1 exibido uma tela com todas as chaves que foram manifestadas, conforme imagem abaixo:</p> <p> Figura 5: Tela com chaves manifestadas </p> -FIM-"},{"location":"xmle/manuais/manual-usuario/","title":"03 - Manual do Usu\u00e1rio","text":""},{"location":"xmle/manuais/manual-usuario/#manual-do-usuario","title":"Manual do Usu\u00e1rio","text":""},{"location":"xmle/manuais/manual-usuario/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O FACILE XML-e \u00e9 uma ferramenta desenvolvida no ERP Protheus visando controle e agilidade nos processos de Entrada de Nota Fiscal Eletr\u00f4nica e Confer\u00eancia de Impostos.</p> <p>A ferramenta possui uma rotina que trabalha de maneira autom\u00e1tica e transparente monitorando no SEFAZ os documentos fiscais emitidos pelos fornecedores e disponibilizando diversas funcionalidades como Manifesta\u00e7\u00e3o do Destinat\u00e1rio, Importa\u00e7\u00e3o do XML, Relat\u00f3rios, Confronto de Impostos calculados pelo ERP Protheus versus Impostos do XML, entre outros.</p>"},{"location":"xmle/manuais/manual-usuario/#a-ferramenta","title":"A Ferramenta","text":"<p>Para acess\u00e1-la, entre no m\u00f3dulo SIGACOM, no meu principal, clique em atualiza\u00e7\u00f5es e acesse a Facile XML-e, como descrito na Figura 1.</p> <p> Figura 1: Menu principal</p> <p>A Central XML-e auxilia no processo de gera\u00e7\u00e3o de documentos de entrada.</p> <p>A Gest\u00e3o \u00e0 Vista auxilia no gerenciamento dos documentos.</p>"},{"location":"xmle/manuais/manual-usuario/#facile-central-xml-e","title":"FACILE Central XML-e","text":"<p>A Figura 2 mostra a tela principal que \u00e9 a Central XML-e.</p> <p>Nela \u00e9 poss\u00edvel realizar as seguintes a\u00e7\u00f5es: Cadastrar Fornecedor, Imprimir Danfe/Dacte, Gerar Entrada, acessar Outras A\u00e7\u00f5es e pesquisar.</p> <p> Figura 2: Tela Central XML-e</p>"},{"location":"xmle/manuais/manual-usuario/#cadastrar-fornecedor","title":"Cadastrar Fornecedor","text":"<p>Ao cliente no bot\u00e3o +Cad. Fornecedor, da figura 3 abaixo:</p> <p> Figura 3: Bot\u00e3o Cad. Fornecedor</p> <p>Ao selecionar o XML desejado e clicar em +Cad. Fornecedor, poder\u00e1 ter uma mensagem de Fornecedor j\u00e1 cadastrado, caso o mesmo j\u00e1 se encontre na base de dados do Protheus (SA2). Se isso ocorrer ser\u00e1 apresentado a figura 4 abaixo:</p> <p> Figura 4: Fornecedor encontrado na SA2</p> <p>Caso contr\u00e1rio, ir\u00e1 abrir o cadastro padr\u00e3o de Fornecedor no ERP Protheus (SA2) conforme a figura 5 abaixo:</p> <p> Figura 5: Incluindo Fornecedor na SA2</p>"},{"location":"xmle/manuais/manual-usuario/#imprimir-documento","title":"Imprimir Documento","text":"<p>Nessa op\u00e7\u00e3o, basta selecionar o XML desejado para imprimir a DANFE ou DACTE correspondente. </p> <ul> <li>Imprimir DANFE/DACTE: ao selecionar um registro e clicar nessa op\u00e7\u00e3o, o sistema ir\u00e1 solicitar as configura\u00e7\u00f5es necess\u00e1rias para imprimir a DANFE, assim como descrito na Figura 6.</li> </ul> <p> Figura 6: Configura\u00e7\u00f5es de Impress\u00e3o</p>"},{"location":"xmle/manuais/manual-usuario/#gerar-entrada-inicio-do-processo-diario","title":"Gerar Entrada (In\u00edcio do processo di\u00e1rio)","text":"<p>Para gerar uma entrada, selecione uma NF e clique no bot\u00e3o Gerar Entrada, como mostra a Figura 7 abaixo:</p> <p> Figura 7: Tela principal com foco no bot\u00e3o Gerar Entrada</p> <p>Se n\u00e3o houver um XML baixado para aquela NF, ent\u00e3o o sistema se conectar\u00e1 com o SEFAZ e realizar\u00e1 o download.</p> <p> Figura 8: Conex\u00e3o com o SEFAZ</p> <p>Ap\u00f3s isso, o sistema ir\u00e1 apresentar uma tela para defini\u00e7\u00e3o do Tipo de Nota que est\u00e1 sendo realizado a entrada, sendo o padr\u00e3o \u201cNormal\u201d. Conforme a figura 9 abaixo:</p> <p> Figura 9: Tipos de Notas</p> <p>Caso a Nota Fiscal tenha alguma Carta de Corre\u00e7\u00e3o atrelada, ser\u00e1 apresentado logo na abertura.</p> <p> Figura 9.1: Carta de Corre\u00e7\u00e3o</p> <p>Ap\u00f3s isso, o sistema ir\u00e1 redirecionar para a tela \u201cGERAR ENTRADA\u201d, como exemplificado na Figura 10. A tela \u00e9 dividida em tr\u00eas sub menus, s\u00e3o eles: cabe\u00e7alho, itens e Pr\u00e9-Nota.</p> <p> Figura 10: Tela de Gerar Entrada</p> <p>A Figura 11 mostra os Itens, que s\u00e3o divididos em tr\u00eas grupos, sendo eles: itens NF-e (XML), Produto X Fornecedor e Pedidos de Compra.</p> <p> Figura 11: Sub menu Itens</p> <p>No grupo Itens NF-e (XML), \u00e9 listado todos os produtos relacionados \u00e0quela NF. Deve-se selecionar cada item com um duplo click para que o sistema mostre a amarra\u00e7\u00e3o ProdutoxFornecedor.</p> <p> Figura 12: Tela Itens NF-e (XML)</p> <p>Ao selecionar um produto, no grupo Produto x Fornecedor ser\u00e1 mostrado o produto equivalente ao que foi selecionado (Figura 13). </p> <p> Figura 13: Rela\u00e7\u00e3o Produto x Fornecedor</p> <p>Se n\u00e3o houver um produto equivalente, ser\u00e1 necess\u00e1rio inserir clicando no \u00edcone + Inclui, ao lado do nome Produto X Fornecedor (Figura 14).</p> <p> Figura 14: Bot\u00e3o de relacionar itens</p> <p>Ser\u00e1 aberta uma janela de busca onde mostrar\u00e1 os produtos dispon\u00edveis, assim como na Figura 15 abaixo:</p> <p> Figura 15: Produtos Dispon\u00edveis</p> <p>Obs. Tamb\u00e9m pode ser filtrado pelo pr\u00f3prio NCM do produto no XML (Figura 16: Bot\u00e3o NCN do XML),</p> <p> Figura 16: Bot\u00e3o NCN do XML</p> <p>Caso exista um Pedido de Compras, basta marcar o Checkbox \u201cBuscar Somente com Pedido de Compras (Figura 17).</p> <p> Figura 17: Buscar Somente com Pedido de Compras</p> <p>No grupo Pedidos de Compra, ser\u00e3o listados os pedidos relacionados aqueles produtos, se houver (Figura 18).</p> <p> Figura 18: Tela de Pedidos de Compra</p> <p>A Figura 19, mostra uma Pr\u00e9-Nota com os produtos selecionados no subgrupo Itens. Se o produto tiver sido selecionado, ent\u00e3o ele estar\u00e1 com o status Liberado, representado pela legenda verde. Se n\u00e3o tiver sido selecionado, ele estar\u00e1 com status Pendente, representado pela legenda vermelha.</p> <p> Figura 19: Pr\u00e9-Nota com um produto Pendente e outro Liberado</p> <p>Aten\u00e7\u00e3o: \u00c9 necess\u00e1rio que todos os itens estejam liberados (Status Verde) para prosseguir, conforme figura 20 abaixo:</p> <p> Figura 20: Pr\u00e9-Nota com todos itens Liberados</p> <p>Ap\u00f3s essas configura\u00e7\u00f5es, clique no bot\u00e3o Confirmar e a Pr\u00e9-Nota estar\u00e1 realizada.</p> <p> Figura 21: Confirmar cria\u00e7\u00e3o da Pr\u00e9-Nota</p> <p>Depois de terminar de processar as informa\u00e7\u00f5es, o sistema ir\u00e1 redirecionar para a tela do Documento de Entrada PADR\u00c3O (Gerar Entrada), como mostra a Figura 22.</p> <p> Figura 22: Tela para gerar entrada</p> <p>Nessa tela, \u00e9 necess\u00e1rio escolher o Tipo de Entrada para cada produto, al\u00e9m de preencher as informa\u00e7\u00f5es sobre condi\u00e7\u00f5es de pagamento, descri\u00e7\u00e3o e natureza dos produtos, na aba Duplicatas, como mostra a Figura 23.</p> <p> Figura 23: Aba duplicata</p> <p>Em seguida, clique no bot\u00e3o salvar e aguarde a tela de confirma\u00e7\u00e3o.</p> <p>Caso o sistema detecte diverg\u00eancias entre a TES informada e o XML importado, apresentar\u00e1 a seguinte tela da Figura 24: Onde demonstra nas colunas 1 e 3 de acordo com o que est\u00e1 parametrizado na TES e nas colunas 2 e 4 como veio no XML.</p> <p> Figura 24: Confronto XML x TES</p> <p>Obs. Pode ser feita a corre\u00e7\u00e3o manual e continuar o processo normalmente.</p> <p>Caso n\u00e3o tenha verificado nenhuma diverg\u00eancia entre o TES x XML ou as mesmas tenham sidos sanadas/ignoradas, o sistema dar\u00e1 a op\u00e7\u00e3o de transmitir a manifesta\u00e7\u00e3o de confirma\u00e7\u00e3o para o SEFAZ, como mostra a Figura 25.</p> <p> Figura 25: Op\u00e7\u00e3o de transmiss\u00e3o para o SEFAZ</p> <p>Ao selecionar a op\u00e7\u00e3o sim, o sistema mostrar\u00e1 a tela de Manifesta\u00e7\u00e3o (Figura 26).</p> <p> Figura 26: Tela de Manifesta\u00e7\u00e3o</p> <p>Caso seja selecionado N\u00c3O (na Figura 25) ou ap\u00f3s a manifesta\u00e7\u00e3o, o sistema redirecionar\u00e1 para a tela Central XML-e com a legenda da nota criada alterada para o status \u201cNF-e possui classifica\u00e7\u00e3o\u201d, representada pela cor vermelha, assim como mostra a Figura 27. </p> <p> Figura 27: Central XML-e com nota classificada</p> <p>Dessa maneira, o processo de Documento de Entrada e Manifesta\u00e7\u00e3o est\u00e1 finalizado.</p>"},{"location":"xmle/manuais/manual-usuario/#outras-acoes","title":"Outras A\u00e7\u00f5es","text":"<p>Ao selecionar Outras A\u00e7\u00f5es, um menu aparecer\u00e1 contendo todas as op\u00e7\u00f5es listadas abaixo:</p> <p> Figura 28: Menu de Outras A\u00e7\u00f5es</p> <ul> <li>Pesquisar: essa funcionalidade disponibiliza uma maneira mais r\u00e1pida de procurar por um registro, que pode ser feito por meio da chave NF e outros filtros padr\u00e3o, como mostra a Figura 29. A Figura 30, mostra a tela de pesquisa ap\u00f3s clicar no bot\u00e3o par\u00e2metros, permitindo a entrada das outras informa\u00e7\u00f5es para filtragem de acordo com o filtro selecionado.</li> </ul> <p> Figura 29: Filtros poss\u00edveis</p> <p> Figura 30: Tela de pesquisa mostrando os par\u00e2metros</p> <ul> <li> <p>Documento de Entrada: essa funcionalidade disponibiliza de uma maneira r\u00e1pida as op\u00e7\u00f5es de Entrada de NF a fim de agilizar o dia a dia do usu\u00e1rio. A Figura 31, mostra as op\u00e7\u00f5es dispon\u00edveis.</p> <p> Figura 31: Op\u00e7\u00f5es de Documento de Entrada</p> <ul> <li>Pr\u00e9-Nota - Classificar: essa op\u00e7\u00e3o s\u00f3 estar\u00e1 dispon\u00edvel se houver uma Pr\u00e9-Nota lan\u00e7ada e o XML constar no ERP, assim como mostra a Figura 32. \u00c9 poss\u00edvel identificar um registro que possui Pr\u00e9-Nota lan\u00e7ada se essa estiver com legenda amarela (Figura 33).</li> </ul> </li> </ul> <p> Figura 32: Aviso sobre restri\u00e7\u00e3o para classificar nota</p> <p> Figura 33: Registro com legenda amarela representando que existe uma Pr\u00e9-Nota lan\u00e7ada</p> <ul> <li> <p>NF-e: Engloba v\u00e1rias fun\u00e7\u00f5es da NF-e no mesmo submenu a fim de agilizar o dia a dia do usu\u00e1rio. A Figura 34, mostra as op\u00e7\u00f5es dispon\u00edveis.</p> <p> Figura 34: Op\u00e7\u00f5es de NF-e</p> <ul> <li> <p>Classificar NF-e: essa op\u00e7\u00e3o s\u00f3 estar\u00e1 dispon\u00edvel se houver uma Pr\u00e9-Nota lan\u00e7ada e o XML constar no ERP, assim como mostra a Figura 32. \u00c9 poss\u00edvel identificar um registro que possui Pr\u00e9-Nota lan\u00e7ada se essa estiver com legenda amarela (Figura 33).</p> </li> <li> <p>Buscar Chave Avulsa: ao inv\u00e9s de sincronizar todos os documentos, o sistema permite buscar uma chave espec\u00edfica. A Figura 35 mostra a tela de busca.</p> </li> </ul> <p> Figura 35: Tela de busca de chave avulsa</p> <ul> <li>Manifestar: a tela de manifesta\u00e7\u00e3o cont\u00e9m as seguintes partes: Manifesto, Emitente e Nota Fiscal, como mostra a Figura 36.</li> </ul> <p>No Manifesto, dever\u00e1 ser inserido o tipo de manifesta\u00e7\u00e3o que est\u00e1 sendo realizada, a qual est\u00e1 dividida em quatro op\u00e7\u00f5es: </p> <ol> <li>Confirma\u00e7\u00e3o da Opera\u00e7\u00e3o: o emitente reconhece a opera\u00e7\u00e3o e a confirma.</li> <li>Ci\u00eancia da Opera\u00e7\u00e3o: o emitente reconhece a opera\u00e7\u00e3o, por\u00e9m ainda n\u00e3o est\u00e1 confirmada.</li> <li>Desconhecimento da Opera\u00e7\u00e3o: o emitente n\u00e3o reconhece a opera\u00e7\u00e3o.</li> <li>Opera\u00e7\u00e3o n\u00e3o Realizada: o emitente gerou a nota, por\u00e9m houve algum cancelamento e a opera\u00e7\u00e3o n\u00e3o foi efetivamente realizada.</li> </ol> <p>No Emitente, cont\u00e9m as informa\u00e7\u00f5es de quem est\u00e1 emitindo, assim como na Nota Fiscal cont\u00e9m as informa\u00e7\u00f5es da nota fiscal que ser\u00e1 manifestada.</p> <p> Figura 36: Tela de Manifesta\u00e7\u00e3o</p> <ul> <li>Monitorar: essa op\u00e7\u00e3o serve para acompanhar a nota ap\u00f3s a manifesta\u00e7\u00e3o. A Figura 37 mostra um exemplo de informa\u00e7\u00f5es necess\u00e1rias para realizar o monitoramento.</li> </ul> <p> Figura 37: Tela de monitoramento</p> <ul> <li>Manifestar em Lote: Atrav\u00e9s dessa op\u00e7\u00e3o \u00e9 poss\u00edvel realizar a manifesta\u00e7\u00e3o de um LOTE de XML de uma \u00fanica vez. A Figura 38 mostra a tela de par\u00e2metros necess\u00e1ria para filtrar quais notas ser\u00e3o manifestadas.,</li> </ul> <p> Figura 38: Par\u00e2metros para manifestar em lote</p> </li> </ul> <p>Ser\u00e1 apresentada a tela da figura 39 abaixo. Nela deve-se marcar (duplo click) quais XML ir\u00e3o ser manifestados, depois clicar em Manifestar.</p> <p> Figura 39: Manifesta\u00e7\u00e3o em lote.</p> <ul> <li>NFS-e Beta: Rotina de importa\u00e7\u00e3o de PDF\u00b4s de Notas Fiscais de Servi\u00e7o, conforme mostra a Figura 40 abaixo:</li> </ul> <p> Figura 40: Importar PDF de NFS-e</p> <p>Obs. Ser\u00e1 necess\u00e1rio ter o arquivo no formato PDF em uma pasta no computador.</p> <p> Figura 41: Pasta com PDF de NFS-e</p> <p>Ao selecionar a pasta onde se encontram os PDF\u00b4s, ir\u00e1 abrir a tela para selecionar quais ser\u00e3o importados. </p> <p> Figura 42: Importa\u00e7\u00e3o de NFS-e por PDF</p> <ol> <li>Clicar no Bot\u00e3o Importar PDF para a ferramenta analisar e importar os PDF da pasta;</li> <li>Ap\u00f3s os PDF terem sido importados, caso deseje, pode-se gerar a entrada de todas as NFS-e nesta mesma tela atrav\u00e9s da op\u00e7\u00e3o Gerar Doc. Entrada.</li> </ol> <p>Aten\u00e7\u00e3o: Caso alguma NFS-e no formado PDF n\u00e3o seja importada, apresentando a mensagem \u201cModelo n\u00e3o encontrado\u201d, ficar\u00e1 com status vermelho conforme imagem 43. Deve-se abrir um ticket no portal da FACILE, anexando o PDF da NFS-e em quest\u00e3o, solicitando homologa\u00e7\u00e3o de munic\u00edpio.</p> <p> Figura 43: Munic\u00edpio n\u00e3o Homologado</p> <ul> <li> <p>CT-e: Neste menu est\u00e3o agrupadas as fun\u00e7\u00f5es destinadas ao CT-e, conforme mostra a Figura 44 abaixo:</p> <p> Figura 44: Menu de CT-e</p> <ul> <li>Buscar SEFAZ: esta op\u00e7\u00e3o tem por objetivo buscar no SEFAZ nos \u00faltimos 90 dias, documentos que ainda n\u00e3o foram baixados automaticamente. </li> </ul> <p> Figura 45: Busca SEFAZ de CT-e</p> <ul> <li>Consulta Status: esta op\u00e7\u00e3o tem por objetivo buscar o status do CTE selecionado junto ao SEFAZ, conforme figura 46.</li> </ul> <p> Figura 46: Consulta Status do CT-e no SEFAZ</p> <ul> <li>Manif. Desacordo: esta op\u00e7\u00e3o tem por objetivo transmitir a manifesta\u00e7\u00e3o de desacordo no SEFAZ do CTE selecionado, conforme figura 47. Obs. \u00c9 necess\u00e1rio preencher uma observa\u00e7\u00e3o com no m\u00ednimo 15 e no m\u00e1ximo 255 caracteres.</li> </ul> <p> Figura 47: Manifesta\u00e7\u00e3o de Desacordo do CT-e no SEFAZ</p> <ul> <li>Monitorar: essa op\u00e7\u00e3o serve para acompanhar o CT-e ap\u00f3s a manifesta\u00e7\u00e3o.</li> </ul> </li> <li> <p>Manuten\u00e7\u00e3o TI: Menu destinado aos administradores do ERP Protheus de sua empresa, acesso apenas com permiss\u00e3o de Admin.</p> <p> Figura 48: Op\u00e7\u00f5es de Manuten\u00e7\u00e3o TI</p> <ul> <li>Buscar Avan\u00e7ada SEFAZ (Somente Admin): esta op\u00e7\u00e3o tem por objetivo sincronizar com a SEFAZ os documentos que ainda n\u00e3o sofreram manifesta\u00e7\u00f5es do destinat\u00e1rio. A Figura 49 mostra a tela do sistema para essa op\u00e7\u00e3o.</li> </ul> <p> Figura 49: Tela para sincronizar documentos</p> </li> </ul> <p>Obs. O sistema \u00e9 parametrizado para realizar essa busca automaticamente, assim o Bot\u00e3o \u201cBuscar Avan\u00e7ada SEFAZ\u201d serve para for\u00e7ar essa busca a qualquer momento caso os servi\u00e7os autom\u00e1ticos n\u00e3o estejam funcionando ou desativados.</p> <ul> <li>Relat\u00f3rios: Nesse menu poder\u00e1 extrair diretamente alguns relat\u00f3rios, sem necessitar usar a rotina Gest\u00e3o a Vista. S\u00e3o eles: XML\u00b4s n\u00e3o Importados e Manifesta\u00e7\u00e3o de Destinat\u00e1rio.</li> </ul> <p> Figura 50: Relat\u00f3rios</p> <ul> <li>Buscar XML e-mail: (Necess\u00e1rio configura\u00e7\u00e3o pr\u00e9via) O sistema pode ser configurado para ter mais de uma op\u00e7\u00e3o de baixa de XML, al\u00e9m da autom\u00e1tica. Para tal, \u00e9 necess\u00e1rio solicitar seu TI que configure (em caso de d\u00favidas solicitar apoio a equipe FACILE) um email para receber XML. Ao clicar no Bot\u00e3o Buscar XML e-mail ser\u00e1 feito uma busca e importa\u00e7\u00e3o dos XML da conta de email configurada para dentro da Central XML-e.</li> </ul> <p> Figura 51: Buscar XML por e-mail</p> <ul> <li>Exportar XML: essa op\u00e7\u00e3o permite exportar o XML, mas apenas dos que j\u00e1 est\u00e3o baixados. A Figura 52 mostra a tela de exporta\u00e7\u00e3o.</li> </ul> <p> Figura 52: Tela de Exporta\u00e7\u00e3o XML</p> <ul> <li>Importar XML Computador: Assim como a fun\u00e7\u00e3o buscar XML e-mail, outra forma de importar um arquivo XML para a Central XML-e sem ser automaticamente \u00e9 a Busca direta de um diret\u00f3rio do computador. Ao clicar em \u201cImportar XML Computador\u201d ser\u00e1 apresentado uma tela de Browser, figura 54.</li> </ul> <p> Figura 53: Menu Importa\u00e7\u00e3o de XML manual</p> <p> Figura 54: Importa\u00e7\u00e3o de XML manual</p> <ul> <li>Entrada em Lote: Fun\u00e7\u00e3o criada para possibilitar a entrada em Lote de uma ou v\u00e1rias pr\u00e9-notas, deve-se filtrar os par\u00e2metro da figura 55, ent\u00e3o ser\u00e3o apresentadas os XML dispon\u00edveis para a entrada de Pr\u00e9-Nota em Lote (Figura 56).</li> </ul> <p> Figura 55: Par\u00e2metros para a entrada de Pr\u00e9-notas em lote.</p> <p>Ap\u00f3s preencher os par\u00e2metros, clique em OK e ir\u00e1 apresentar as notas dispon\u00edveis para sele\u00e7\u00e3o.</p> <p> Figura 56: Tela de Pr\u00e9-notas em lote.</p> <p>Ap\u00f3s selecionar as notas desejadas, clicar em Gerar Pr\u00e9-Nota ou Gerar Doc. Entrada (caso queira j\u00e1 ir para a classifica\u00e7\u00e3o em lote).</p> <ul> <li>Legenda: cada registro possui uma legenda(cor) que identifica o seu status. As legendas poss\u00edveis est\u00e3o descritas na Figura 57.</li> </ul> <p> Figura 57: Significado das legendas</p> <ul> <li>Imprimir Browse: essa op\u00e7\u00e3o permite imprimir ou exportar para diversos formatos, toda listagem que aparece na tela Central XML-e. A Figura 58 mostra a tela de impress\u00e3o/exporta\u00e7\u00e3o.</li> </ul> <p> Figura 58: Tela de Impress\u00e3o/Exporta\u00e7\u00e3o</p>"},{"location":"xmle/manuais/manual-usuario/#gestao-a-vista","title":"Gest\u00e3o \u00e0 vista","text":"<p>Ao selecionar Gest\u00e3o \u00e0 vista no menu inicial, o sistema mostrar\u00e1 uma tela de filtro (Figura 59) para selecionar de que data at\u00e9 que data o usu\u00e1rio deseja que sejam realizadas as an\u00e1lises dos documentos.</p> <p> Figura 59: Tela de filtro Gest\u00e3o \u00e0 vista</p> <p>Ap\u00f3s isso, o sistema mostra a tela principal Gest\u00e3o \u00e0 vista (Figura 60). Nela, \u00e9 poss\u00edvel obter as seguintes informa\u00e7\u00f5es sobre: </p> <p>\u2022 Controle de Entradas: o sistema mostra a quantidade de XML dispon\u00edveis e a quantidade sem NF de entrada, al\u00e9m de um gr\u00e1fico para acompanhamento visual.</p> <p>\u2022 Compras Mensais: por meio de um gr\u00e1fico de barras, \u00e9 poss\u00edvel acompanhar de forma sint\u00e9tica os gastos mensais com compras.</p> <p>\u2022 NF-e Cancelados: o sistema mostra a quantidade de XML cancelados e a quantidade que foi lan\u00e7ada no ERP, al\u00e9m de um gr\u00e1fico para acompanhamento visual.</p> <p>\u2022 Gest\u00e3o de Fornecedores: o sistema mostra a quantidade de fornecedores que tem XML emitido contra sua empresa e ainda n\u00e3o est\u00e3o cadastrados no sistema.</p> <p>\u2022 NF-e Faltando XML: o sistema mostra quantidade de Documentos de Entrada que foram inclu\u00eddos no sistema sem anexar o seu XML.</p> <p>\u2022 Central XML-e: Licen\u00e7a do cliente.</p> <p> Figura 60: Tela de Gest\u00e3o \u00e0 vista</p> <p>Caso necessite realizar outro filtro, basta clicar no bot\u00e3o Config  ou pressionar a tecla F12 que a tela de filtro aparecer\u00e1 novamente.</p> <p>Desse modo, \u00e9 poss\u00edvel realizar o gerenciamento dos documentos em um s\u00f3 local.</p>"},{"location":"xmle/manuais/manual-usuario/#check-doc","title":"Check Doc","text":"<p>\u00c9 poss\u00edvel utilizar a ferramenta tanto de forma autom\u00e1tica (necess\u00e1rio parametriza\u00e7\u00e3o pr\u00e9via) ou manual. Aqui iremos demonstrar a forma manual.</p> <p>Na Central XML-e, v\u00e1 em \u201cOutras A\u00e7\u00f5es/CheckDoc\u201d.</p> <p> Figura 61: Menu CheckDoc</p> <p> Figura 62: CheckDoc Manual</p> <p>Clicar em Realizar nova an\u00e1lise.</p> <p> Figura 63: Confirma\u00e7\u00e3o CheckDoc</p> <p>Escolha, Sim. Selecione uma pasta para salvar o relat\u00f3rio.</p> <p> Figura 64: Diret\u00f3rio onde ser\u00e1 saldo o arquivo de an\u00e1lise do CheckDoc</p> <p>Ir\u00e1 apresentar o relat\u00f3rio comparando na linha de cima o que est\u00e1 no XML e na de baixo no ERP Protheus.</p> <p> Figura 65: Relat\u00f3rio CheckDoc</p> -FIM-"},{"location":"xmle/manuais/pc-completo/","title":"06 - Funcionalidades para o Pedido de Compra","text":""},{"location":"xmle/manuais/pc-completo/#funcionalidades-para-o-pedido-de-compra","title":"Funcionalidades para o Pedido de Compra","text":""},{"location":"xmle/manuais/pc-completo/#conteudo","title":"Conte\u00fado","text":"<p>Este passo a passo cont\u00e9m as seguintes etapas:</p> <ol> <li> <p>Ajustar o Pedido de compras para marcar todos os itens do pedido ao inv\u00e9s de apenas um.</p> </li> <li> <p>Deixar entrar com um s\u00f3 item no pedido de compra.</p> </li> <li> <p>Receber um item apenas no xml que entra no pedido de compra quebrado em mais itens.</p> </li> </ol> <p>Para acessar a nova funcionalidade, acesse a Central xml-e devidamente configurada em seu menu no Protheus e selecione o registro que deseja realizar a rotina.</p> <p>Com o registro j\u00e1 selecionado clique em: Gerar Entrada &gt; Outras A\u00e7\u00f5es &gt; Buscar Pedido Compra. Como na imagem abaixo:</p> <p> Figura 01: Buscar Pedido de Compra"},{"location":"xmle/manuais/pc-completo/#marcar-todos-os-itens-de-um-pedido","title":"Marcar todos os itens de um Pedido","text":"<p>Ajustar o Pedido de compras para marcar todos os itens do pedido ao inv\u00e9s de apenas um.</p> <p>Ap\u00f3s fazer o passo anterior voc\u00ea ver\u00e1 uma nova tela com os pedidos de compra feitos para o fornecedor selecionado. Com isso voc\u00ea poder\u00e1 selecionar/vincular os itens de forma mais conveniente e intuitiva veja:</p> <p> Figura 02: PC para o Fornecedor selecionado"},{"location":"xmle/manuais/pc-completo/#selecionandovinculando-os-itens","title":"Selecionando/vinculando os itens","text":"<p>Siga a sequ\u00eancia:</p> <p> Figura 03: Sele\u00e7\u00e3o de itens <p>1.1. Selecione um \u00fanico pedido de compra no campo Filtrar Pedidos de Compras.</p> <p>1.2. Clique no bot\u00e3o Gerar Pedido de Compra.</p> <p>1.3. Na caixa que abrir voc\u00ea selecionar\u00e1 os Itens do XML e assim os mesmos aparecer\u00e3o no pr\u00f3ximo passo. Caso a caixa n\u00e3o apare\u00e7a, significa que os itens j\u00e1 foram vinculados (Produto x Fornecedor).</p> <p>1.4. Os itens selecionados na simula\u00e7\u00e3o da pr\u00e9-nota mudar\u00e3o a cor do status para verde.  Para desfazer, clique no bot\u00e3o Limpar Altera\u00e7\u00f5es Realizadas ou clicar no bot\u00e3o confirmar para finalizar a a\u00e7\u00e3o. </p>"},{"location":"xmle/manuais/pc-completo/#entrada-com-item-unico","title":"Entrada com item \u00fanico","text":"<p>Deixar entrar com um s\u00f3 item no pedido de compra.</p> <p>Com o registro j\u00e1 selecionado clique em: Gerar Entrada &gt; Outras A\u00e7\u00f5es &gt; Buscar Pedido Compra. Como na imagem abaixo:</p> <p> Figura 4: Buscar Pedido de Compra <p>2.1. Escolha um item do pedido e clique com o bot\u00e3o direito do mouse na linha do item escolhido.  Uma caixa abrir\u00e1 com a op\u00e7\u00e3o de  Replicar em todos os itens do XML.  Clique na mesma.</p> <p> Figura 05: Replicar em todos os itens do XML <p>2.2. Um aviso de confirma\u00e7\u00e3o ir\u00e1 ser exibido.</p> <p> Figura 06: Confirma\u00e7\u00e3o de aplica\u00e7\u00e3o <p>Clicando em SIM, os itens na se\u00e7\u00e3o Simula\u00e7\u00e3o da Pr\u00e9-Nota. Ficar\u00e3o com o status verde.</p> <p>Depois basta clicar no bot\u00e3o confirmar para finalizar a a\u00e7\u00e3o ou no bot\u00e3o Limpar Altera\u00e7\u00f5es Realizadas para cancelar.</p>"},{"location":"xmle/manuais/pc-completo/#item-unico-do-xml-quebrado-em-mais-itens","title":"Item \u00fanico do XML quebrado em mais itens","text":"<p>Receber um item apenas no xml que entra no pedido de compra quebrado em mais itens.</p> <p>Com o registro j\u00e1 selecionado clique em: Gerar Entrada &gt; Outras A\u00e7\u00f5es &gt; Buscar Pedido Compra. Como na imagem abaixo:</p> <p> Figura 07: Buscar Pedido de Compra <p>3.1. Selecione um \u00fanico pedido de compra no campo Filtrar Pedidos de Compras.</p> <p>3.2. Depois clique em gerar pedido completo.</p> <p> Figura 08: Gerar Pedido Completo <p>Alguns pedidos de compra que possuem muitos itens e quando o fornecedor envia a nota fiscal vem apenas um \u00fanico item contemplando todos os itens do pedido de compra. Ap\u00f3s esse processo os itens do pedido estar\u00e3o na sess\u00e3o da pr\u00e9-nota, mesmo se o XML tiver apenas um \u00fanico item.</p> -FIM-"},{"location":"xmle/manuais/peferramenta/","title":"\ud83d\udd35Pontos de Entrada da Central XML","text":"<p>Assim como o Protheus, o Facile XML-e tem seus pr\u00f3prios Pontos de Entrada que disponibilizamos para personaliza\u00e7\u00f5es. Segue abaixo cada um e seus exemplos de utiliza\u00e7\u00e3o.</p>"},{"location":"xmle/manuais/peferramenta/#chkdocok","title":"CHKDOCOK","text":"<p>Ponto de entrada para validar se o XML ser\u00e1 analisado pelo CheckDoc.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Object, Objeto com o XML a ser analisado pelo checkdoc</li> </ul> <p>Retorno:</p> <ul> <li>lRet: Logical, permite processar o XML.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function CHKDOCOK()\n\n    Local lRet    := .T.\n    Local oXml      := ParamIxb[1]\n\n    If XmlChildEx(oXML:_NFE:_INFNFE:_IDE,\"_FINNFE\") &lt;&gt; NIL\n    If oXML:_NFE:_INFNFE:_IDE:_FINNFE:TEXT == \"2\" //|NF-e complementar |\n      lRet  := .F.\n    EndIf\n  EndIf\n\nReturn lRet\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#mt100tok","title":"MT100TOK","text":"<p>Uso necess\u00e1rio para o correto funcionamento da ferramenta</p> <p>Utilizamos esse ponto de entrada para realizar a valida\u00e7\u00e3o dos impostos no momento da classifica\u00e7\u00e3o do documento de entrada.</p> <p>Sugerimos incluir o c\u00f3digo abaixo no final do fonte, logo antes do RETURN (caso tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>If lValido .And. AllTrim( FunName() ) $ \"MATA103/PTX0007/PTX0018/PTX0008/PTX0001\"\n    lValido := U_PTX0010()\nEndIf\n</code></pre> <p>Segue exemplo do ponto de entrada completo que poder\u00e1 ser utilizado (caso **N\u00c3O ** tenha o P.E. j\u00e1 aplicado ERP).</p> <pre><code>User Function MT100TOK()\n\n    Local aArea   := GetArea()\n    local lValido := ParamIxb[1]\n\n    If lValido .And. AllTrim( FunName() ) $ \"MATA103/PTX0007/PTX0018/PTX0008/PTX0001\"\n\n        lValido := U_PTX0010()\n\n    EndIf\n\n    RestArea(aArea)\n\nReturn lValido\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#mt103pn","title":"MT103PN","text":"<p>Uso necess\u00e1rio para o correto funcionamento da ferramenta</p> <p>Utilizamos esse ponto de entrada para realizar a checagem da TES e do pedido de compra nos itens do documento de entrada.</p> <p>Sugerimos incluir o c\u00f3digo abaixo no final do fonte, logo antes do RETURN (caso tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>If FwIsInCallStack(\"U_PTX0001\")\n    FWMsgRun(, {|| U_PTX0015(.T.) }, \"Processando!\", \"Calculando impostos, aguarde...\")         \nEndIf\n</code></pre> <p>Segue exemplo do ponto de entrada completo que poder\u00e1 ser utilizado (caso **N\u00c3O ** tenha o P.E. j\u00e1 aplicado no ERP).</p> <pre><code>User Function MT103PN()\n\n    If FwIsInCallStack(\"U_PTX0001\")\n        FWMsgRun(, {|| U_PTX0015(.T.) }, \"Processando!\", \"Calculando impostos, aguarde...\")         \n    EndIf\n\nReturn\u00a0.T.\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#mt140pc","title":"MT140PC","text":"<p>Esse ponto de entrada dever\u00e1 ser utilizado exclusivamente na situa\u00e7\u00e3o em que a empresa utilize o par\u00e2metro **MV_PCNFE ** ativo.</p> <p>Utilizamos o ponto de entrada para informar ao sistema que naquele momento da inclus\u00e3o da Pr\u00e9-Nota pela ferramenta n\u00e3o ser\u00e1 necess\u00e1rio realizar a valida\u00e7\u00e3o do pedido de compra.</p> <p>Obs.: A utiliza\u00e7\u00e3o desse ponto de entrada n\u00e3o atrapalha no processo padr\u00e3o adotado pelo MV_PCNFE.</p> <p>Segue exemplo do ponto de entrada que poder\u00e1 ser utilizado:</p> <pre><code>User Function MT140PC()\n\n    //|Apenas na rotina Facile XML-e |\n    If !FwIsInCallStack(\"U_PTX0001\")\n        Return Nil\n    EndIf\n\nReturn .F.\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p007cte","title":"P007CTE","text":"<p>Ponto de entrada para analisar se o CTE deve entrar via rotina de CTE MATA116 ou via documento de entrada MATA103.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Object, Objeto XML do CTE</li> </ul> <p>Retorno:</p> <ul> <li>lRet: Logical, True para MATA116 e false para MATA103.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P007CTE()\n\n  Local oObj           := ParamIxb[1]\n  Local aArea          := GetArea()\n  Local lCteCompra     := .F.\n  Local cCnpjDest      := \"\"\n  Local cTipoDocumento := \"\"\n\n  If !IsBlind()\n\n    lCteCompra := ( fTipoCTE(oObj) == \"CTEC\" )\n\n  Else\n\n    If XmlChildEx(oObj:_CTEPROC:_CTE:_INFCTE:_DEST, \"_CNPJ\") != Nil\n      cCnpjDest    := oObj:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ:TEXT\n    EndIf\n\n    If Empty(cCnpjDest) .And. XmlChildEx(oObj:_CTEPROC:_CTE:_INFCTE:_DEST, \"_CPF\") != Nil\n      cCnpjDest    := oObj:_CTEPROC:_CTE:_INFCTE:_DEST:_CPF:TEXT\n    EndIf\n\n    If cCnpjDest == AllTrim(SM0-&gt;M0_CGC)\n      cTipoDocumento := \"CTEC\"\n    Else\n      cTipoDocumento := \"CTEV\"\n    EndIf\n\n    lCteCompra  := (cTipoDocumento == \"CTEC\")\n\n  EndIf\n\n  RestArea(aArea)\n\nReturn lCteCompra\n\n\n\nStatic Function fTipoCTE(oObj)\n\n    Local cEstilo1   := \"\"\n    Local cEstBtn1   := \"\"\n    Local cEstSay2   := \"\"\n    Local cTipoCTE   := \"\"\n    Local cNatureza  := \"\"\n    Local cCfops     := \"\"\n    Local nAux       := 0\n    Local aCombo1    := {}\n    Local aAuxCombo1 := {}\n    Local aDados     := {}\n    Local cRetPE     := \"CTEV\"\n  Local oSay3      := Nil\n  Local oSay4      := Nil\n  Local oSay5      := Nil\n\n    Private oBox1\n    Private oBox2\n    Private oSay1\n    Private oSay2\n\n    aCombo1    := {\"Frete Despesa (Cte Venda)\",\"Frete Custo Produto (Cte Compra)\"}\n    aAuxCombo1 := {\"CTEV\",\"CTEC\"}\n    nAux       := aScan(aAuxCombo1,cRetPE)\n\n    If !Empty(cRetPE) .And. nAux != 0\n        cTipoCTE := aCombo1[nAux]\n    EndIf\n\n  aDados := fDadosDocumento(oObj)\n\n  cNatureza := SubStr( aDados[1], 1, 52 ) + IIf( Len( aDados[1] ) &gt; 60, \"...\", \"\" )\n  cCfops    := SubStr( aDados[2], 1, 52 ) + IIf( Len( aDados[2] ) &gt; 60, \"...\", \"\" )\n\n    oFont1    := TFont():New( \"Courier New\",0,-16,,.T.,0,,700,.F.,.F.,,,,,, )\n\n    oDlg1     := MSDialog():New( 091,243,380,650,\"XML-e - Tipo Documento de Transporte\",,,.F.,,,,,,.T.,,,.T. )\n\n    oPanel1   := TPanel():New( 000,000,\"\",oDlg1,,.F.,.F.,,,280,085,.T.,.F. )\n    oPanel1:align:= CONTROL_ALIGN_ALLCLIENT\n  cEstilo1 := \" QLabel {\"\n  cEstilo1 += \" background-color: #3D86AB;\"\n  cEstilo1 += \"}\"\n  oPanel1:SetCss(cEstilo1)\n\n  oSay3      := TSay():New( 005,005,{||\"Nat. Opera\u00e7\u00e3o: \" + cNatureza },oPanel1,,,.F.,.F.,.F.,.T.,CLR_WHITE,CLR_WHITE,300,012)\n  oSay3:SetCss( \" QLabel { color: #FFFFFF; }\")\n\n  oSay4      := TSay():New( 015,005,{||\"Cfop: \" + cCfops },oPanel1,,,.F.,.F.,.F.,.T.,CLR_WHITE,CLR_WHITE,300,012)\n  oSay4:SetCss( \" QLabel { color: #FFFFFF; }\")\n\n  oSay5      := TSay():New( 022,000,{||Replicate(\"-\",120) },oPanel1,,,.F.,.F.,.F.,.T.,CLR_WHITE,CLR_WHITE,300,012)\n\n    oSay1      := TSay():New( 030,016,{||\"Tipo de CT-e\"},oPanel1,,oFont1,.F.,.F.,.F.,.T.,CLR_WHITE,CLR_WHITE,072,012)\n  cEstSay2  := \"    QLabel { \"\n  cEstSay2  += \"    font-family: cursive; \"\n  cEstSay2  += \"    font-weight: bold; \"\n  cEstSay2  += \"    font-size: large; \"\n  cEstSay2  += \"    line-height: 100%; \"\n  cEstSay2  += \"    word-spacing: 1ex; \"\n  cEstSay2  += \"    letter-spacing: normal; \"\n  cEstSay2  += \"    text-decoration: none; \"\n  cEstSay2  += \"    text-transform: none; \"\n  cEstSay2  += \"    text-align: left; \"\n  cEstSay2  += \"    color: #FFFFFF; \"\n  cEstSay2  += \"    text-indent: 0ex; \"\n  cEstSay2  += \"    } \"\n  oSay1:SetCss(cEstSay2)\n\n    @ 048,016 MSCOMBOBOX oBox1 VAR cTipoCTE ITEMS aCombo1 SIZE 150,100 OF oDlg1 PIXEL\n\n    oBtn1      := TButton():New( 108,068,\"Confirmar\",oPanel1,{|| TipoCombo(@cRetPE,aCombo1,cTipoCTE,aAuxCombo1,\"1\") },056,012,,,,.T.,,\"\",,,,.F. )\n    cEstBtn1 := \"QPushButton {\"\n  cEstBtn1 += \" background-image: url(rpo:PTX_Refresh.png);\"\n  cEstBtn1 += \" background-repeat: none; \"\n  cEstBtn1 += \" background-attachment: fixed; \"\n  cEstBtn1 += \" background-position: left center; \"\n  cEstBtn1 += \" border-style: outset;\"\n  cEstBtn1 += \" border-width: 2px;\"\n  cEstBtn1 += \" border: 1px solid #C0C0C0;\"\n  cEstBtn1 += \" border-radius: 5px;\"\n  cEstBtn1 += \" border-color: #C0C0C0;\"\n  cEstBtn1 += \" font: bold 12px Arial;\"\n  cEstBtn1  += \"    color: #ffffff; \"\n  cEstBtn1 += \" padding: 6px;\"\n  cEstBtn1 += \"} \"\n\n  cEstBtn1 += \"QPushButton:hover { \"\n  cEstBtn1 += \" background-color: #cecef6;\"\n  cEstBtn1 += \" border-style: inset;\"\n  cEstBtn1 += \" opacity: 0.2; \"\n  cEstBtn1 += \"} \"\n\n  cEstBtn1 += \"QPushButton:pressed {\"\n  cEstBtn1 += \" background-color: #e6e6f9;\"\n  cEstBtn1 += \" border-style: inset;\"\n  cEstBtn1 += \"} \"\n  oBtn1:SetCss(cEstBtn1)\n\n    oDlg1:Activate(,,,.T.)\n\nReturn cRetPE\n\n\nStatic Function TipoCombo(cVariavel,aCombo,cCombo,aReferencia,cIdent)\n\n    Local nPos  := aScan(aCombo,cCombo)\n    Local lRet  := (nPos &gt; 0)\n\n    If nPos &gt; 0\n        cVariavel := aReferencia[nPos]\n    EndIf\n\n    oDlg1:End()\n\nReturn (lRet)\n\n\nStatic Function fDadosDocumento(oObj)\n\n  Local cCfops    := \"\"\n  Local cNatureza := \"\"\n\n  If oObj != Nil\n\n    //|Pega a natureza da opera\u00e7\u00e3o |\n    cNatureza := U_PTX_GetTagValue( oObj, \"oObj:_CTEPROC:_CTE:_INFCTE:_IDE:_NATOP\" )\n    cCfops    := U_PTX_GetTagValue( oObj, \"oObj:_CTEPROC:_CTE:_INFCTE:_IDE:_CFOP\" )\n\n  EndIf\n\nReturn { cNatureza, cCfops }\n\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p07geraent","title":"P07GERAENT","text":"<p>Ponto de entrada chamado ao clicar no bot\u00e3o \"Gerar Entrada\" para tratamentos diversos est\u00e1 posicionado no XML selecionado (tabela ZZZ).</p> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P07GERAENT()\n\n  If ZZZ-&gt;ZZZ_TIPO == \"1\" //|NFE |\n\n    If MsgYesNo(\"Deseja alterar a data do recebimento (D1_DTDIGIT) ?\", \"P07GERAENT\")\n\n      dDataBase := CtoD( FWInputBox(\"Digite a data do recebimento (dd/mm/aaaa)\") )\n\n    EndIf\n\n  EndIf\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p09altpn","title":"P09ALTPN","text":"<p>Ponto de entrada ap\u00f3s o execauto do MATA140 e quando n\u00e3o estiver para abrir pra classifica\u00e7\u00e3o.</p> <p>Retorno:</p> <ul> <li>lClassifica: Logical, True abre a tela de classifica\u00e7\u00e3o.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P09ALTPN()\n\n  Local lClassifica := .F.\n  Local cSitua      := U_VerifNF()\n\n  //|Altera a Legenda |\n  RecLock(\"ZZZ\",.F.)\n  ZZZ-&gt;ZZZ_OK       := cSitua\n  ZZZ-&gt;(MsUnLock())\n\n  //lClassifica =&gt; se for = .T. ele abre tela de classifica\u00e7\u00e3o\n\n  If !lClassifica\n\n    //|Abre a pr\u00e9-nota em modo de altera\u00e7\u00e3o |\n    U_PTX0057( 'PRE' , 'ALTERA' )\n\n  Else\n\n    lClassifica := .T.\n\n  EndIf\n\n\nReturn lClassifica\n\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p011item","title":"P011ITEM","text":"<p>Ponto de entrada para manipular o array de itens do CTE de Vendas antes do execauto.</p> <p>Retorno:</p> <ul> <li>_aItensCols: array, array de itens para o execauto.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P011ITEM()\n\n    Local _aItensCols   := ParamIxb[1] as Array\n    // Local _aCabececalho := ParamIxb[2] as Array\n    Local _oXml         := ParamIxb[3] as Object\n    Local _nCont       := 0           as Integer\n    Local _nI              := 0           as Integer\n    Local _oCTE        := _oXml       as Object\n    Local _oIcms       := Nil         as Object\n    Local _oIpi        := Nil         as Object\n    Local _oPis        := Nil         as Object\n    Local _oCofins     := Nil         as Object\n    Local _oST         := Nil         as Object\n\n    Local c_FSBICM     := \"\"          as Character // BASE ICMS\n  Local c_FSVICM     := \"\"          as Character // VALOR ICMS\n  Local c_FSBIPI     := \"\"          as Character // BASE IPI\n  Local c_FSVIPI     := \"\"          as Character // VALOR IPI\n  Local c_FSBPIS     := \"\"          as Character // BASE PIS\n  Local c_FSVPIS     := \"\"          as Character // VALOR POS\n  Local c_FSBCOF     := \"\"          as Character // BASE COFINS\n  Local c_FSVCOF     := \"\"          as Character // VALOR COFINS\n  Local c_FSBIST     := \"\"          as Character // BASE ICMS ST\n  Local c_FSVIST     := \"\"          as Character // VALOR ICMS ST\n  Local c_FSCSTIC    := \"\"          as Character //- F4_SITTRIB &lt;&gt; CSTICMS - CST CLASSIFICA\u00c7\u00c3O FISCAL  \n  Local c_FSCSTIP    := \"\"          as Character //- F4_CTIPI  &lt;&gt;  CST CLASSIFICA\u00c7\u00c3O\u00a0FISCAL\u00a0IPI\n\n    Local cExcept      := \"\"          as Character\n  Local bError                      as CodeBlock\n\n    bError    := ErrorBlock({|e| cExcept := \"&lt;h3&gt;\"+e:Description+\"&lt;/h3&gt;\"+e:ERRORSTACK})\n\n    BEGIN SEQUENCE\n\n        _nCont  := Len( _aItensCols )\n\n        For _nI := 1 To _nCont\n\n            If XmlChildEx(_oCTE:_CTEPROC:_CTE, \"_INFCTE\") != Nil\n                _oCTE := _oCTE:_CTEPROC:_CTE:_INFCTE\n            EndIf\n\n            If XmlChildEx(_oCTE, \"_IMP\") != Nil\n\n                //|ICMS |\n                If XmlChildEx(_oCTE:_Imp, \"_ICMS\") != Nil\n\n                    _oIcms      := fBuscaIcms( _oCTE )\n                    c_FSBICM  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_VBC\" )             // BASE ICMS \n                    c_FSVICM  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_VICMS\" )           // VALOR ICMS\n                    c_FSORIG  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_ORIG\" )            // B1_ORIGEM -- CST CLASSIFICA\u00c7\u00c3O FISCAL ICMS\n                    c_FSCSTIC := U_PTX_GetTagValue( _oIcms, \"_oIcms:_CST\" )             //- F4_SITTRIB &lt;&gt; CSTICMS - CST CLASSIFICA\u00c7\u00c3O FISCAL  \n\n                EndIf\n\n                //|IPI |\n                If XmlChildEx(_oCTE:_Imp, \"_IPI\") != Nil\n\n                    _oIpi           := fBuscaIpi( _oCTE )\n                    c_FSBIPI  := U_PTX_GetTagValue( _oIpi, \"_oIpi:_VBC\" )               // BASE IPI\n                    c_FSVIPI  := U_PTX_GetTagValue( _oIpi, \"_oIpi:_VIPI\" )              // VALOR IPI\n                    c_FSCSTIP := U_PTX_GetTagValue( _oIpi, \"_oIpi:_CST\" )             //- F4_CTIPI  &lt;&gt;  CST CLASSIFICA\u00c7\u00c3O\u00a0FISCAL\u00a0IPI\n\n                EndIf\n\n                //|PIS |\n                If XmlChildEx(_oCTE:_Imp, \"_PIS\") != Nil\n\n                    _oPis           := fBuscaPis( _oCTE )\n                    c_FSBPIS  := U_PTX_GetTagValue( _oPis, \"_oPis:_VBC\" )               // BASE PIS\n                    c_FSVPIS  := U_PTX_GetTagValue( _oPis, \"_oPis:_VPIS\" )              // VALOR PIS\n\n                EndIf\n\n                //|COFINS |\n                If XmlChildEx(_oCTE:_Imp, \"_COFINS\") != Nil\n\n                    _oCofins    := fBuscaCofins( _oCTE )\n                    c_FSBCOF  := U_PTX_GetTagValue( _oCofins, \"_oCofins:_VBC\" )             // BASE COFINS\n                    c_FSVCOF  := U_PTX_GetTagValue( _oCofins, \"_oCofins:_VCOFINS\" )     // VALOR COFINS\n\n                EndIf\n\n                //|ICMS ST |\n                If XmlChildEx(_oCTE:_Imp, \"_ICMS\") != Nil\n\n                    _oST            := fBuscaIcms( _oCTE )\n                    c_FSBIST  := U_PTX_GetTagValue( _oST, \"_oST:_VBCST\" )                       // BASE ICMS ST\n                    c_FSVIST  := U_PTX_GetTagValue( _oST, \"_oST:_VICMSST\" )                     // VALOR ICMS ST\n\n                EndIf\n\n            EndIf\n\n            //|Adiciona ao aCols |\n            aadd(_aItensCols[_nI], {\"D1_FSBICM \", Val(c_FSBICM), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSVICM \", Val(c_FSVICM), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSBIPI \", Val(c_FSBIPI), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSVIPI \", Val(c_FSVIPI), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSBPIS \", Val(c_FSBPIS), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSVPIS \", Val(c_FSVPIS), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSBCOF \", Val(c_FSBCOF), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSVCOF \", Val(c_FSVCOF), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSBIST \", Val(c_FSBIST), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSVIST \", Val(c_FSVIST), Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSCSTIC\", c_FSCSTIC    , Nil, Nil})\n            aadd(_aItensCols[_nI], {\"D1_FSCSTIP\", c_FSCSTIP    , Nil, Nil})\n\n        Next _nI\n\n    END SEQUENCE\n\n    ErrorBlock(bError)\n\n    If !Empty(cExcept)\n        ConOut(cExcept)\n    EndIf\n\nReturn _aItensCols\n\n\n\nStatic Function fBuscaIcms( _oCTE )\n\n    Local _oIcms as Object\n\n    Do Case\n\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS00\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS00\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS10\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS10\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS20\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS20\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS30\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS30\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS40\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS40\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS41\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS41\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS45\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS45\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS50\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS50\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS51\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS51\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS60\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS60\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS70\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS70\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMS90\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMS90\n        Case XmlChildEx(_oCTE:_Imp:_ICMS, \"_ICMSST\") != Nil\n            _oIcms := _oCTE:_Imp:_ICMS:_ICMSST\n\n    EndCase\n\nReturn _oIcms\n\n\n\n\nStatic Function fBuscaIpi( __oCTE )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oCTE:_Imp:_IPI, \"_IPITRIB\") != Nil\n            _oImp := _oCTE:_Imp:_IPI:_IPITRIB\n        Case XmlChildEx(_oCTE:_Imp:_IPI, \"_IPINT\") != Nil\n            _oImp := _oCTE:_Imp:_IPI:_IPINT\n\n    EndCase\n\nReturn _oImp\n\n\n\nStatic Function fBuscaPis( __oCTE )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oCTE:_Imp:_PIS, \"_PISALIQ\") != Nil\n            _oImp := _oCTE:_Imp:_PIS:_PISALIQ\n\n    EndCase\n\nReturn _oImp\n\n\n\nStatic Function fBuscaCofins( __oCTE )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oCTE:_Imp:_COFINS, \"_COFINSALIQ\") != Nil\n            _oImp := _oCTE:_Imp:_COFINS:_COFINSALIQ\n\n    EndCase\n\nReturn _oImp\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018cols","title":"P018COLS","text":"<p>Ponto de entrada para manipular o array de itens do documento de entrada antes do execauto.</p> <p>Retorno:</p> <ul> <li>_aItensCols: array, array de itens para o execauto</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018COLS()\n\n    Local _aItensCols  := ParamIxb[1] as Array\n    // Local _aCabecalho    := ParamIxb[2] as Array\n    Local _oXml        := ParamIxb[3] as Object\n  Local aProcessados := {}          as Array\n    // Local _cProduto     := \"\"          as Character\n    // Local _cDocumento   := \"\"          as Character\n    Local _cItemXml    := \"\"          as Character\n    Local _nZ          := 0           as Integer\n    Local _nI          := 0           as Integer\n    Local _nPos        := 0           as Integer\n    Local _nPosIemXml  := 0           as Integer\n    Local _nCont       := 0           as Integer\n    Local _oItem       := Nil         as Object\n    Local oDetXml      := Nil         as Variant\n    Local _oIcms       := Nil         as Object\n    Local _oIpi        := Nil         as Object\n    Local _oPis        := Nil         as Object\n    Local _oCofins     := Nil         as Object\n    Local _oST         := Nil         as Object\n\n    Local c_FSBICM     := \"\"          as Character // BASE ICMS\n  Local c_FSVICM     := \"\"          as Character // VALOR ICMS\n  Local c_FSBIPI     := \"\"          as Character // BASE IPI\n  Local c_FSVIPI     := \"\"          as Character // VALOR IPI\n  Local c_FSBPIS     := \"\"          as Character // BASE PIS\n  Local c_FSVPIS     := \"\"          as Character // VALOR POS\n  Local c_FSBCOF     := \"\"          as Character // BASE COFINS\n  Local c_FSVCOF     := \"\"          as Character // VALOR COFINS\n  Local c_FSBIST     := \"\"          as Character // BASE ICMS ST\n  Local c_FSVIST     := \"\"          as Character // VALOR ICMS ST\n  Local c_FSCEST     := \"\"          as Character // B1_CEST &lt;&gt; cest -- C\u00d3DIGO CEST\n  Local c_FSORIG     := \"\"          as Character // B1_ORIGEM &lt;&gt; -- CST CLASSIFICA\u00c7\u00c3O FISCAL ICMS\n  Local c_FSCSTIC    := \"\"          as Character //- F4_SITTRIB &lt;&gt; CSTICMS - CST CLASSIFICA\u00c7\u00c3O FISCAL  \n  Local c_FSCSTIP    := \"\"          as Character //- F4_CTIPI  &lt;&gt;  CST CLASSIFICA\u00c7\u00c3O\u00a0FISCAL\u00a0IPI\n\n    Local cExcept      := \"\"          as Character\n  Local bError                      as CodeBlock\n\n  bError    := ErrorBlock({|e| cExcept := \"&lt;h3&gt;\"+e:Description+\"&lt;/h3&gt;\"+e:ERRORSTACK})\n\n    BEGIN SEQUENCE\n\n        If ZZZ-&gt;ZZZ_TIPO == \"1\"\n\n            //|Pega campos necess\u00e1rios |\n            // If ( _nPos := aScan(_aCabecalho, { |x| Alltrim(x[1]) == \"F1_DOC\" }) ) &gt; 0\n            //  _cDocumento := _aCabecalho[ _nPos, 2 ]\n            // EndIf\n\n            // If ( _nPos := aScan(_aItensCols[1], { |x| Alltrim(x[1]) == \"D1_COD\" }) ) &gt; 0\n            //  _cProduto   := _aItensCols[ 1, _nPos, 2 ]\n            // EndIf\n\n            oDetXml     := _oXml:_InfNfe:_Det\n            oDetXml     := IIf( ValType(oDetXml) == \"O\", {oDetXml}, oDetXml )\n\n            _nCont  := Len( _aItensCols )\n\n            //|Percorre todos os itens do aCols SD1 |\n            For _nI := 1 To _nCont\n\n                _nPosIemXml := aScan( _aItensCols[_nI], { |x| Alltrim(x[1]) == \"D1_ZITEXML\" } )\n                _cItemXml       := _aItensCols[_nI, _nPosIemXml, 2]\n\n                //|Variavel de controle para processar itens fracionados apenas uma vez |\n                If ( _nPos := aScan( aProcessados, _cItemXml ) ) &gt; 0\n                    Loop\n                Else\n                    aAdd( aProcessados, _cItemXml )\n                EndIf\n\n                //|Encontra o respectivo item no XML |\n                For _nZ := 1 To Len( oDetXml )\n\n                    If cValToChar( oDetXml[_nZ]:_NITEM:TEXT ) == cValToChar( _cItemXml )\n                        _oItem  := oDetXml[_nZ]\n                        Exit\n                    EndIf\n\n                Next _nZ\n\n                If XmlChildEx(_oItem, \"_IMPOSTO\") != Nil\n\n                    //|ICMS |\n                    If XmlChildEx(_oItem:_Imposto, \"_ICMS\") != Nil\n\n                        _oIcms      := fBuscaIcms( _oItem )\n                        c_FSBICM  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_VBC\" )             // BASE ICMS \n                        c_FSVICM  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_VICMS\" )           // VALOR ICMS\n                        c_FSORIG  := U_PTX_GetTagValue( _oIcms, \"_oIcms:_ORIG\" )            // B1_ORIGEM -- CST CLASSIFICA\u00c7\u00c3O FISCAL ICMS\n                        c_FSCSTIC := U_PTX_GetTagValue( _oIcms, \"_oIcms:_CST\" )             //- F4_SITTRIB &lt;&gt; CSTICMS - CST CLASSIFICA\u00c7\u00c3O FISCAL  \n\n                    EndIf\n\n                    //|IPI |\n                    If XmlChildEx(_oItem:_Imposto, \"_IPI\") != Nil\n\n                        _oIpi           := fBuscaIpi( _oItem )\n                        c_FSBIPI  := U_PTX_GetTagValue( _oIpi, \"_oIpi:_VBC\" )               // BASE IPI\n                        c_FSVIPI  := U_PTX_GetTagValue( _oIpi, \"_oIpi:_VIPI\" )              // VALOR IPI\n                        c_FSCSTIP := U_PTX_GetTagValue( _oIpi, \"_oIpi:_CST\" )             //- F4_CTIPI  &lt;&gt;  CST CLASSIFICA\u00c7\u00c3O\u00a0FISCAL\u00a0IPI\n\n                    EndIf\n\n                    //|PIS |\n                    If XmlChildEx(_oItem:_Imposto, \"_PIS\") != Nil\n\n                        _oPis           := fBuscaPis( _oItem )\n                        c_FSBPIS  := U_PTX_GetTagValue( _oPis, \"_oPis:_VBC\" )               // BASE PIS\n                        c_FSVPIS  := U_PTX_GetTagValue( _oPis, \"_oPis:_VPIS\" )              // VALOR PIS\n\n                    EndIf\n\n                    //|COFINS |\n                    If XmlChildEx(_oItem:_Imposto, \"_COFINS\") != Nil\n\n                        _oCofins    := fBuscaCofins( _oItem )\n                        c_FSBCOF  := U_PTX_GetTagValue( _oCofins, \"_oCofins:_VBC\" )             // BASE COFINS\n                        c_FSVCOF  := U_PTX_GetTagValue( _oCofins, \"_oCofins:_VCOFINS\" )     // VALOR COFINS\n\n                    EndIf\n\n                    //|ICMS ST |\n                    If XmlChildEx(_oItem:_Imposto, \"_ICMS\") != Nil\n\n                        _oST            := fBuscaIcms( _oItem )\n                        c_FSBIST  := U_PTX_GetTagValue( _oST, \"_oST:_VBCST\" )                       // BASE ICMS ST\n                        c_FSVIST  := U_PTX_GetTagValue( _oST, \"_oST:_VICMSST\" )                     // VALOR ICMS ST\n\n                    EndIf\n\n                EndIf\n\n                c_FSCEST    := U_PTX_GetTagValue( _oItem, \"_oItem:_PROD:_CEST\" ) // C\u00d3DIGO CEST\n\n                //|Adiciona ao aCols |\n                aadd(_aItensCols[_nI], {\"D1_FSBICM \", Val(c_FSBICM), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSVICM \", Val(c_FSVICM), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSBIPI \", Val(c_FSBIPI), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSVIPI \", Val(c_FSVIPI), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSBPIS \", Val(c_FSBPIS), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSVPIS \", Val(c_FSVPIS), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSBCOF \", Val(c_FSBCOF), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSVCOF \", Val(c_FSVCOF), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSBIST \", Val(c_FSBIST), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSVIST \", Val(c_FSVIST), Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSCEST \", c_FSCEST     , Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSORIG \", c_FSORIG     , Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSCSTIC\", c_FSCSTIC    , Nil, Nil})\n                aadd(_aItensCols[_nI], {\"D1_FSCSTIP\", c_FSCSTIP    , Nil, Nil})\n\n            Next _nI\n\n        EndIf\n\n    END SEQUENCE\n\n    ErrorBlock(bError)\n\n    If !Empty(cExcept)\n        ConOut(cExcept)\n    EndIf\n\nReturn _aItensCols\n\n\n\nStatic Function fBuscaIcms( _oItem )\n\n    Local _oIcms as Object\n\n    Do Case\n\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS00\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS00\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS10\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS10\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS20\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS20\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS30\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS30\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS40\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS40\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS41\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS41\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS50\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS50\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS51\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS51\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS60\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS60\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS70\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS70\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMS90\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMS90\n        Case XmlChildEx(_oItem:_Imposto:_ICMS, \"_ICMSST\") != Nil\n            _oIcms := _oItem:_Imposto:_ICMS:_ICMSST\n\n    EndCase\n\nReturn _oIcms\n\n\n\nStatic Function fBuscaIpi( _oItem )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oItem:_Imposto:_IPI, \"_IPITRIB\") != Nil\n            _oImp := _oItem:_Imposto:_IPI:_IPITRIB\n        Case XmlChildEx(_oItem:_Imposto:_IPI, \"_IPINT\") != Nil\n            _oImp := _oItem:_Imposto:_IPI:_IPINT\n\n    EndCase\n\nReturn _oImp\n\n\n\nStatic Function fBuscaPis( _oItem )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oItem:_Imposto:_PIS, \"_PISALIQ\") != Nil\n            _oImp := _oItem:_Imposto:_PIS:_PISALIQ\n\n    EndCase\n\nReturn _oImp\n\n\n\nStatic Function fBuscaCofins( _oItem )\n\n    Local _oImp as Object\n\n    Do Case\n\n        Case XmlChildEx(_oItem:_Imposto:_COFINS, \"_COFINSALIQ\") != Nil\n            _oImp := _oItem:_Imposto:_COFINS:_COFINSALIQ\n\n    EndCase\n\nReturn _oImp\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018cpo","title":"P018CPO","text":"<p>Ponto de entrada para adicionar campos extras na SD1 antes do execauto. Esse ponto de entrada ser\u00e1 chamado para cada item do documento de entrada.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array com os campos do item a ser gerado no Protheus.</li> <li>ParamIxb[2]: Array com o item do XML.</li> <li>ParamIxb[3]: Array com o cabe\u00e7alho do XML.</li> </ul> <p>Retorno:</p> <ul> <li>aCpos: array, array com os campos extras na SD1 antes do execauto.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018CPO()\n\n  Local aCpos       := {}\n  Local _nPos       := 0\n  Local _cProduto   := \"\"\n  Local _cTipo      := \"\"\n  Local aItProtheus := ParamIxb[1]\n  Local aItXml      := ParamIxb[2]\n  Local aCabecXml   := ParamIxb[3]\n\n  //|Pega o produto |\n  If ( _nPos := aScan(aItProtheus, { |x| Alltrim(x[1]) == \"D1_COD\" }) ) &gt; 0\n        _cProduto   := aItProtheus[ _nPos, 2 ]\n    EndIf\n\n  //|Pega o Tipo de NF |\n  If ( _nPos := aScan(aCabecXml, { |x| Alltrim(x[1]) == \"F1_TIPO\" }) ) &gt; 0\n        _cTipo  := aCabecXml[ _nPos, 2 ]\n    EndIf\n\n  aadd(aCpos, {\"D1_XUMXML\" , aItXml:_Prod:_uCom:TEXT     , Nil, Nil})\n  aadd(aCpos, {\"D1_XQTDXML\", Val(aItXml:_Prod:_qCom:TEXT), Nil, Nil})\n  aadd(aCpos, {\"D1_XDESXML\", aItXml:_Prod:_XPROD:TEXT    , Nil, Nil})\n  aadd(aCpos, {\"D1_UM\"     , SB1-&gt;B1_UM                  , Nil, Nil})\n\nReturn aCpos\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018fim","title":"P018FIM","text":"<p>Ponto de entrada para manuten\u00e7\u00f5es diversas ao final da gera\u00e7\u00e3o\u00a0do\u00a0documento, devido a isso, j\u00e1 se encontra posicionado na ZZZ e na SF1.</p> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018FIM()\n\n  MsgInfo(\"Nota Fiscal gerada: \" + AllTrim(SF1-&gt;F1_DOC) + \" / \" + AllTrim(SF1-&gt;F1_SERIE))\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018item","title":"P018ITEM","text":"<p>Ponto de entrada para alterar informa\u00e7\u00f5es do item antes do execauto.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array com os campos do item a ser gerado no Protheus.</li> <li>ParamIxb[2]: Array com o item do XML.</li> <li>ParamIxb[3]: Array com o cabe\u00e7alho do XML.</li> </ul> <p>Retorno:</p> <ul> <li>aItemCols: array, array com a nova linha do item a ser gerado no Protheus.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018ITEM()\n\n    Local aItemCols     := ParamIxb[1]\n    Local _aCabec           := ParamIxb[3]\n    Local aItemXML      := ParamIxb[2]\n    Local nI                    := 0\n    Local nPos              := 0\n    Local lDevolucao    := .F.\n\n    If ( nPos := aScan( _aCabec, { |x| AllTrim( x[1] ) == \"F1_TIPO\" } ) )\n\n        lDevolucao  := ( _aCabec[nPos, 2] == \"D\" )\n\n    EndIf\n\n    If lDevolucao\n\n        For nI := 1 To Len(aItemCols)\n\n            //|Nota de devolu\u00e7\u00e3o? |\n            If AllTrim( aItemCols[nI,1] ) == \"D1_UM\"\n\n                Alert( \"Devolu\u00e7\u00e3o com o D1_UM = \" + aItemCols[nI,2] )\n\n                aItemCols[nI,2] := \"CX\"\n\n            EndIf\n\n        Next nI\n\n    EndIf\n\nReturn aItemCols\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018prod","title":"P018PROD","text":"<p>Ponto de entrada para analisar os itens do XML no momento da entrada.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array com o objeto XML dos produtos da nota fiscal eletronica.</li> <li>ParamIxb[2]: Se .T. indica que \u00e9 uma devolu\u00e7\u00e3o de venda.</li> <li>ParamIxb[3]: C\u00f3digo do fornecedor no Protheus.</li> <li>ParamIxb[4]: Loja do fornecedor no Protheus.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018PROD()\n\n  Local nCont       := 0\n  Local aItensXml   := ParamIxb[1]\n  Local lDevoluc    := ParamIxb[2]\n  Local cFornece    := ParamIxb[3]\n  Local cLoja       := ParamIxb[4]\n  Local aArea       := GetArea()\n  Local aAreaZZW    := ZZW-&gt;( GetArea() )\n\n  //|N\u00e3o processa para devolu\u00e7\u00e3o |\n  If lDevoluc\n    Return\n  EndIf\n\n  dbselectarea('ZZW')\n  ZZW-&gt;(dbsetorder(1))\n\n  For nCont := 1 To Len(aItensXml)\n\n    cProdFornec     := aItensXml[nCont]:_PROD:_CPROD:TEXT\n    cCodBarras        := IIf( XmlChildEx(aItensXml[nCont]:_PROD, \"_CEAN\") &lt;&gt; NIL,aItensXml[nCont]:_PROD:_CEAN:TEXT,space(12) )\n\n    //|Nesse ponto procura o produto na SB1 |\n    //...\n    //...\n    //...\n\n    //|Deve adicionar o produto na ZZW quando n\u00e3o existir |\n    If !ZZW-&gt;( dbSeek( xFilial('ZZW') + cfornece + cLoja + PADR(AllTrim(cProdFornec),TamSX3(\"ZZW_CODPRF\")[1]) + SB1-&gt;B1_COD) )\n\n      Reclock('ZZW',.T.)\n      ZZW-&gt;ZZW_FILIAL       := xFilial('ZZW')\n      ZZW-&gt;ZZW_PRODUT       := SB1-&gt;B1_COD\n      ZZW-&gt;ZZW_FORNEC       := cfornece\n      ZZW-&gt;ZZW_LOJA       := cLoja\n      ZZW-&gt;ZZW_CODPRF   := cProdFornec\n\n      If ZZW-&gt;( FieldPos(\"ZZW_DPRODF\") ) &gt; 0\n        ZZW-&gt;ZZW_DPRODF := aItensXml[nCont]:_PROD:_XPROD:TEXT\n      EndIf\n\n      ZZW-&gt;(MsUnlock())\n\n    EndIf\n\n  Next nCont\n\n\n  RestArea(aAreaZZW)\n  RestArea(aArea)\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018proprio","title":"P018PROPRIO","text":"<p>Ponto de entrada para indicar formul\u00e1rio pr\u00f3prio na entrada.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Se \u00e9 formul\u00e1rio pr\u00f3prio. Identificado com \"S\" ou \"N\".</li> <li>ParamIxb[2]: N\u00famero da NF que est\u00e1 entrando no sistema.</li> <li>ParamIxb[3]: S\u00e9rie da NF que est\u00e1 entrando no sistema.</li> </ul> <p>Retorno:</p> <ul> <li>aRetorno: array, array com dados para a NF-e.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018PROPRIO()\n\n    Local cFormProprio  := ParamIxb[1]\n    Local cNumNFe               := ParamIxb[2]\n    Local cNumSerie         := ParamIxb[3]\n    Local cSerieNF          := \"\"\n    Local aRetorno          := {}\n\n    cFormProprio    := fFormProrio()\n\n    If cFormProprio == \"S\"\n\n        cNumero := \"\"\n        Sx5NumNota( @cSerieNF, SuperGetMV(\"MV_TPNRNFS\") )\n\n        cNumNFe     := cNumero\n        cNumSerie   := cSerieNF\n\n    EndIf\n\n    aAdd(aRetorno, cFormProprio )\n    aAdd(aRetorno, cNumNFe          )\n    aAdd(aRetorno, cNumSerie        )\n\nReturn aRetorno\n\n\n\nStatic Function fFormProrio()\n\n    Local cRetorno   := \"N\"\n    Local aCombo1    := {\"N\u00e3o\",\"Sim\"}\n    Local aAuxCombo1 := {\"N\",\"S\"}\n\n    oDlg1     := MSDialog():New( 091,243,300,650,\"XML-e - Formul\u00e1rio Pr\u00f3prio\",,,.F.,,,,,,.T.,,,.T. )\n\n    oSay1      := TSay():New( 030,016,{||\"Formul\u00e1rio Pr\u00f3prio?\"},oDlg1,,,.F.,.F.,.F.,.T.,CLR_BLACK,CLR_WHITE,072,012)\n\n    @ 048,016 MSCOMBOBOX oBox1 VAR cRetorno ITEMS aCombo1 SIZE 150,100 OF oDlg1 PIXEL\n\n    oBtn1      := TButton():New( 088,068,\"Confirmar\",oDlg1,{|| TipoCombo(aCombo1,cRetorno,aAuxCombo1) },056,012,,,,.T.,,\"\",,,,.F. )\n\n    oDlg1:Activate(,,,.T.)\n\n    If Empty(cRetorno)\n        cRetorno    := \"N\"\n    EndIf\n\n  cRetorno := SubStr(cRetorno, 1, 1)\n\nReturn cRetorno\n\n\nStatic Function TipoCombo(aCombo,cCombo,aReferencia)\n\n    Local nPos  := aScan(aCombo,cCombo)\n    Local lRet  := (nPos &gt; 0)\n\n    If nPos &gt; 0\n        cCombo := aReferencia[nPos]\n    EndIf\n\n    oDlg1:End()\n\nReturn (lRet)\n\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018sf1","title":"P018SF1","text":"<p>Ponto de entrada para manipular o array de cabe\u00e7alho (SF1) do documento de entrada antes do execauto.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array com os campos do item a ser gerado no Protheus.</li> <li>ParamIxb[2]: Array com o cabe\u00e7alho do XML.</li> <li>ParamIxb[3]: Objeto do XML.</li> </ul> <p>Retorno:</p> <ul> <li>_aCabecalho: array, novo array do cabe\u00e7alho.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018SF1()\n\n    // Local _aItensCols := ParamIxb[1] as Array\n    Local _aCabecalho := ParamIxb[2] as Array\n    Local _oXml       := ParamIxb[3] as Object\n    Local oTransp     := Nil         as Object\n    Local cVolume     := \"\"          as Character\n\n    Local cExcept      := \"\"          as Character\n  Local bError                      as CodeBlock\n\n  bError    := ErrorBlock({|e| cExcept := \"&lt;h3&gt;\"+e:Description+\"&lt;/h3&gt;\"+e:ERRORSTACK})\n\n    BEGIN SEQUENCE\n\n        If ZZZ-&gt;ZZZ_TIPO == \"1\" //|NF-e |\n\n            oTransp     := _oXml:_InfNfe:_Transp\n\n            If XmlChildEx(oTransp, \"_VOL\") != Nil\n\n                cVolume := U_PTX_GetTagValue( oTransp, \"oTransp:_VOL:_QVOL\" )\n\n                If !Empty(cVolume)\n\n                    aAdd(_aCabecalho,{\"F1_VOLUME1\", Val(cVolume), Nil, Nil})\n\n                EndIf\n\n            EndIf\n\n        EndIf\n\n    END SEQUENCE\n\n    ErrorBlock(bError)\n\n    If !Empty(cExcept)\n        ConOut(cExcept)\n    EndIf\n\nReturn _aCabecalho\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018tipo","title":"P018TIPO","text":"<p>Ponto de entrada para modificar o tipo de nota fiscal.</p> <p>Retorno:</p> <ul> <li>cRetPE: caracter, novo tipo do documento fiscal.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function _P018TIPO()\n\n    Local cEstilo1  := \"\"\n    Local cEstBtn1  := \"\"\n    Local cEstSay2  := \"\"\n    Local c103Tipo  := \"\"\n    Local nAux      := 0\n    Local aCombo1   := {}\n    Local aAuxCombo1:= {}\n    Local cRetPE    := \"N\"\n\n    Private oBox1\n    Private oSay1\n\n    aCombo1    := {\"Normal\",\"Devolu\u00e7\u00e3o\",\"Beneficiamento\",\"Compl.  ICMS\",\"Compl.  IPI\",\"Compl. Preco/Frete\"}\n    aAuxCombo1 := {\"N\",\"D\",\"B\",\"I\",\"P\",\"C\"}\n    nAux       := aScan(aAuxCombo1,cRetPE)\n\n    If !Empty(cRetPE) .And. nAux &lt;&gt; 0\n        c103Tipo := aCombo1[nAux]\n    EndIf\n\n    oFont1     := TFont():New( \"Courier New\",0,-16,,.T.,0,,700,.F.,.F.,,,,,, )\n\n    oDlg1      := MSDialog():New( 091,243,270,650,\"XML-e - Tipo de Documento de Entrada\",,,.F.,,,,,,.T.,,,.T. )\n\n    oPanel1    := TPanel():New( 000,000,\"\",oDlg1,,.F.,.F.,,,280,085,.T.,.F. )\n    oPanel1:align:= CONTROL_ALIGN_ALLCLIENT\n        cEstilo1 := \"   QLabel {\"\n        cEstilo1 += \" background-color: #3D86AB;\"\n        cEstilo1 += \"}\"\n        oPanel1:SetCss(cEstilo1)\n\n    oSay1      := TSay():New( 012,016,{||\"Tipo da Nota\"},oPanel1,,oFont1,.F.,.F.,.F.,.T.,CLR_WHITE,CLR_WHITE,072,012)\n        cEstSay2    := \"    QLabel { \"\n        cEstSay2    += \"    font-family: cursive; \"\n        cEstSay2    += \"    font-weight: bold; \"\n        cEstSay2    += \"    font-size: large; \"\n        cEstSay2    += \"    line-height: 100%; \"\n        cEstSay2    += \"    word-spacing: 1ex; \"\n        cEstSay2    += \"    letter-spacing: normal; \"\n        cEstSay2    += \"    text-decoration: none; \"\n        cEstSay2    += \"    text-transform: none; \"\n        cEstSay2    += \"    text-align: left; \"\n        cEstSay2    += \"    color: #FFFFFF; \"\n        cEstSay2    += \"    text-indent: 0ex; \"\n        cEstSay2    += \"    } \"\n        oSay1:SetCss(cEstSay2)\n\n    //oGet1      := TGet():New( 024,016,{|u| If(PCount()&gt;0,cChvNfe:=u,cChvNfe)},oPanel1,240,008,'',,CLR_BLACK,CLR_WHITE,,,,.T.,\"\",,,.F.,.F.,,.F.,.F.,\"\",\"cChvNfe\",,)\n    @ 032,016 MSCOMBOBOX oBox1 VAR c103Tipo ITEMS aCombo1 SIZE 150,100 OF oDlg1 PIXEL\n\n    oBtn1      := TButton():New( 056,068,\"Confirmar\",oPanel1,{|| TipoCombo(@cRetPE,aCombo1,c103Tipo,aAuxCombo1,\"1\") },056,012,,,,.T.,,\"\",,,,.F. )\n    cEstBtn1 := \"QPushButton {\"\n            cEstBtn1 += \" background-image: url(rpo:PTX_Refresh.png);\"\n            cEstBtn1 += \" background-repeat: none; \"\n            cEstBtn1 += \" background-attachment: fixed; \"\n            cEstBtn1 += \" background-position: left center; \"\n            cEstBtn1 += \" border-style: outset;\"\n            cEstBtn1 += \" border-width: 2px;\"\n            cEstBtn1 += \" border: 1px solid #C0C0C0;\"\n            cEstBtn1 += \" border-radius: 5px;\"\n            cEstBtn1 += \" border-color: #C0C0C0;\"\n            cEstBtn1 += \" font: bold 12px Arial;\"\n            cEstBtn1    += \"    color: #ffffff; \"\n            cEstBtn1 += \" padding: 6px;\"\n            cEstBtn1 += \"} \"\n\n            cEstBtn1 += \"QPushButton:hover { \"\n            cEstBtn1 += \" background-color: #cecef6;\"\n            cEstBtn1 += \" border-style: inset;\"\n            cEstBtn1 += \" opacity: 0.2; \"\n            cEstBtn1 += \"} \"\n\n            cEstBtn1 += \"QPushButton:pressed {\"\n            cEstBtn1 += \" background-color: #e6e6f9;\"\n            cEstBtn1 += \" border-style: inset;\"\n            cEstBtn1 += \"} \"\n            oBtn1:SetCss(cEstBtn1)\n\n    oDlg1:Activate(,,,.T.)\n\n    If Empty(cRetPE)\n        cRetPE  := \"N\"\n    EndIf\n\nReturn cRetPE\n\n\nStatic Function TipoCombo(cVariavel,aCombo,cCombo,aReferencia,cIdent)\n\n    Local nPos  := aScan(aCombo,cCombo)\n    Local lRet  := (nPos &gt; 0)\n\n    If nPos &gt; 0\n        cVariavel := aReferencia[nPos]\n    EndIf\n\n    oDlg1:End()\n\nReturn (lRet)\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018um","title":"P018UM","text":"<p>Ponto de entrada que realiza a convers\u00e3o de unidade de medida de acordo com a ZZW.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Unidade de medida do XML.</li> <li>ParamIxb[2]: Quantidade do produto do XML.</li> <li>ParamIxb[3]: Total do item do XML.</li> <li>ParamIxb[4]: Valor unit\u00e1rio do item no XML.</li> <li>ParamIxb[5]: N\u00famero do Pedido de Compra.</li> <li>ParamIxb[6]: Item do Pedido de Compra.</li> </ul> <p>Retorno:</p> <p>O retorno \u00e9 efetuado nas vari\u00e1veis privadas abaixo.</p> <ul> <li>cUnMed1: caracter, Primeira Unidade de Medida D1_UM.</li> <li>nQtdUM1: caracter, Quantidade na primeira Unidade de Medida.</li> <li>cUnMed2: caracter, Segunda Unidade de Medida utilizada.</li> <li>nQtdUM2: caracter, Quantidade na Segunda Unidade de Medida utilizada.</li> <li>nVlrUM1: caracter, Valor Unit\u00e1rio na Primeira Unidade de Medida do Produto.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018UM()\n\n  // Local cUmXml    := ParamIxb[1]\n  Local nQtdXML   := ParamIxb[2]\n  Local nTotalXml := ParamIxb[3]\n  // Local nUnitXml  := ParamIxb[4]\n  Local nQtConv   := 0\n\n  dbSelectArea(\"ZZW\")\n  ZZW-&gt;(dbSetOrder(2))  //ZZW_FILIAL+ZZW_FORNEC+ZZW_LOJA+ZZW_PRODUT\n  If ZZW-&gt;(dbSeek(xFilial(\"ZZW\") + SA2-&gt;A2_COD + SA2-&gt;A2_LOJA + SB1-&gt;B1_COD ))\n\n    If !Empty(ZZW-&gt;ZZW_SEGUM) .And. !Empty(ZZW-&gt;ZZW_CONV) .And. !Empty(ZZW-&gt;ZZW_TIPCON)\n\n      nQtConv       := U_PTXConvUm( SB1-&gt;B1_COD, 0, nQtdXML, 1 )\n\n      If nQtConv &gt; 0\n\n        //|Retorno |\n        cUnMed1     := SB1-&gt;B1_UM         //|Primeira Unidade de Medida D1_UM |\n        nQtdUM1     := nQtConv              //|Qtd UM 1 D1_QUANT |\n\n        cUnMed2 := ZZW-&gt;ZZW_SEGUM\n        nQtdUM2 := nQtdXML\n\n        //IF SAH-&gt;(dbSeek(xFilial(\"SAH\") + cUnidMed )) //AH_FILIAL, AH_UNIMED, R_E_C_N_O_, D_E_L_E_T_\n        //  cUnMed2     := cUnidMed             //|Segunda Unidade de Medida D1_SEGUM |\n        //  nQtdUM2     := nQuant               //|Qtd UM 2 D1_QTSEGUM |\n        //ENDIF\n\n        nVlrUM1     := nTotalXml / nQtConv  //|Valor Unit UM 1 D1_VUNIT |\n\n      EndIf\n\n    EndIf\n\n  EndIf\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#p018zzw","title":"P018ZZW","text":"<p>Ponto de entrada para manuten\u00e7\u00f5es ap\u00f3s inclus\u00e3o da ZZW. Nesse momento j\u00e1 est\u00e1 posicionado na ZZW inclu\u00edda.</p> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function P018ZZW()\n\n  Local aArea := GetArea()\n  Local cQuery := \"\"\n\n  cQuery += \" SELECT A5_FORNECE \"\n  cQuery += \" FROM \" + RetSqlName(\"SA5\") + \" SA5 \"\n  cQuery += \" WHERE A5_FILIAL = \" + ValToSql( xFilial(\"SA5\") )\n  cQuery += \"   AND A5_FORNECE = \" + ValToSql( ZZW-&gt;ZZW_FORNEC )\n  cQuery += \"   AND A5_LOJA = \" + ValToSql( ZZW-&gt;ZZW_LOJA )\n  cQuery += \"   AND A5_PRODUTO = \" + ValToSql( ZZW-&gt;ZZW_PRODUT )\n  cQuery += \"   AND A5_CODPRF = \" + ValToSql( ZZW-&gt;ZZW_CODPRF )\n  cQuery += \"   AND SA5.D_E_L_E_T_ = '' \"\n\n  If Select(\"__SA5\") &gt; 0\n    __SA5-&gt;( dbCloseArea() )\n  EndIf\n\n  cQuery := ChangeQuery(cQuery)\n  dbUseArea( .T., \"TOPCONN\", TCGenQry(,,cQuery), \"__SA5\", .T., .T. )\n\n  __SA5-&gt;( dbGoTop() )\n\n  //|Caso n\u00e3o exista cadastrado |\n  If __SA5-&gt;( EoF() )\n\n    RecLock(\"SA5\", .T.)\n    SA5-&gt;A5_FILIAL  := xFilial(\"SA5\")\n    SA5-&gt;A5_FORNECE := ZZW-&gt;ZZW_FORNEC\n    SA5-&gt;A5_LOJA    := ZZW-&gt;ZZW_LOJA\n    SA5-&gt;A5_PRODUTO := ZZW-&gt;ZZW_PRODUT\n    SA5-&gt;A5_CODPRF  := ZZW-&gt;ZZW_CODPRF\n    SA5-&gt;( MsUnLock() )\n\n  EndIf\n\n  RestArea( aArea )\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#pt006xml","title":"PT006XML","text":"<p>Ponto de Entrada para realizar a\u00e7\u00f5es ap\u00f3s a importa\u00e7\u00e3o do CTE.</p> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>user function PT006XML()\n\n    Local aArea     := GetArea()\n    Local aAreaZZZ  := ZZZ-&gt;(GetArea())\n\n    dbSelectArea(\"ZZZ\")\n    ZZZ-&gt;(dbSetOrder(1))\n    ZZZ-&gt;(dbSeek(xFilial(\"ZZZ\") + \"32171001928075005835550020000243931464892230\"))\n\n\n\n    If !Empty(ZZZ-&gt;ZZZ_XML)\n\n        //|Chama rotina para gerar o documento de entrada |\n        fClassDev()\n\n    EndIf\n\n    RestArea(aAreaZZZ)\n    RestArea(aArea)\n\nreturn\n\n\nStatic Function fClassDev()\n\n    Local cError        := \"\"\n    Local cWarning      := \"\"\n    Local cCliente      := \"\"\n    Local cLoja         := \"\"\n    Local cEmissao      := \"\"\n    Local cNumNf        := \"\"\n    Local cSerie        := \"\"\n    Local cCnpjEmi      := \"\"\n    Local cCfoDev       := SuperGetMV(\"MV_YCFODEV\",.F.,\"201/411/410\")\n    Local aArea         := GetArea()\n    Local aItTemp       := {}\n    Local aItens        := {}\n    Local nI            := 0\n    Local lDevol        := .F.\n    Local oXml          := NIL\n\n    oXml := XmlParser( ZZZ-&gt;ZZZ_XML, \"_\", @cError, @cWarning )\n\n    If !Empty(alltrim(cError))\n        oXml := NIL\n    EndIf\n\n    If oXml &lt;&gt; NIL\n        //Tratamento caso o xml possua a tag NFEPROC\n        if XmlChildEx(oXml, \"_NFEPROC\") &lt;&gt; nil\n            oXml := XmlChildEx(oXml, \"_NFEPROC\")\n        endif\n        if XmlChildEx(oXml, \"_NFE\") == nil\n            oXml := NIL\n        elseIf ValType(oXml:_NFE:_INFNFE:_DET) &lt;&gt; \"A\"\n            XmlNode2Arr(oXml:_NFE:_INFNFE:_DET,\"_DET\")\n        EndIf\n    endif\n\n    If oXml &lt;&gt; nil\n\n        aItens  := oXml:_NFE:_INFNFE:_DET\n\n        For nI := 1 To Len(aItens)\n\n            If XmlChildEx(aItens[1]:_PROD, \"_CFOP\") &lt;&gt; Nil\n\n                If SubStr(aItens[nI]:_PROD:_CFOP:TEXT,2,3) $ cCfoDev\n                    lDevol  := .T.\n                    Exit\n                EndIf\n\n            EndIf\n\n        Next nI\n\n        //|Nota Fiscal de Devolu\u00e7\u00e3o |\n        If lDevol\n\n            //|Valida cliente emissor da devolu\u00e7\u00e3o |\n            cCnpjEmi    := PadR(Alltrim(oXml:_NFE:_INFNFE:_EMIT:_CNPJ:TEXT),TamSX3(\"A1_CGC\")[1])\n\n            dbSelectArea(\"SA1\")\n            SA1-&gt;(dbSetOrder(3))\n            If SA1-&gt;(dbSeek(xFilial(\"SA2\") + cCnpjEmi))\n                cCliente    := SA2-&gt;A2_COD\n                cLoja       := SA2-&gt;A2_LOJA\n            Else\n                ConOut(\"###### ERRO -&gt; CLIENTE NAO ENCONTRADO - CNPJ: \" + cCnpjEmi)\n                Return\n            EndIf\n\n            cEmissao    := IIf(XmlChildEx(oXml:_NFE:_INFNFE:_IDE, \"_DHEMI\")&lt;&gt;nil,ConvDate(Substr(oXml:_NFE:_INFNFE:_IDE:_DHEMI:TEXT,1,10)),\"\")\n            cNumNf      := PadL(AllTrim(oXml:_NFE:_INFNFE:_IDE:_NNF:TEXT),TamSX3(\"F1_DOC\")[1],\"0\")\n            cSerie      := AllTrim(oXml:_NFE:_INFNFE:_IDE:_SERIE:TEXT)\n\n            dbSelectArea(\"SF1\")\n            SF1-&gt;(dbSetOrder(1))\n            If SF1-&gt;(dbSeek(xFilial(\"SF1\")+ PadL(Alltrim(cNumNf),TamSX3(\"F1_DOC\")[1]) + PadR(cSerie,TamSX3(\"F1_SERIE\")[1]) + ;\n                    PadR(Alltrim(cCliente),TamSX3(\"F1_FORNECE\")[1]) + PadR(cLoja,TamSX3(\"F1_LOJA\")[1])))\n\n                ConOut(\"###### ERRO -&gt; Nota No.: \"+ Alltrim(SF1-&gt;F1_DOC)+\"/\"+SF1-&gt;F1_SERIE+\" do Fornec. \"+SF1-&gt;F1_FORNECE+\"/\"+SF1-&gt;F1_LOJA+\" Ja Existe. A Importacao sera interrompida!!\")\n                Return\n\n            EndIf\n\n            If Type(\"oXml:_NfeProc\")&lt;&gt; \"U\"\n                oNF := oXml:_NFeProc:_NFe\n            Else\n                If Type(\"oXml:_NFe\")&lt;&gt; \"U\"\n                    oNF := oXml:_NFe\n                Else\n                    ConOut('O arquivo informado nao esta no formato XML ou esta corrompido.')\n                    Return\n                EndIf\n            EndIf\n\n            //|Rotina para gerar o documento de entrada |\n            SFP001()\n\n        EndIf\n\n    EndIf\n\n\nReturn\n\n\n\nStatic Function SFP001()\n\n    Local aCabec        := {}\n    Local aItens        := {}\n    Local nX            := 1\n\n    Private aXML        := {}\n    Private oEmitente   := oNF:_InfNfe:_Emit\n    Private oIdent      := oNF:_InfNfe:_IDE\n    Private oDestino    := oNF:_InfNfe:_Dest\n    Private oTotal      := oNF:_InfNfe:_Total\n    Private oTransp     := oNF:_InfNfe:_Transp\n    Private oDet        := oNF:_InfNfe:_Det\n\n    If Type(\"oNF:_InfNfe:_ICMS\")&lt;&gt; \"U\"\n        Private oICM        := oNF:_InfNfe:_ICMS\n    Else\n        Private oICM        := nil\n    Endif\n\n    Private oFatura     := IIf(Type(\"oNF:_InfNfe:_Cobr\")==\"U\",Nil,oNF:_InfNfe:_Cobr)\n    Private cEdit1      := Space(15)\n    Private _DESCdigit  := space(55)\n    Private _NCMdigit   := space(8)\n    Private cChave      := oNFe:_NFeProc:_protNFe:_infProt:_chNFe:TEXT\n\n    oDet := IIf(ValType(oDet)==\"O\",{oDet},oDet)\n\n    aAdd(aCabec,{\"F1_TIPO\"   ,\"D\"                                   ,Nil,Nil})\n    aAdd(aCabec,{\"F1_FORMUL\" ,\"N\"                                   ,Nil,Nil})\n    aAdd(aCabec,{\"F1_DOC\"    ,Alltrim(oIdent:_nNF:TEXT)             ,Nil,Nil})\n    aAdd(aCabec,{\"F1_SERIE\"  ,oIdent:_serie:TEXT                        ,Nil,Nil})\n\n    If(Type(\"oNF:_InfNfe:_infAdic:_infCpl:TEXT\")&lt;&gt;\"U\")\n        aAdd(aCabec,{\"F1_MENNOTA\",oNF:_InfNfe:_infAdic:_infCpl:TEXT     ,Nil,Nil})\n    EndIf\n\n    cCodTrans := Transp()\n    Volumes()\n\n    If AllTrim(cCodTrans) != \"\"\n        aAdd(aCabec,{\"F1_TRANSP\", cCodTrans,Nil,Nil})\n    EndIf\n\n    If(Type(\"oTransp:_VeicTransp:_Placa:TEXT\")&lt;&gt;\"U\")\n        aAdd(aCabec,{\"F1_PLACA\", oTransp:_VeicTransp:_Placa:TEXT,Nil,Nil})\n    Endif\n\n    cCgc        := StrTran(cCnpjEmi,',','')\n    cCgc        := StrTran(cCgc,'.','')\n    cCgc        := StrTran(cCgc,'/','')\n    cCgc        := StrTran(cCgc,'-','')\n\n    dbSelectArea(\"SA1\")\n    SA1-&gt;(dbSetOrder(3))\n    SA1-&gt;(dbSeek(xFilial(\"SA1\") + cCgc))\n\n    cData   := \"\"\n    If Type('oIdent:_dEmi:TEXT') &lt;&gt; \"U\"\n        cData   := Alltrim(oIdent:_dEmi:TEXT)\n    EndIf\n\n    If  cData == \"\" .And. Type('oIdent:_dhEmi:TEXT') &lt;&gt; \"U\"\n        cData   := SubStr(Alltrim(oIdent:_dhEmi:TEXT),1, 10)\n    EndIf\n\n    If Empty(cData)\n        cData := DToS(dDatabase)\n    EndIf\n\n    dData   := CtoD(Right(cData,2)+'/'+Substr(cData,6,2)+'/'+Left(cData,4))\n    aAdd(aCabec,{\"F1_EMISSAO\",dData,Nil,Nil})\n    aAdd(aCabec,{\"F1_FORNECE\",SA1-&gt;A1_COD,Nil,Nil})\n    aAdd(aCabec,{\"F1_LOJA\"   ,SA1-&gt;A1_LOJA,Nil,Nil})\n    aAdd(aCabec,{\"F1_ESPECIE\",\"SPED\",Nil,Nil})\n    aAdd(aCabec,{\"F1_CHVNFE\",cChave,Nil,Nil})\n\n    For nX := 1 To Len(oDet)\n\n        cItemXml    := oDet[nZ]:_NITEM:TEXT\n        aXML        := {oDet[nZ]}   \n\n        If Empty(aXML)\n            ConOut(\"##### ERRO -&gt; Falha na estrutura do array!!\")\n            Return .F.\n        EndIf\n\n        cProduto    := PadR(AllTrim(aXML[nX]:_Prod:_cProd:TEXT),20)\n        cUnidMed    := Right(AllTrim(aXML[nX]:_Prod:_uCom:TEXT),2) \n\n        dbSelectArea(\"SB1\")\n        SB1-&gt;(dbSetOrder(1))\n        SB1-&gt;(dbSeek(xFilial(\"SB1\")+ PadR(cProduto,TamSX3(\"B1_COD\")[1])))\n\n        aLinha  := {}\n\n        cNCM        := IIf(Type(\"aXML[1]:_Prod:_NCM\")==\"U\",space(12),aXML[1]:_Prod:_NCM:TEXT)\n        Chkproc := .F.\n\n        // DEFINIR AS QUANTIDADES / PRE\u00c7O UNITARIO / PRIMEIRA E SEGUNDA UM\n        nQtdOri := 0\n        If Val(aXML[nX]:_Prod:_qCom:TEXT) != 0\n            nQtdOri := Val(aXML[nX]:_Prod:_qCom:TEXT)\n        Else\n            nQtdOri := Val(aXML[nX]:_Prod:_qTrib:TEXT)\n        EndIf\n\n        nQtdUM1     := 0    // Qtd UM 1\n        nQtdUM2     := 0    // Qtd UM 2\n        nVlrUM1     := 0    // Valor Unit UM 1\n\n        If cUnidMed == SB1-&gt;B1_UM\n            nQtdUM1     := nQtdOri\n            nQtdUM2     := 0\n            nVlrUM1     := Val(aXML[nX]:_Prod:_vProd:TEXT) / nQtdOri\n        ElseIf SB1-&gt;B1_CONV &gt; 0\n            nQtdUM1     := ConvUM(SB1-&gt;B1_COD, 0, nQtdOri, 1)  // PRI UM\n            nQtdUM2     := nQtdOri  // SEG UM\n            nVlrUM1     := Val(aXML[nX]:_Prod:_vProd:TEXT) / nQtdUM1 // nQtdUM2\n            lSegUM      := .T.\n        Else\n            nQtdUM1     := nQtdOri\n            nQtdUM2     := 0\n            nVlrUM1     := Val(aXML[nX]:_Prod:_vProd:TEXT) / nQtdOri\n        EndIf\n\n        aAdd(aLinha,{\"D1_COD\"   ,SB1-&gt;B1_COD,Nil,Nil})\n\n        aAdd(aLinha,{\"D1_QUANT\" ,nQtdUM1,Nil,Nil})\n        If nQtdUM2 &gt; 0\n            aAdd(aLinha,{\"D1_QTSEGUM\",nQtdUM2,Nil,Nil})\n        EndIf\n        aAdd(aLinha,{\"D1_VUNIT\",Round(nVlrUM1,6),Nil,Nil})\n        nQdeOrig   := nQtdOri\n\n        aAdd(aLinha,{\"D1_TOTAL\",Val(aXML[nX]:_Prod:_vProd:TEXT),Nil,Nil})\n\n        If Type('aXML[nX]:_Prod:_vOutro:TEXT') != 'U'\n            aadd(aLinha,{\"D1_DESPESA\",Val(aXML[nX]:_Prod:_vOutro:TEXT),Nil,Nil})\n        EndIf\n\n        If Type('aXML[nX]:_Prod:_vFrete:TEXT') != 'U'\n            aadd(aLinha,{\"D1_VALFRE\",Val(aXML[nX]:_Prod:_vFrete:TEXT),Nil,Nil})\n        EndIf\n\n        If Type('aXML[nX]:_Prod:_vSeg:TEXT') != 'U'\n            aadd(aLinha,{\"D1_SEGURO\",Val(aXML[nX]:_Prod:_vSeg:TEXT),Nil,Nil})\n        EndIf\n\n        If Type('aXML[nX]:_Prod:_vDesc:TEXT') != 'U'\n            aadd(aLinha,{\"D1_VALDESC\",Val(aXML[nX]:_Prod:_vDesc:TEXT),Nil,Nil})\n        EndIf\n\n        cItem       := StrZero(nX, TamSX3(\"D1_ITEM\"[1]))\n\n        aadd(aLinha,{\"D1_TIPO\", \"D\",Nil,Nil})\n\n        _cfop:=aXML[nX]:_Prod:_CFOP:TEXT\n\n        If Left(Alltrim(_cfop),1)=\"5\"\n            _cfop:=Stuff(_cfop,1,1,\"1\")\n        Else\n            _cfop:=Stuff(_cfop,1,1,\"2\")\n        EndIf\n\n        If Type(\"oDet[nX]:_Prod:_vDesc\")&lt;&gt; \"U\"\n            aadd(aLinha,{\"D1_VALDESC\",Val(aXML[nX]:_Prod:_vDesc:TEXT),Nil,Nil})\n        Else\n            aadd(aLinha,{\"D1_VALDESC\",0,Nil,Nil})\n        EndIf   \n\n        If Type(\"aXML[nX]:_Imposto:_IPI:_IPITrib\") != \"U\"\n            oIPI    := aXML[nX]:_Imposto:_IPI:_IPITrib\n            aadd(aLinha,{\"D1_VALIPI\",VAL(oIPI:_vIPI:TEXT),,Nil})\n            If Type(\"aXML[nX]:_Imposto:_IPI:_IPITrib:_pIPI\") &lt;&gt; \"U\"                                                  \n                aadd(aLinha,{\"D1_IPI\"   ,VAL(oIPI:_pIPI:TEXT),,Nil})\n            EndIf         \n        EndIf\n\n        Do Case\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS00\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS00\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS10\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS10\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS20\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS20\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS30\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS30\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS40\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS40\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS51\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS51\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS60\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS60\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS70\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS70\n            Case Type(\"aXML[nX]:_Imposto:_ICMS:_ICMS90\")&lt;&gt; \"U\"\n            oICM:=aXML[nX]:_Imposto:_ICMS:_ICMS90\n        EndCase\n        If Type(\"oICM:_orig:TEXT\")&lt;&gt; \"U\"\n            cOrigProd := oICM:_orig:TEXT\n        EndIf\n\n        aAdd(aLinha,{\"AUTDELETA\"    ,\"N\",,Nil})\n\n        //|Vincula a NF de origem da devolu\u00e7\u00e3o |\n        dbSelectArea(\"SD2\")\n        SD2-&gt;(dbSetOrder(3))\n        If SD2-&gt;(dbSeek(xFilial(\"SD2\") + PADL(Alltrim(oIdent:_nNF:TEXT),TamSX3(\"F2_DOC\")[1]) + PADL(Alltrim(oIdent:_serie:TEXT),TamSX3(\"F2_DOC\")[1]) +; \n                    SA1-&gt;A1_COD + SA1-&gt;A1_LOJA + SB1-&gt;B1_COD))\n\n            aAdd(aLinha,{\"D1_NFORI\"     ,SD2-&gt;D2_DOC,,Nil})\n            aAdd(aLinha,{\"D1_SERIORI\"   ,SD2-&gt;D2_SERIE,,Nil})\n            aAdd(aLinha,{\"D1_ITEMORI\"   ,SD2-&gt;D2_ITEM,,Nil})\n\n        Else\n\n            ConOut(\"##### ERRO -&gt; NAO FOI POSSIVEL ENCONTRAR A NF ORIGINAL DA DEVOLUCAO NA SD2!\")\n            Return\n\n        EndIf\n\n        aAdd(aItens,aLinha)\n\n    Next nX\n\n    If Len(aItens) &gt; 0\n\n        Private lMsErroAuto := .F.\n        Private lMsHelpAuto := .T.\n\n        SB1-&gt;( dbSetOrder(1) )\n        SA2-&gt;( dbSetOrder(1) )\n\n        //|Gera o documento de entrada classificado |\n        Begin Transaction\n\n        nModulo := 4  //Estoque\n\n        MSExecAuto({|x,y,Z| MATA103(x,y,z)},aCabec,aItens,3,.F.)\n\n        If lMsErroAuto\n            DisarmTransaction()\n            ConOut(MostraErro())\n        Else    \n\n            ConOut(\"-----&gt; GERADO DOCUMENTO DE ENTRADA DA DEVOLUCAO COM SUCESSO &lt;-----\")\n\n            //|Altera o status para classificado |\n            RecLock(\"ZZZ\",.F.)\n            ZZZ-&gt;ZZZ_OK := \"C\"\n            ZZZ-&gt;(MsUnLock())\n\n        EndIf\n\n        End Transaction\n        MsUnlockAll()\n\n    EndIf\n\nReturn\n\n\n/*\n------------------------------------------------------------------------------------------------------------\nFun\u00e7\u00e3o      : Transp\nTipo            : Fun\u00e7\u00e3o de Usu\u00e1rio\nDescri\u00e7\u00e3o       : Consulta o c\u00f3digo da transportadora, caso a mesma esteja cadastrado\nPar\u00e2metros  :\nRetorno     : C\u00f3digo da transportadora\n------------------------------------------------------------------------------------------------------------\nAtualiza\u00e7\u00f5es:\n- 20/07/2016 - Pontin - Constru\u00e7\u00e3o inicial do fonte\n------------------------------------------------------------------------------------------------------------\n*/\n\nStatic Function Transp()\n\n    Local cDoc      := \"\"\n    Local cCodigo   := \"\"\n\n    If Type(\"oTransp:_Transporta:_CNPJ:TEXT\")&lt;&gt;\"U\"\n        cDoc := oTransp:_Transporta:_CNPJ:TEXT\n\n    ElseIf Type(\"oTransp:_Transporta:_CPF:TEXT\")&lt;&gt;\"U\"\n        cDoc := oTransp:_Transporta:_CPF:TEXT\n\n    EndIf\n\n    If AllTrim(cDoc) == \"\"\n        Return()\n    EndIf\n\n    cCodigo := Posicione(\"SA4\", 3, XFILIAL(\"SA4\")+cDoc, \"A4_COD\")\n\nReturn cCodigo\n\n\n/*\n------------------------------------------------------------------------------------------------------------\nFun\u00e7\u00e3o      : Volumes\nTipo            : Fun\u00e7\u00e3o de Usu\u00e1rio\nDescri\u00e7\u00e3o       : Cadastra os valores referentes ao volume da nota fiscal\nPar\u00e2metros  :\nRetorno     :\n------------------------------------------------------------------------------------------------------------\nAtualiza\u00e7\u00f5es:\n- 30/07/2015 - Pontin - Constru\u00e7\u00e3o inicial do fonte\n------------------------------------------------------------------------------------------------------------\n*/\nStatic Function Volumes()\n\n    If Type(\"oTransp:_Vol:_PesoL\"   )!=\"U\"\n        aadd(aCabec,{\"F1_PESOL\"     ,Val(oTransp:_Vol:_PesoL:TEXT)  ,Nil,Nil})\n    EndIf\n\n    If Type(\"oTransp:_Vol:_PesoL\"   )!=\"U\"\n        aadd(aCabec,{\"F1_PLIQUI\"    ,Val(oTransp:_Vol:_PesoL:TEXT)  ,Nil,Nil})\n    EndIf\n\n    If Type(\"oTransp:_Vol:_PesoB\"   )!=\"U\"\n        aadd(aCabec,{\"F1_PBRUTO\"    ,Val(oTransp:_Vol:_PesoB:TEXT)  ,Nil,Nil})\n    EndIf\n\n    If Type(\"oTransp:_Vol:_Esp\"     )!=\"U\"\n        aadd(aCabec,{\"F1_ESPECI1\"   ,oTransp:_Vol:_Esp:TEXT         ,Nil,Nil})\n    EndIf\n\n    If Type(\"oTransp:_Vol:_nVol\"    )!=\"U\" .And. val(oTransp:_Vol:_nVol:TEXT) &lt;= 999999\n        aadd(aCabec,{\"F1_VOLUME1\"   ,val(oTransp:_Vol:_nVol:TEXT)   ,Nil,Nil})\n    EndIf\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#pt015ite","title":"PT015ITE","text":"<p>Ponto de Entrada na abertura da tela de classifica\u00e7\u00e3o do documento de entrada. Chamado para cada item do documento de entrada.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array de dados da Linha.</li> <li>ParamIxb[2]: N\u00famero da linha.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PT015ITE()\n\n    Local aDados    := ParamIxb[1]\n    Local nLinha    := ParamIxb[2]\n    Local aArea     := GetArea()\n    Local nPOSTES   := ASCAN(aHEADER,{|X|ALLTRIM(UPPER(X[2])) == \"D1_TES\"})\n    Local nPOSCFOP  := ASCAN(aHEADER,{|X|ALLTRIM(UPPER(X[2])) == \"D1_CF\"})\n    Local cCodTES   := \"\"\n\n    If !Empty(aCols[nLinha,nPOSTES]) .And. AllTrim(SF1-&gt;F1_ESPECIE) == \"CTE\"\n\n        cCodTES := aCols[nLinha,nPOSTES]\n\n        dbSelectArea(\"SF4\")\n        SF4-&gt;(dbSetOrder(1))\n        SF4-&gt;(dbSeek(xFilial(\"SF4\") + cCodTES))\n\n        aCols[nLinha,nPOSCFOP]  := SF4-&gt;F4_CF\n\n        MaFisLoad(\"IT_TES\",\"\",nLinha)\n        MaFisAlt(\"IT_TES\",cTes,nLinha)\n        MaFisLoad(\"IT_CF\",\"\",nLinha)\n        MaFisAlt(\"IT_CF\",SF4-&gt;F4_CF,nLinha)             \n        MaFisToCols(aHeader,aCols,nLinha,\"MT100\")\n        //A103Trigger(\"D1_COD\")\n\n    EndIf\n\n    RestArea(aArea)\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#pt024cte","title":"PT024CTE","text":"<p>Ponto de Entrada para realizar a\u00e7\u00f5es ap\u00f3s a importa\u00e7\u00e3o do CTE.</p> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>user function PT024CTE()\n\n    Private lJob    := IsBlind()\n\n    If !Empty(ZZZ-&gt;ZZZ_XML)\n\n        //|Chama rotina para gerar o documento de entrada |\n        If !lJob\n\n            If MsgYesNo(\"Deseja gerar a entrada autom\u00e1tica do frete selecionado?\",FunName()) .And. ZZZ-&gt;ZZZ_TIPO == \"2\"\n                MsgRun(\"Gerando entrada do frete\",\"Processando\",{|| fClassCte() })\n            EndIf\n\n        Else\n            fClassCte()\n        EndIf\n\n    EndIf\n\nreturn\n\n\nStatic Function fClassCte()\n\n    Local aArea     := GetArea()\n    Local aCabNF    := {}\n    Local aItem     := {}\n    Local aTotItem  := {}\n    Local aAreaSM0  := {}\n    Local aDadosCfo := {}\n    Local cAlias    := \"\"\n    Local cProduto  := \"\"\n    Local cTes      := \"\"\n    Local cAviso    := \"\"\n    Local cErro     := \"\"\n    Local cDoc      := \"\"\n    Local cSerie    := \"\"\n    Local cDtCte    := \"\"\n    Local cCNPJ     := \"\"\n    Local cCnpjEmp  := \"\"\n    Local cIdCte    := \"\"\n    Local cNewFil   := \"\"\n    Local cOldFil   := \"\"\n    Local cChvCte   := \"\"\n    Local cChvSF2   := \"\"\n    Local cMsg      := \"\"\n    Local cCfop     := \"\"\n    Local cProdXML  := \"ATHOS\"\n    Local dDtCte    := CtoD(\" \")\n    Local nVlrFrete := 0\n    Local nBaseIcms := 0\n    Local nAliqIcms := 0\n    Local nVlrIcms  := 0\n\n    Private oCTe    := Nil\n\n    If Empty(ZZZ-&gt;ZZZ_XML)\n\n        cMsg    := \"------&gt; ERRO: CTE SEM XML &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return \n\n    EndIf\n\n    oCTe := XmlParser( ZZZ-&gt;ZZZ_XML, \"_\", @cAviso, @cErro )\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_NCT\" ) &lt;&gt; \"U\"\n        cDoc      := Alltrim(oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_NCT:TEXT )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_SERIE\" ) &lt;&gt; \"U\"\n        cSerie    := oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_SERIE:TEXT\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_DHEMI\" ) &lt;&gt; \"U\"\n        cDtCte    := oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_DHEMI:TEXT\n        dDtCte    := Ctod( ( SubStr( cDtCte, 9, 2 ) + \"/\" + SubStr( cDtCte, 6, 2 ) + \"/\" + SubStr( cDtCte, 1, 4 ) ) )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_EMIT:_CNPJ\" ) &lt;&gt; \"U\"\n        cCNPJ     := oCTe:_CTEPROC:_CTE:_INFCTE:_EMIT:_CNPJ:TEXT\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_VPREST:_VTPREST\" ) &lt;&gt; \"U\"\n        nVlrFrete := Val( oCTe:_CTEPROC:_CTE:_INFCTE:_VPREST:_VTPREST:TEXT )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_VBC\" ) &lt;&gt; \"U\"\n        nBaseIcms := Val( oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_VBC:TEXT )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_PICMS\" ) &lt;&gt; \"U\"\n        nAliqIcms := Val( oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_PICMS:TEXT )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_VICMS\" ) &lt;&gt; \"U\"\n        nVlrIcms  := Val( oCTe:_CTEPROC:_CTE:_INFCTE:_IMP:_ICMS:_ICMS00:_VICMS:TEXT )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_ID\" ) &lt;&gt; \"U\"\n        cIdCte    := StrTran( ( oCTe:_CTEPROC:_CTE:_INFCTE:_ID:TEXT ), \"CTe\", \"\" )\n    EndIf\n\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_INFCTENORM:_INFDOC:_INFNFE:_CHAVE\" ) &lt;&gt; \"U\"\n        cChvSF2    := oCTe:_CTEPROC:_CTE:_INFCTE:_INFCTENORM:_INFDOC:_INFNFE:_CHAVE:TEXT\n    EndIf\n    /*  \n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA\" ) &lt;&gt; \"U\"\n\n        If oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"0\"\n\n            If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ\" ) &lt;&gt; \"U\"\n                cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ:TEXT   \n            EndIf\n\n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"1\"\n            MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc) \n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"2\"\n            MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc)\n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"3\"\n\n            If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ\" ) &lt;&gt; \"U\"  \n                cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ:TEXT  \n            EndIf\n\n        EndIf       \n\n    EndIf\n    */\n\n    //|Informa\u00e7\u00f5es do destinat\u00e1rio |\n    If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA\" ) &lt;&gt; \"U\"\n\n        If oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"0\"\n\n            If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ\" ) &lt;&gt; \"U\"\n                cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ:TEXT   \n            EndIf\n\n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"1\"\n            MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc) \n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"2\"\n            MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc)\n        ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA03:_TOMA:TEXT == \"3\"\n\n            If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ\" ) &lt;&gt; \"U\"  \n                cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ:TEXT  \n            EndIf\n\n        EndIf       \n\n    Else\n\n        If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA3:_TOMA\" ) &lt;&gt; \"U\"\n\n            If oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA3:_TOMA:TEXT == \"0\"\n\n                If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ\" ) &lt;&gt; \"U\"\n                    cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_REM:_CNPJ:TEXT   \n                EndIf\n\n            ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA3:_TOMA:TEXT == \"1\"\n                MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc) \n            ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA3:_TOMA:TEXT == \"2\"\n                MsgInfo(\"Problema na importa\u00e7\u00e3o do CTE \" + cDoc)\n            ElseIf oCTe:_CTEPROC:_CTE:_INFCTE:_IDE:_TOMA3:_TOMA:TEXT == \"3\"\n\n                If Type( \"oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ\" ) &lt;&gt; \"U\"  \n                    cCnpjEmp    := oCTe:_CTEPROC:_CTE:_INFCTE:_DEST:_CNPJ:TEXT  \n                EndIf\n\n            EndIf   \n\n        EndIf   \n\n    EndIf\n\n    //|Tratamentos de seguran\u00e7a |\n    If Empty( cDoc )\n\n        cMsg    := \"------&gt; ERRO: Numero do Documento n\u00e3o preenchido &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    ElseIf Empty( cSerie )\n\n        cMsg    := \"------&gt; ERRO: Serie do Documento n\u00e3o preenchido &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    ElseIf Empty( cCNPJ )\n\n        cMsg    := \"------&gt; ERRO: CNPJ do fornecedor n\u00e3o preenchido &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    ElseIf nVlrFrete == 0\n\n        cMsg    := \"------&gt; ERRO: Valor do frete zerado &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    EndIf\n\n    dbSelectArea( \"SF1\" )\n    SF1-&gt;(dbSetOrder(1))\n\n    //|Busca o Fornecedor |\n    cAlias      := GetNextAlias()\n    If Select(cAlias) &gt; 0 \n        dbSelectArea(cAlias)\n        (cAlias)-&gt;(dbCloseArea())\n    EndIf   \n\n    BeginSql Alias cAlias\n        SELECT R_E_C_N_O_ AS REC\n        FROM   %Table:SA2% SA2\n        WHERE  A2_FILIAL = %xFilial:SA2%\n            AND A2_CGC = %Exp:cCNPJ%\n            AND A2_MSBLQL &lt;&gt; '1'\n            AND SA2.%NotDel%\n    EndSql\n\n    (cAlias)-&gt;(dbGoTop())           \n\n    If (cAlias)-&gt;(EoF())\n\n        cMsg    := \"------&gt; ERRO: NAO FOI POSSIVEL ENCONTRAR O FORNECEDOR PARA O CTE &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf       \n        Return\n\n    Else    \n        dbSelectArea(\"SA2\")\n        SA2-&gt;(dbSetOrder(1))\n        SA2-&gt;(dbGoTo((cAlias)-&gt;REC))\n        (cAlias)-&gt;(dbCloseArea())\n    EndIf\n\n    cProduto    := SFP001(cProdXML)\n    cTes        := SA2-&gt;A2_YTESCTE\n\n    If Empty(cProduto) .Or. Empty(cTes) .Or. Empty(SA2-&gt;A2_COND)\n\n        cMsg    := \"------&gt; ERRO: NAO FOI POSSIVEL ENCONTRAR O PRODUTO, TES OU CONDICAO DE PAGAMENTO PARA O CTE &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    EndIf \n\n    lMsErroAuto := .F.\n\n    //|Monta array cabecalho do CTE |\n    aCabNF := { {\"F1_TIPO\"    , \"N\"                     , NIL},;\n                {\"F1_FORMUL\"  , \"\"                      , NIL},;\n                {\"F1_ESPECIE\" , \"CTE\"                   , NIL},;\n                {\"F1_DOC\"     , cDoc                    , NIL},;\n                {\"F1_SERIE\"   , cSerie                  , NIL},;\n                {\"F1_FORNECE\" , SA2-&gt;A2_COD             , NIL},;\n                {\"F1_LOJA\"    , SA2-&gt;A2_LOJA            , NIL},;\n                {\"F1_EMISSAO\" , dDtCte                  , NIL},;\n                {\"F1_DTDIGIT\" , dDtCte                  , NIL},;\n                {\"F1_VALICM\"  , nVlrIcms                , NIL},;\n                {\"F1_CHVNFE\"  , cIdCte                  , NIL},;\n                {\"F1_YCHVSF2\" , cChvSF2                 , NIL},;\n                {\"F1_TPCTE\"   , \"N\"                     , NIL},;\n                {\"F1_VALBRUT\",  nVlrFrete               , NIL}} \n\n    dbSelectArea(\"SF4\")\n    SF4-&gt;( dbSetOrder(1) )\n\n    If SF4-&gt;( dbSeek( xFilial(\"SF4\") + cTes ) )\n\n        aDadosCfo := {}\n        aadd(aDadosCfo, {\"OPERNF\"  , \"E\"})\n        aadd(aDadosCfo, {\"TPCLIFOR\", SA2-&gt;A2_TIPO})\n        aadd(aDadosCfo, {\"UFDEST\"  , SA2-&gt;A2_EST})\n        aadd(aDadosCfo, {\"INSCR\"   , SA2-&gt;A2_INSCR})\n        aadd(aDadosCfo, {\"CONTR\"   , \"\"})\n\n        cCfop := MaFisCfo( , SF4-&gt;F4_CF, aDadosCfo )\n\n    EndIf\n\n    //|Array com o item do frete |\n    aItem := {  {\"D1_COD\"       , cProduto          ,NIL},;\n                {\"D1_QUANT\"     , 1                 ,NIL},;\n                {\"D1_VUNIT\"     , nVlrFrete         ,NIL},;\n                {\"D1_TOTAL\"     , nVlrFrete         ,NIL},;     \n                {\"D1_FORNECE\"   , SA2-&gt;A2_COD       ,NIL},;\n                {\"D1_LOJA\"      , SA2-&gt;A2_LOJA      ,NIL},;\n                {\"D1_DOC\"       , cDoc              ,NIL},;\n                {\"D1_SERIE\"     , cSerie            ,NIL},;\n                {\"D1_TES\"       , cTes              ,NIL},;\n                {\"D1_CF\"        , cCfop             ,NIL},;\n                {\"D1_LOCAL\"     , SB1-&gt;B1_LOCPAD    ,NIL},;\n                {\"D1_BASEICM\"   , nBaseIcms         ,NIL},;\n                {\"D1_PICM\"      , nAliqIcms         ,NIL},;\n                {\"D1_VALICM\"    , nVlrIcms          ,NIL},;\n                {\"D1_TIPO\"      ,\"N\"                ,NIL},;\n                {\"D1_ITEM\"      ,\"0001\"             ,Nil},;\n                {\"AUTDELETA\"    ,\"N\"                ,Nil}}\n\n    aAdd(aTotItem, aItem)\n\n    cNewFil     := \"\"\n    cOldFil     := cFilAnt\n    aAreaSM0    := SM0-&gt;(GetArea())\n\n    dbSelectArea(\"SM0\")\n    SM0-&gt;(dbSetOrder(1))\n    SM0-&gt;( dbSeek( cEmpAnt ) )\n    While !SM0-&gt;( EoF() ) .And. AllTrim(SM0-&gt;M0_CODIGO) == cEmpAnt\n\n        If AllTrim(SM0-&gt;M0_CGC) == AllTrim(cCnpjEmp)\n            cNewFil := SM0-&gt;M0_CODFIL   \n            Exit                            \n        EndIf               \n\n        SM0-&gt;(dbSkip())\n    EndDo\n    RestArea(aAreaSM0)\n\n    If Empty(cNewFil)\n\n        cMsg    := \"------&gt; ERRO: NAO FOI POSSIVEL ENCONTRAR FILIAL DE DESTINO DO CT-E &lt;------\"\n        If lJob\n            //ConOut(cMsg)\n        Else\n            MsgStop(cMsg)\n        EndIf\n        Return\n\n    EndIf\n\n    cFilAnt := cNewFil\n\n    cChvCte := cFilAnt + cDoc + Space(TamSx3(\"F1_DOC\")[1]-Len(cDoc)) + cSerie + Space(TamSx3(\"F1_SERIE\")[1]-Len(cSerie))+SA2-&gt;A2_COD+SA2-&gt;A2_LOJA\n    If !SF1-&gt;(dbSeek(cChvCte))\n\n        lGerou := .F.\n\n        //|Gera o documento de entrada classificado |\n        Begin Transaction\n\n        nModulo := 4  //Estoque\n\n        MSExecAuto({|x,y,Z| MATA103(x,y,z)},aCabNF,aTotItem,3,.F.)\n\n        If lMsErroAuto\n\n            DisarmTransaction()\n\n            If lJob\n                //ConOut(MostraErro())\n            Else\n                MostraErro()\n            EndIf\n\n        Else\n\n            cMsg    := \"-----&gt; GERADO DOCUMENTO DE ENTRADA DO FRETE COM SUCESSO &lt;-----\"\n            If lJob\n                //ConOut(cMsg)\n            Else\n                MsgInfo(cMsg)\n            EndIf\n\n            //|Altera o status para classificado |\n            RecLock(\"ZZZ\",.F.)\n            ZZZ-&gt;ZZZ_OK := \"C\"\n            ZZZ-&gt;(MsUnLock())\n\n            lGerou := .T.\n\n            //|Grava a chave de nota referenciada no CTe |\n            U_fChvOrig(oCTe,cChvCte)\n\n        EndIf\n\n        End Transaction\n        MsUnlockAll() \n\n        /*If lGerou\n            //|Preenche campo do tipo de CTE |\n            RecLock(\"SF1\",.F.)\n            SF1-&gt;F1_TPCTE := \"N\"\n            SF1-&gt;(MsUnLock())\n        EndIf */\n\n    EndIf\n\n    RestArea(aArea)\n\nReturn\n\n\n//|Fun\u00e7\u00e3o para busca o produto |\nStatic Function SFP001(cProdXML)\n\n    Local cProduto  := \"\"\n\n    dbSelectArea(\"SA5\")\n    SA5-&gt;(dbSetOrder(14))   //|FILIAL + FORNECEDOR + LOJA + CODIGO PRODUTO NO FORNECEDOR |\n    If SA5-&gt;(dbSeek(xFilial(\"SA5\") + SA2-&gt;A2_COD + SA2-&gt;A2_LOJA + cProdXML))\n\n        dbSelectArea(\"SB1\")\n        SB1-&gt;(dbSetOrder(1)) \n        SB1-&gt;(dbSeek(xFilial(\"SB1\") + SA5-&gt;A5_PRODUTO))\n\n        cProduto    := SB1-&gt;B1_COD\n\n    EndIf\n\n    If Empty(cProduto)\n        cProduto := \"DA.3127.20.001                \"\n    EndIf\n\nReturn cProduto\n\n\n\nUser Function Forcado()\n\n    Local aTotItem := {}\n    Local aCabNF := {}\n    Local aItem := {}\n\n    lMsErroAuto := .F.\n\n    dbSelectArea(\"SA2\")\n    SA2-&gt;(dbSetOrder(1))\n    SA2-&gt;(dbSeek(xFilial(\"SA2\") + \"00029901\"))\n\n    //|Monta array cabecalho do CTE |\n    aCabNF := { {\"F1_TIPO\"    , \"N\"                     , NIL},;\n                {\"F1_FORMUL\"  , \"\"                      , NIL},;\n                {\"F1_ESPECIE\" , \"CTE\"                   , NIL},;\n                {\"F1_DOC\"     , \"998999\"                    , NIL},;\n                {\"F1_SERIE\"   , \"1\"                     , NIL},;\n                {\"F1_FORNECE\" , SA2-&gt;A2_COD             , NIL},;\n                {\"F1_LOJA\"    , SA2-&gt;A2_LOJA            , NIL},;\n                {\"F1_EMISSAO\" , dDataBase                   , NIL},;\n                {\"F1_DTDIGIT\" , dDataBase                   , NIL},;\n                {\"F1_VALICM\"  , 0               , NIL},;\n                {\"F1_CHVNFE\"  , \"32170401125797001198570120001917711168219529\"                  , NIL},;\n                {\"F1_TPCTE\" , \"N\"                   , NIL},;\n                {\"F1_VALBRUT\",  100                 , NIL}} \n\n    cCodTES := \"001\"\n\n    dbSelectArea(\"SF4\")\n    SF4-&gt;(dbSetOrder(1))\n    SF4-&gt;(dbSeek(xFilial(\"SF4\") + cCodTES))\n\n    //|Array com o item do frete |\n    aItem := {  {\"D1_COD\"       , \"500021         \"         ,NIL},;\n                {\"D1_QUANT\"     , 1                 ,NIL},;\n                {\"D1_VUNIT\"     , 100       ,NIL},;\n                {\"D1_TOTAL\"     , 100           ,NIL},;     \n                {\"D1_FORNECE\"   , SA2-&gt;A2_COD       ,NIL},;\n                {\"D1_LOJA\"      , SA2-&gt;A2_LOJA      ,NIL},;\n                {\"D1_DOC\"       , \"998899\"              ,NIL},;\n                {\"D1_SERIE\"     , \"1\"           ,NIL},;\n                {\"D1_TES\"       , cCodTES           ,NIL},;\n                {\"D1_CF\"       , SF4-&gt;F4_CF             ,NIL},;\n                {\"D1_LOCAL\"     , \"01\"      ,NIL},;\n                {\"D1_BASEICM\"   , 0         ,NIL},;\n                {\"D1_PICM\"      , 0         ,NIL},;\n                {\"D1_VALICM\"    , 0         ,NIL},;\n                {\"D1_TIPO\"      ,\"N\"                ,NIL},;\n                {\"D1_ITEM\"      ,\"0001\"             ,Nil},;\n                {\"AUTDELETA\"    ,\"N\"                ,Nil}}\n\n    aAdd(aTotItem, aItem)\n\n        //|Gera o documento de entrada classificado |\n        Begin Transaction\n\n        nModulo := 4  //Estoque\n\n        MSExecAuto({|x,y,Z| MATA103(x,y,z)},aCabNF,aTotItem,3,.F.)\n\n        If lMsErroAuto\n            DisarmTransaction()\n            //ConOut(MostraErro())\n        Else\n            Alert(\"FOIIII\")\n        EndIf\n\n        End Transaction \n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptclifor","title":"PTCLIFOR","text":"<p>Ponto de entrada para retornar o cliente/fornecedor a ser utilizado.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Array com C\u00f3digo, Loja e UF do cliente/fornecedor.</li> <li>ParamIxb[2]: CGC do cliente/fornecedor.</li> <li>ParamIxb[3]: Tabela que foi utilizada para pesquisar o cliente/fornecedor.</li> <li>ParamIxb[4]: Objeto com o XML a ser utilizado.</li> </ul> <p>Retorno:</p> <ul> <li>aCliFor: array, c\u00f3digo/loja/UF do cliente/fornecedor.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTCLIFOR()\n\n  Local aCliFor     := ParamIxb[1]\n  Local cCgc          := ParamIxb[2]\n  Local cTipo         := ParamIxb[3]\n  Local oObj          := ParamIxb[4]\n    Local cQuery        := \"\"\n    Local cInscEst  := \"\"\n    Local cAlias        := \"__TBA1\"\n\n    If Select(cAlias) &gt; 0\n        (cAlias)-&gt;(dbCloseArea())\n    EndIf\n\n  If ZZZ-&gt;ZZZ_TIPO == \"1\" .And. Valtype(oObj) == \"O\"\n\n    cInscEst  := IIf( XmlChildEx( oObj:_InfNfe:_EMIT, \"_IE\") != Nil, oObj:_InfNfe:_EMIT:_IE:TEXT, \"\" )\n\n\n    If cTipo == \"SA1\"\n      cQuery += \" SELECT A1_CGC AS CGC,A1_MSBLQL AS BLOQUEIO,A1_COD AS CODIGO,A1_LOJA AS LOJA,A1_NOME AS NOME, A1_EST AS UF \"\n      cQuery += \" FROM \" + RetSqlName(\"SA1\") + \" SA1 \"\n      cQuery += \" WHERE SA1.A1_FILIAL = \" + ValToSql( xFilial(\"SA1\") )\n      cQuery += \"   AND SA1.A1_CGC = \" + ValToSql( cCgc )\n\n      If !Empty(cInscEst)\n        cQuery += \"     AND SA1.A1_INSCR = \" + ValToSql(cInscEst)\n      EndIf\n\n      cQuery += \"   AND SA1.D_E_L_E_T_ = ' ' \"\n    Else\n      cQuery += \" SELECT A2_CGC AS CGC,A2_MSBLQL AS BLOQUEIO,A2_COD AS CODIGO,A2_LOJA AS LOJA,A2_NOME AS NOME, A2_EST AS UF  \"\n      cQuery += \" FROM \" + RetSqlName(\"SA2\") + \" SA2 \"\n      cQuery += \" WHERE SA2.A2_FILIAL = \" + ValToSql( xFilial(\"SA2\") )\n      cQuery += \"   AND SA2.A2_CGC = \" + ValToSql( cCgc )\n\n      If !Empty(cInscEst)\n        cQuery += \"     AND SA2.A2_INSCR = \" + ValToSql(cInscEst)\n      EndIf\n\n      cQuery += \"   AND SA2.D_E_L_E_T_ = ' ' \"\n    EndIf\n\n    cQuery := ChangeQuery(cQuery)\n    dbUseArea(.T.,\"TOPCONN\",TCGenQry(,,cQuery),cAlias,.T.,.T.)\n\n    dbSelectArea(cAlias)\n    (cAlias)-&gt;(dbGoTop())\n\n    //|Alimenta array com as informacoes |\n    While !(cAlias)-&gt;( EoF() )\n\n      If (cAlias)-&gt;BLOQUEIO != \"1\"\n\n        aCliFor[1, 1]   := (cAlias)-&gt;CODIGO\n        aCliFor[1, 2]   := (cAlias)-&gt;LOJA\n        aCliFor[1, 3]   := (cAlias)-&gt;UF\n\n        Exit\n\n      EndIf\n\n      (cAlias)-&gt;( dbSkip() )\n\n    EndDo\n\n    If Select(cAlias) &gt; 0\n      (cAlias)-&gt;(dbCloseArea())\n    EndIf\n\n  EndIf\n\n  /*\n  aCliFor[1, 1] := C\u00f3digo cliente/fornecedor\n  aCliFor[1, 2] := Loja cliente/fornecedor\n  aCliFor[1, 3] := UF cliente/fornecedor\n  */\n\nReturn aCliFor\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptctedad","title":"PTCTEDAD","text":"<p>Ponto de entrada para manipular o objeto com os dados do CTE importados do XML.</p> <p>Dever\u00e1 retornar o objeto recebido no ParamIxb[1] na mesma estrutura que foi recebido.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Objeto do CTE tratado e estruturado pela Ferramenta.</li> <li>ParamIxb[2]: Objeto do XML do CTE.</li> </ul> <p>Retorno:</p> <ul> <li>oObj: object, Objeto do CTE com os dados a serem processados.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTCTEDAD()\n\n  Local oObj            := ParamIxb[1]\n  // Local oXml       := ParamIxb[2]  //|XML do CTE em formato objeto |\n  Local aArea           := GetArea()\n  Local lImportaAuto    := .T.\n\n  If oObj:lCteVenda\n\n    //|Possui chave vinculada |\n    If Len(oObj:aChavesVinculadas) &gt; 0\n\n      If fIgnoraPorCFOP(oObj)\n\n        lImportaAuto  := .F.\n\n      Else\n\n        oObj:cItemContabil  := \"999\"\n\n        //|Grupo do produto deve utilizar o da NF de sa\u00edda referenciada |\n        oObj:cGrupoProduto  := fBuscaGrupoProduto(oObj)\n\n        //|Atualiza o centro de custo de acordo com o grupo do produto da NF de sa\u00edda referenciada |\n        oObj:cCentroCusto   := fBuscaCentroCusto(oObj)\n\n        //|Conta Contabil |\n        oObj:cContaContabil := fBuscaContaContabil(oObj)\n\n      EndIf\n\n    Else\n\n      lImportaAuto  := .F.\n\n    EndIf\n\n    If !lImportaAuto\n\n      //|Limpar a variavel cCondPagamento quando quiser for\u00e7ar a entrada via tela |\n      oObj:cCondPagamento := \"\"\n\n    EndIf\n\n  EndIf\n\n  RestArea(aArea)\n\nReturn oObj\n\n\nStatic Function fBuscaGrupoProduto(oObj)\n\n  Local cQuery := \"\"\n  Local cGrupo := \"\"\n\n  cQuery += \" SELECT TOP 1 B1_GRUPO \"\n  cQuery += \" FROM \" + RetSqlName(\"SF2\") + \" SF2 \"\n  cQuery += \" JOIN \" + RetSqlName(\"SD2\") + \" SD2 \"\n  cQuery += \"   ON D2_FILIAL = F2_FILIAL \"\n  cQuery += \"   AND D2_DOC = F2_DOC \"\n  cQuery += \"   AND D2_SERIE = F2_SERIE \"\n  cQuery += \"   AND D2_CLIENTE = F2_CLIENTE \"\n  cQuery += \"   AND D2_LOJA = F2_LOJA \"\n  cQuery += \"   AND SD2.D_E_L_E_T_ = '' \"\n  cQuery += \" JOIN \" + RetSqlName(\"SB1\") + \" SB1 \"\n  cQuery += \"   ON B1_FILIAL = \" + ValToSql( xFilial(\"SB1\") )\n  cQuery += \"   AND B1_COD = D2_COD \"\n  cQuery += \"   AND SB1.D_E_L_E_T_ = '' \"\n  cQuery += \" WHERE F2_FILIAL = \" + ValToSql( oObj:cCodigoFilial )\n  cQuery += \" AND F2_CHVNFE = \" + ValToSql( oObj:aChavesVinculadas[1] )\n  cQuery += \" AND SF2.D_E_L_E_T_ = '' \"\n\n  If Select(\"__GRP\") &gt; 0\n    __GRP-&gt;( dbCloseArea() )\n  EndIf\n\n  TcQuery cQuery New Alias \"__GRP\"\n\n  __GRP-&gt;( dbGoTop() )\n\n  If !__GRP-&gt;( EoF() )\n    cGrupo  := __GRP-&gt;B1_GRUPO\n  EndIf\n\nReturn cGrupo\n\n\nStatic Function fIgnoraPorCFOP(oObj)\n\n  Local cQuery      := \"\"\n  Local lExisteCfop := .F.\n  Local cCFOPs      := \"5915,6915,5901,6901,5949,6949\"\n\n  cQuery += \" SELECT TOP 1 F2_DOC \"\n  cQuery += \" FROM \" + RetSqlName(\"SF2\") + \" SF2 \"\n  cQuery += \" JOIN \" + RetSqlName(\"SD2\") + \" SD2 \"\n  cQuery += \"   ON D2_FILIAL = F2_FILIAL \"\n  cQuery += \"   AND D2_DOC = F2_DOC \"\n  cQuery += \"   AND D2_SERIE = F2_SERIE \"\n  cQuery += \"   AND D2_CLIENTE = F2_CLIENTE \"\n  cQuery += \"   AND D2_LOJA = F2_LOJA \"\n  cQuery += \"   AND SD2.D_E_L_E_T_ = '' \"\n  cQuery += \" WHERE F2_FILIAL = \" + ValToSql( oObj:cCodigoFilial )\n  cQuery += \" AND F2_CHVNFE = \" + ValToSql( oObj:aChavesVinculadas[1] )\n  cQuery += \" AND D2_CF IN \" + FormatIN( cCFOPs, \",\" )\n  cQuery += \" AND SF2.D_E_L_E_T_ = '' \"\n\n  If Select(\"__GRP\") &gt; 0\n    __GRP-&gt;( dbCloseArea() )\n  EndIf\n\n  TcQuery cQuery New Alias \"__GRP\"\n\n  __GRP-&gt;( dbGoTop() )\n\n  If !__GRP-&gt;( EoF() )\n    lExisteCfop  := .T.\n  EndIf\n\nReturn lExisteCfop\n\n\nStatic Function fBuscaContaContabil(oObj)\n\n  Local cContaContabil := oObj:cContaContabil\n\n  //|Busca Natureza |\n  oObj:cNatureza  := fBuscaNatureza(oObj)\n\n  If !Empty( oObj:cNatureza )\n\n    cContaContabil  := Posicione( \"SED\", 1, xFilial(\"SED\") + oObj:cNatureza, \"SED-&gt;ED_DEBITO\" )\n\n  EndIf\n\nReturn cContaContabil\n\n\nStatic Function fBuscaNatureza(oObj)\n\n  Local cEmpProc      := \"\" as Character\n  Local cFilProc      := \"\" as Character\n  Local cTipoDcto     := \"\" as Character\n  Local cCodProduto   := \"\" as Character\n  Local cGrupoProduto := \"\" as Character\n  Local cClieFor      := \"\" as Character\n  Local cLoja         := \"\" as Character\n  Local cCstIcms      := \"\" as Character\n  Local cUF           := \"\" as Character\n  Local cCfop         := \"\" as Character\n  Local cTribProd     := \"\" as Character\n  Local cTribCliFor   := \"\" as Character\n  Local cTipoCliFor   := \"\" as Character\n  Local cTemIcms      := \"\" as Character\n  Local cTipoProd     := \"\" as Character\n  Local cResposta     := \"\" as Character\n\n  cEmpProc      := oObj:cCodigoEmpresa\n  cFilProc      := oObj:cCodigoFilial\n  cTipoDcto     := IIf( oObj:lCteVenda, \"CTEV\", \"CTEC\" )\n  cClieFor      := oObj:cCodigoFornecCliente\n  cLoja         := oObj:cLojaFornecCliente\n  cUF           := oObj:cUF_FornecCliente\n  cTribCliFor   := oObj:cTrib_FornecCliente\n  cTipoCliFor   := oObj:cTipo_FornecCliente\n\n  cCodProduto   := oObj:cCodigoProduto\n  cGrupoProduto := oObj:cGrupoProduto\n  cTribProd     := oObj:cGrupoTribProd\n  cTipoProd     := oObj:cTipoProduto\n  cTemIcms      := IIf( oObj:nValorIcms &gt; 0, \"S\", \"N\" )\n  cCstIcms      := oObj:cCstIcms\n  cCfop         := oObj:cCfop\n\n  cResposta := U_PTXRegraProcesso(cEmpProc,cFilProc,cTipoDcto,\"NATU\",cCodProduto,cGrupoProduto,cClieFor,cLoja,cCstIcms,cUF,cCfop,cTribProd,cTribCliFor,cTipoCliFor,cTemIcms,cTipoProd)\n\nReturn cResposta\n\n\n\nStatic Function fBuscaCentroCusto(oObj)\n\n  Local cEmpProc      := \"\" as Character\n  Local cFilProc      := \"\" as Character\n  Local cTipoDcto     := \"\" as Character\n  Local cCodProduto   := \"\" as Character\n  Local cGrupoProduto := \"\" as Character\n  Local cClieFor      := \"\" as Character\n  Local cLoja         := \"\" as Character\n  Local cCstIcms      := \"\" as Character\n  Local cUF           := \"\" as Character\n  Local cCfop         := \"\" as Character\n  Local cTribProd     := \"\" as Character\n  Local cTribCliFor   := \"\" as Character\n  Local cTipoCliFor   := \"\" as Character\n  Local cTemIcms      := \"\" as Character\n  Local cTipoProd     := \"\" as Character\n  Local cResposta     := \"\" as Character\n\n  cEmpProc      := oObj:cCodigoEmpresa\n  cFilProc      := oObj:cCodigoFilial\n  cTipoDcto     := IIf( oObj:lCteVenda, \"CTEV\", \"CTEC\" )\n  cClieFor      := oObj:cCodigoFornecCliente\n  cLoja         := oObj:cLojaFornecCliente\n  cUF           := oObj:cUF_FornecCliente\n  cTribCliFor   := oObj:cTrib_FornecCliente\n  cTipoCliFor   := oObj:cTipo_FornecCliente\n\n  cCodProduto   := oObj:cCodigoProduto\n  cGrupoProduto := oObj:cGrupoProduto\n  cTribProd     := oObj:cGrupoTribProd\n  cTipoProd     := oObj:cTipoProduto\n  cTemIcms      := IIf( oObj:nValorIcms &gt; 0, \"S\", \"N\" )\n  cCstIcms      := oObj:cCstIcms\n  cCfop         := oObj:cCfop\n\n  cResposta := U_PTXRegraProcesso(cEmpProc,cFilProc,cTipoDcto,\"CCUS\",cCodProduto,cGrupoProduto,cClieFor,cLoja,cCstIcms,cUF,cCfop,cTribProd,cTribCliFor,cTipoCliFor,cTemIcms,cTipoProd)\n\nReturn cResposta\n\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptx01fil","title":"PTX01FIL","text":"<p>Ponto de entrada para filtrar o browse da Central XML-e (tabela ZZZ).</p> <p>Retorno:</p> <ul> <li>cFiltro: character, express\u00e3o SQL de filtro da ZZZ.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTX01FIL()\n\n  Local cFiltro    as Character\n  Local cUsersNFSe as Character\n\n  cUsersNFSe  := SuperGetMV(\"MV_YUSRNFS\", .F., \"\")\n\n  If !Empty(cUsersNFSe) .And. !AllTrim(__cUserID) $ cUsersNFSe\n    cFiltro := \" ZZZ_TIPO &lt;&gt; '3' \"\n  EndIf\n\nReturn cFiltro\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptx0001mnu","title":"PTX0001MNU","text":"<p>Ponto de entrada para inserir op\u00e7\u00f5es no menu da rotina XML-e.</p> <p>Retorno:</p> <ul> <li>aRet: array, array com os menus personalizados.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTX0001MNU()\n\n    Local aRet    := {}\n    Local aBotoes := {}\n\n    //|Adiciona os bot\u00f5es customizados |\n    aAdd(aBotoes, {\"Bot\u00e3o 01\", \"Alert('Bot\u00e3o 01')\", 0, 1, 0, Nil})\n    aAdd(aBotoes, {\"Bot\u00e3o 02\", \"Alert('Bot\u00e3o 02')\", 0, 1, 0, Nil})\n\n    //Retorno pra rotina\n    aAdd(aRet, \"# Personalizados\")\n    aAdd(aRet, aBotoes)\n    aAdd(aRet, 0)\n    aAdd(aRet, 1)\n    aAdd(aRet, 0)\n    aAdd(aRet, nil)\n\nReturn aRet\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptxf1doc","title":"PTXF1DOC","text":"<p>Ponto de entrada para customizar o F1_DOC.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Numero do documento fiscal processado.</li> <li>ParamIxb[2]: Objeto do documento fiscal (se for nfe, \u00e9 o XML em forma de objeto).</li> <li>ParamIxb[3]: Indica que se trata de uma NFe.</li> </ul> <p>Retorno:</p> <ul> <li>cRetorno: character, valor do F1_DOC a ser retornado.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTXF1DOC()\n\n  Local cNumeroDoc  := ParamIxb[1]  //|Numero do documento fiscal processado |\n  Local oObj        := ParamIxb[2]  //|Objeto do documento fiscal (se for nfe, \u00e9 o XML em forma de objeto) |\n  Local lNFe        := ParamIxb[3]  //|Indica que se trata de uma NFe |\n  Local cRetorno    := cNumeroDoc   //|Valor do F1_DOC a ser retornado |\n\n  If lNFe .And. ValType(oObj) == \"O\"\n\n    //|PERSONALIZE O cRetorno CONFORME SUA REGRA |\n\n  EndIf\n\nReturn cRetorno\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#ptxf1ser","title":"PTXF1SER","text":"<p>Ponto de entrada para customizar o F1_SERIE.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Serie do documento fiscal processado.</li> <li>ParamIxb[2]: Objeto do documento fiscal (se for nfe, \u00e9 o XML em forma de objeto).</li> <li>ParamIxb[3]: Indica que se trata de uma NFe.</li> </ul> <p>Retorno:</p> <ul> <li>cRetorno: character, valor do F1_SERIE a ser retornado.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PTXF1SER()\n\n  Local cSerieDoc   := ParamIxb[1]  //|Serie do documento fiscal processado |\n  Local oObj        := ParamIxb[2]  //|Objeto do documento fiscal (se for nfe, \u00e9 o XML em forma de objeto) |\n  Local cTipoDoc    := ParamIxb[3]  //|Indica que se trata de uma NFe |\n  Local cRetorno    := cSerieDoc   //|Valor do F1_SERIE a ser retornado |\n  Local cCnpjFornec := \"\"\n\n  If cTipoDoc == \"NFE\" .And. ValType(oObj) == \"O\"\n\n    //|PERSONALIZE O cRetorno CONFORME SUA REGRA |\n    IIf(XmlChildEx(oObj:_INFNFE:_EMIT, \"_CNPJ\") &lt;&gt; Nil, cCnpjFornec := oObj:_INFNFE:_EMIT:_CNPJ:TEXT, '')\n\n    If Empty(cCnpjFornec)\n      IIf(XmlChildEx(oObj:_INFNFE:_EMIT, \"_CPF\") &lt;&gt; Nil, cCnpjFornec := oObj:_INFNFE:_EMIT:_CPF:TEXT, '')\n    EndIf\n\n    //|Verifica se \u00e9 filial |\n    If SubStr( cCnpjFornec, 1, 8 ) == SubStr( SM0-&gt;M0_CGC, 1, 8 )\n\n      //|Muda a s\u00e9rie para 2 digitos |\n      cRetorno := StrZero( Val(cRetorno), 2 )\n\n    EndIf\n\n  EndIf\n\nReturn cRetorno\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#px011cte","title":"PX011CTE","text":"<p>Ponto de entrada para alterar informa\u00e7\u00f5es ap\u00f3s a importa\u00e7\u00e3o do CTE.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Chave do \u00edndice utilizado no banco de dados para localizar o CTE.</li> <li>ParamIxb[2]: Objeto do XML do CTE.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PX011CTE()\n\n    Local cSeekSF1  := ParamIxb[1]\n\n    Private oXMLCTE := ParamIxb[2]\n\n    //|Grava a chave de nota referenciada no CTe |\n    U_fChvOrig(oXMLCTE,cSeekSF1)\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#px041vld","title":"PX041VLD","text":"<p>Ponto de entrada que verifica se o CTE pode manifestar desacordo.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Chave do CTE.</li> <li>ParamIxb[2]: Status do CTE na ferramenta. Referente ao campo ZZZ_OK.</li> </ul> <p>Retorno:</p> <ul> <li>lValido: logical, retorna se deve seguir com o processo de manifesta\u00e7\u00e3o de desacordo.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function PX041VLD()\n\n    Local cChave   := Paramixb[1]\n    Local cStatus  := Paramixb[2]\n    Local cMsgErro := \"\"\n    Local lValido  := .T.\n\n    If AllTrim(cStatus) $ \"C/P\"\n\n        cMsgErro := \"N\u00e3o \u00e9 poss\u00edvel manifestar desacordo pois esse documento possui entrada.\" + CR\n        lValido  := .F.\n\n        MsgStop(cMsgErro)\n\n    Endif\n\nReturn lValido\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#savezzz","title":"SAVEZZZ","text":"<p>Ponto de entrada para manipular a ZZZ ap\u00f3s grava\u00e7\u00e3o. Nesse momento a ZZZ j\u00e1 est\u00e1 gravada e ap\u00f3s o MsUnLock.</p> <p>Par\u00e2metros:</p> <ul> <li>ParamIxb[1]: Vari\u00e1vel l\u00f3gica para identificar se o documento \u00e9 novo (.F.) e est\u00e1 sendo salvo pela primeira vez ou se \u00e9 uma altera\u00e7\u00e3o de status no documento j\u00e1\u00a0gravado\u00a0(.T.).</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function SAVEZZZ()\n\n    Local cTipoDocumento := \"\"\n    Local cError         := \"\"\n    Local cTipoCTE           := \"\"\n    Local oError         := Nil\n  Local bError         := ErrorBlock({|oError| cError := oError:Description})\n\n    Begin Sequence\n\n    If !Empty(ZZZ-&gt;ZZZ_XML) //|Em alguns casos (NF-e resumida) o XML chega depois |\n\n        If AllTrim(ZZZ-&gt;ZZZ_TIPO) == \"2\" .And. ZZZ-&gt;ZZZ_SITDOC == \"1\"   //|CT-E autorizado |\n\n            cTipoDocumento := U_PTXTipoDocumento()\n\n            cTipoCTE    := SuperGetMV(\"MC_YTPCTE\", .F., \"CTEV/CTEC\")\n\n            If cTipoDocumento $ cTipoCTE    //|CTEV = CTE de Venda / CTEC = CTE de compra |\n\n                //|Grava o XML em arquivo |\n                Exporta_XML_Disco(cTipoDocumento)\n\n            EndIf\n\n        EndIf\n\n    EndIf\n\n    End Sequence\n\n  ErrorBlock(bError)\n\n  If !Empty(cError)\n    ConOut( \"### ERRO PONTO DE ENTRADA SAVEZZZ \" + CRLF + CRLF + cError )\n  EndIf\n\nReturn\n\n\n\nStatic Function Exporta_XML_Disco(cTipoDocumento)\n\n    Local cDiretorio   as Character\n    Local cNomeArquivo as Character\n\n    cDiretorio  := SuperGetMV( \"MC_YXMLDIR\", .F., \"\\facile\\cte\\\" )\n\n    If !Empty( cDiretorio )\n\n        If Right(cDiretorio,1) != \"\\\"\n            cDiretorio += \"\\\"\n        EndIf\n\n        If !ExistDir(cDiretorio)\n            FWMakeDir( cDiretorio )\n        EndIf\n\n        cNomeArquivo    := AllTrim(ZZZ-&gt;ZZZ_CHAVE) + \"-\" + \"prot\" + cTipoDocumento + \".xml\"\n\n        If File( cDiretorio + cNomeArquivo )\n            fErase(cDiretorio + cNomeArquivo)\n        EndIf\n\n        nHandle  := FCreate( cDiretorio + cNomeArquivo )\n\n        If nHandle &gt; 0\n\n            FWrite( nHandle, AllTrim(ZZZ-&gt;ZZZ_XML) )\n            FClose(nHandle)\n\n        EndIf\n\n    Else\n\n        ConOut( \"FACILE - PE SAVEZZZ -&gt; Parametro MC_YXMLDIR nao existe ou esta vazio, nao foi possivel salvar o XML no disco\" )\n\n    EndIf\n\nReturn\n</code></pre>"},{"location":"xmle/manuais/peferramenta/#xcarregdados","title":"XCarregDados","text":"<p>Ponto de entrada para manipular valores antes de salvar a ZZZ.</p> <p>Retorno:</p> <ul> <li>oDados: object, Objeto com os dados a serem salvos na ZZZ.</li> </ul> <p>Segue exemplo de utiliza\u00e7\u00e3o.</p> <pre><code>User Function XCarregDados()\n\n  Local oDados   := ParamIxb[1] as Object\n  Local cFilNova := \"\"          as Character\n\n  If !Empty(oDados:cIEDestinatario) .And. oDados:cCodigoFilial == \"AAPES001\"  //|S\u00f3 processa na filial 1 |\n\n    //|C\u00f3digo para identificar a filial onde vai salvar o XML |\n    // bla bla bla\n    // bla bla bla\n    // bla bla bla\n\n    cFilNova := \"AAPES002\"\n\n    oDados:cCodigoFilial := cFilNova\n\n  EndIf\n\nReturn oDados\n</code></pre>"},{"location":"xmle/manuais/prenota-checkdoc/","title":"15 - Gerar Pr\u00e9-Nota de Entrada com o Checkdoc","text":""},{"location":"xmle/manuais/prenota-checkdoc/#checkdoc-gerar-pre-nota-de-entrada","title":"Checkdoc \u2013 Gerar Pr\u00e9 Nota de Entrada","text":""},{"location":"xmle/manuais/prenota-checkdoc/#resumo-dos-servicos-resultado-esperado","title":"Resumo dos servi\u00e7os / Resultado esperado","text":"<ol> <li>Gerar pr\u00e9-nota automaticamente se n\u00e3o houver diverg\u00eancia na avalia\u00e7\u00e3o do Checkdoc</li> <li>Criar par\u00e2metro para ativar/desativar a funcionalidade</li> </ol>"},{"location":"xmle/manuais/prenota-checkdoc/#detalhamento-dos-servicos-observacoes","title":"Detalhamento dos Servi\u00e7os / Observa\u00e7\u00f5es","text":"<ol> <li>Atividades inclu\u00eddas<ul> <li>Automa\u00e7\u00e3o e agilidade na inclus\u00e3o das pr\u00e9-notas</li> </ul> </li> </ol>"},{"location":"xmle/manuais/prenota-checkdoc/#informacoes-tecnicas-relevantes","title":"Informa\u00e7\u00f5es t\u00e9cnicas / Relevantes","text":"<ol> <li>Par\u00e2metros envolvidos na adequa\u00e7\u00e3o:<ul> <li>ZZ_CHKNOTA: Par\u00e2metro l\u00f3gico informando se a gera\u00e7\u00e3o autom\u00e1tica da pr\u00e9-nota pelo CheckDoc est\u00e1 ativa.     Exemplo: .T.</li> </ul> </li> </ol>"},{"location":"xmle/manuais/prenota-checkdoc/#passo-a-passo","title":"Passo a passo","text":"<p>A aplica\u00e7\u00e3o do patch com a melhoria e a cria\u00e7\u00e3o do par\u00e2metro com o valor \u201c.T.\u201d s\u00e3o suficientes para ativar a nova funcionalidade.</p> <p>Sempre que o CheckDoc verificar o XML e n\u00e3o encontrar diverg\u00eancias, ser\u00e1 gerado a pr\u00e9-nota automaticamente via JOB.</p>"},{"location":"xmle/manuais/produtoxforn/","title":"Segunda Unidade de Medida da Amarra\u00e7\u00e3o Produto x Fornecedor","text":"<p>A amarra\u00e7\u00e3o Produto x Fornecedor da Central XML-e tr\u00e1s uma abrang\u00eancia maior daquela que j\u00e1 existe no Protheus. Existem duas formas de acess\u00e1-la, atualmente. A primeira via menu, e a segunda na tela de \"Gerar entrada\" da Central XML-e ao clicar em \"Alterar\" no grid do meio.</p> <p> Figura 1: Menu com a op\u00e7\u00e3o \"Produto x Fornecedor\"</p> <p> Figura 2: Bot\u00e3o de alterar cadastro Produto x Fornecedor da Central XML</p> <p> Figura 3: Tela Amarra\u00e7\u00e3o Produto x Fornecedor</p> <p>Na pr\u00f3pria inclus\u00e3o, percebe-se que n\u00e3o existe limita\u00e7\u00e3o por quantidade de produtos que possam existir para cada fornecedor, assim como o mesmo produto pode estar amarrado a diferentes fornecedores.</p> <p> Figura 4: Fornecedor com v\u00e1rios produtos</p> <p>No campo, \"Seg.Uni.Med\" podemos selecionar uma segunda unidade de medida, ao seu lado, o fator de convers\u00e3o no campo \"Fator. Conv,\" e o Tipo da convers\u00e3o.</p> <p> Figura 5: Grid com destaque na convers\u00e3o</p> <p>Para a segunda unidade de medida, precisamos dizer o fator de convers\u00e3o e seu tipo. Por exemplo, o Produto 000001 tem como unidade de medida PC (Pe\u00e7a), mas caso ele entre em G (gramas) no sistema, precisamos fazer convers\u00e3o, onde cada pe\u00e7a tem 2 gramas.</p> <p>Nesse caso, selecionar o tipo de convers\u00e3o como divisor, e, para cada 2 gramas de arruela, ele faria a convers\u00e3o para 1 pe\u00e7a. Sendo assim, caso entremos com 40 gramas de arruela, o sistema automaticamente iria converter a entrada para 20 pe\u00e7as de arruela.</p> -FIM-"},{"location":"xmle/manuais/regras-classi/","title":"17 - Regras por Processo","text":""},{"location":"xmle/manuais/regras-classi/#regras-por-processo","title":"Regras por Processo","text":""},{"location":"xmle/manuais/regras-classi/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>Rotina \u201cRegras por Processo\u201d \u00e9 o cadastro de regras da ferramenta Facile XML-e que ser\u00e3o utilizadas para retornar de maneira inteligente qual ser\u00e1 a informa\u00e7\u00e3o mais apropriada a ser utilizada em cada tipo de documento e processo.</p>"},{"location":"xmle/manuais/regras-classi/#como-usar","title":"Como usar?","text":"<p>Dever\u00e1 ser cadastrado todas as regras de filtros inteligentes para o retorno das informa\u00e7\u00f5es necess\u00e1rias para classifica\u00e7\u00e3o do documento fiscal (TES, condi\u00e7\u00e3o de pagamento, centro de custo, natureza e produto).</p> <p>Implementar o novo JOB respons\u00e1vel por executar as importa\u00e7\u00f5es autom\u00e1ticas atrav\u00e9s das regras por processo.</p> <p>Programa: U_PTXJ007</p> <p>Exemplo via appserver.ini:</p> <pre><code>[PTXJ007]\nMAIN=U_PTXJ007\nENVIRONMENT=ENVIRONMENT\nnparms=2\nParm1=01\nParm2=01\n\n[ONSTART]\nJOBS=PTXJ007\n</code></pre>"},{"location":"xmle/manuais/regras-classi/#processos-implementados-liberados-ate-o-momento","title":"Processos implementados / liberados at\u00e9 o momento","text":"<ul> <li> <p>CTEV \u2013 CTE de Venda</p> <ul> <li>Ativado atrav\u00e9s do par\u00e2metro: ZZ_CTEVAUT = .T. (dever\u00e1 ser criado com tipo l\u00f3gico)</li> </ul> </li> <li> <p>CTEC \u2013 CTE de Compra</p> <ul> <li>Ativado atrav\u00e9s do par\u00e2metro: ZZ_CTECAUT = .T. (dever\u00e1 ser criado com tipo l\u00f3gico)</li> </ul> </li> <li> <p>NFSE \u2013 Nota Fiscal de Servi\u00e7o</p> <ul> <li>Ativado atrav\u00e9s do par\u00e2metro: ZZ_NFSEAUT = .T. (dever\u00e1 ser criado com tipo l\u00f3gico)</li> </ul> </li> </ul>"},{"location":"xmle/manuais/regras-classi/#tabela-de-regras-por-processo","title":"Tabela de Regras por Processo","text":"<p>Segue abaixo os campos e detalhes sobre o preenchimento:</p> Campo Descri\u00e7\u00e3o Observa\u00e7\u00e3o X001EMP Empresa C\u00f3digo da empresa caso a regra seja exclusiva de determinada empresa X001FILIAL Filial C\u00f3digo da filial caso a regra seja exclusiva de determinada filial X001TIPDOC Tipo Docto. S\u00e3o os tipos de documentos poss\u00edveis de automatiza\u00e7\u00e3o: CTE Venda, NF-e de Compras, CTE de Compras, Devolu\u00e7\u00e3o de Venda e NFS-e X001PROCES Processo S\u00e3o os atributos que ser\u00e3o encontrados de forma autom\u00e1tica para cada processo de acordo com as regras: Condi\u00e7\u00e3o de pagamento, TES, Centro de custo, Natureza e Produto. X001PRODUT Cod. Produto Regra deve seja exclusiva para determinado produto (B1_COD) X001GRPPRO Grupo Produto Regra deve seja exclusiva para determinado grupo de produto (B1_GRUPO) X001TRBPRO Grp. Tr. Prod. Regra deve seja exclusiva para determinado grupo de tributa\u00e7\u00e3o do produto (B1_GRTRIB) X001CLIFOR Clien. / Fornec. Regra deve seja exclusiva para determinado cliente/fornecedor (A1_COD/A2_COD) X001LOJA Loja Regra deve seja exclusiva para determinada loja do cliente/fornecedor (A1_LOJA/A2_LOJA) X001TRCLFO Gr. T. Cli. / For. Regra deve seja exclusiva para determinado grupo de tributa\u00e7\u00e3o de cliente/fornecedor (A2_GRPTRIB/A1_GRPTRIB) X001TPCLFO Tipo Cli. / For. Regra deve seja exclusiva para determinado tipo de cliente/fornecedor (F7_TIPOCLI) X001UF UF Clie. For. Regra deve seja exclusiva para determinado estado do cliente/fornecedor (A1_EST/A2_EST) X001CSTICM CST ICMS Regra deve seja exclusiva para determinada CST do ICMS X001ICMS Tem ICMS? Regra deve seja exclusiva caso exista ICMS no produto/documento X001CFO CFOP Regra deve seja exclusiva para determinado CFOP ZZV_RESULT Resultado Resultado que ser\u00e1 retornado pelo filtro (c\u00f3digo da TES ou natureza ou centro de custo ou condi\u00e7\u00e3o de pagamento ou produto)"},{"location":"xmle/manuais/regras-classi/#regras-gerais","title":"Regras Gerais","text":"<ul> <li>Os campos destacados em vermelho s\u00e3o de preenchimento obrigat\u00f3rios e indicam o tipo de documento e o tipo de informa\u00e7\u00e3o (atributo) que ser\u00e1 retornado.</li> <li>Os campos destacados em azul s\u00e3o utilizados para compor o filtro inteligente em busca da informa\u00e7\u00e3o a ser retornada. </li> <li>Caso n\u00e3o deseje que filtre alguns desses campos, basta deix\u00e1-los em branco.</li> <li>Os campos com \u201c* - Todos\u201d indicam que eles n\u00e3o ser\u00e3o considerados no filtro.</li> <li>O campo \u201cCFOP\u201d poder\u00e1 ser utilizado os 3 d\u00edgitos finais do CFOP para filtro, exemplo: CFOP = 101 -&gt; Ser\u00e1 considerado para os CFOPS 1101 e 2101.</li> <li>Os campos destacados em verde cont\u00e9m o valor a ser utilizado quando os filtros corresponderem ao processo (TES, condi\u00e7\u00e3o de pagamento, natureza, centro de custo ou produto).</li> <li>O crit\u00e9rio de sele\u00e7\u00e3o do registro a ser retornado ser\u00e1 aquele que atender ao maior n\u00famero de semelhan\u00e7as com os campos de filtros.</li> <li>Em caso de empate entre duas ou mais regras, ser\u00e1 utilizado a registro mais antigo.</li> </ul>"},{"location":"xmle/manuais/regras-classi/#a-tela-de-cadastro","title":"A Tela de Cadastro","text":"<p>A tela de cadastro das Regras por Processo poder\u00e1 ser acessada no menu do Facile XML-e.</p> <p> Figura 1: Menu com a op\u00e7\u00e3o 'Regras por Processo'</p> <p>Nome da fun\u00e7\u00e3o de usu\u00e1rio: PTX0052</p> <p> Figura 2: Tela de Cadastro de Regras</p> <p> Figura 3: Tela de Cadastro</p>"},{"location":"xmle/manuais/regras-classi/#sequencias-utilizadas-para-obtencao-de-cada-atributo","title":"Sequ\u00eancias utilizadas para obten\u00e7\u00e3o de cada atributo","text":""},{"location":"xmle/manuais/regras-classi/#nfse-nota-fiscal-de-servico-eletronica","title":"NFSE: Nota Fiscal de Servi\u00e7o Eletr\u00f4nica","text":"<p>Natureza (SED) 1 \u2013 Busca na regra de processos autom\u00e1ticos 2 \u2013 Busca no cadastro do cliente/fornecedor (A1/A2_NATUREZ)</p> <p>Condi\u00e7\u00e3o de Pagamento (SE4) 1 \u2013 Busca do pedido de compra (C7_COND) 2 \u2013 Busca na regra de processos autom\u00e1ticos</p> <p>Produto (SB1) 1 \u2013 Busca da amarra\u00e7\u00e3o produto x fornecedor Facile (ZZW) 2 \u2013 Busca na regra de processos autom\u00e1ticos</p> <p>TES (SF4) 1 \u2013 Busca na regra de processos autom\u00e1ticos 2 \u2013 Busca da TES inteligente (tipo de opera\u00e7\u00e3o do par\u00e2metro ZZ_OPERNFS) 3 \u2013 Busca do Pedido de Compra (C7_TES) 4 \u2013 Busca do produto (B1_TE)</p> <p>Centro de Custo (CTT) 1 \u2013 Busca do pedido de compra (C7_CC) 2 \u2013 Busca na regra de processos autom\u00e1ticos 3 \u2013 Busca do produto (B1_CC)</p> <p></p>"},{"location":"xmle/manuais/regras-classi/#ctev-ct-e-de-venda","title":"CTEV: CT-e de Venda","text":"<p>Natureza (SED) 1 \u2013 Busca na regra de processos autom\u00e1ticos 2 \u2013 Busca no cadastro do cliente/fornecedor (A1/A2_NATUREZ)</p> <p>Condi\u00e7\u00e3o de Pagamento (SE4) 1 \u2013 Busca do pedido de compra (C7_COND) 2 \u2013 Busca na regra de processos autom\u00e1ticos 3 \u2013 Busca no cadastro do cliente/fornecedor (A1/A2_COND)</p> <p>Produto (SB1) 1 \u2013 Busca do par\u00e2metro ZZ_PRODCTE 2 \u2013 Busca na regra de processos autom\u00e1ticos</p> <p>TES (SF4) 1 \u2013 Busca do par\u00e2metro ZZ_TESCTE 2 \u2013 Busca na regra de processos autom\u00e1ticos 3 \u2013 Busca da TES inteligente (tipo de opera\u00e7\u00e3o do par\u00e2metro ZZ_OPECTEV) 4 \u2013 Busca do Pedido de Compra (C7_TES) 5 \u2013 Busca do produto (B1_TE)</p> <p>Centro de Custo (CTT) 1 \u2013 Busca do pedido de compra (C7_CC) 2 \u2013 Busca na regra de processos autom\u00e1ticos 3   \u2013 Busca do produto (B1_CC)</p> <p></p>"},{"location":"xmle/manuais/regras-classi/#ctec-ct-e-de-compra","title":"CTEC: CT-e de Compra","text":"<p>Natureza (SED) 1 \u2013 Busca na regra de processos autom\u00e1ticos 2 \u2013 Busca da Nota Fiscal de Entrada referenciada (primeira NF do CTE) 3 \u2013 Busca no cadastro do cliente/fornecedor (A1/A2_NATUREZ)</p> <p>Condi\u00e7\u00e3o de Pagamento (SE4) 1 \u2013 Busca do pedido de compra (C7_COND) 2 \u2013 Busca na regra de processos autom\u00e1ticos 3 \u2013 Busca no cadastro do cliente/fornecedor (A1/A2_COND)</p> <p>Produto (SB1) - De acordo com a NF referenciada</p> <p>TES (SF4) 1 \u2013 Busca do par\u00e2metro ZZ_TESCTEC 2 \u2013 Busca na regra de processos autom\u00e1ticos 3 \u2013 Busca da TES inteligente (tipo de opera\u00e7\u00e3o do par\u00e2metro ZZ_OPECTEV) 4 \u2013 Busca do Pedido de Compra (C7_TES) 5 \u2013 Busca do produto (B1_TE)</p> <p>Centro de Custo (CTT) - De acordo com a NF referenciada</p> -FIM-"},{"location":"xmle/manuais/webservice/","title":"14 - Configura\u00e7\u00e3o do Webservice Checkdoc","text":""},{"location":"xmle/manuais/webservice/#manual-de-configuracao-do-webservice-checkdoc","title":"Manual de configura\u00e7\u00e3o do Webservice Checkdoc","text":""},{"location":"xmle/manuais/webservice/#introducao","title":"Introdu\u00e7\u00e3o","text":"<p>O objetivo de configurar um Webservice para o CheckDoc \u00e9 realizar uma an\u00e1lise AUTOM\u00c1TICA do XML recebido do Sefaz e verificar no ERP Protheus\u00ae se as informa\u00e7\u00f5es contidas nele est\u00e3o corretas.</p> <p>Ser\u00e1 verificado:</p> <ul> <li>Abertura do HTML do Checkdoc por link no e-mail;</li> </ul>"},{"location":"xmle/manuais/webservice/#como-usar","title":"Como usar?","text":"<p>Ap\u00f3s a configura\u00e7\u00e3o, ser\u00e1 enviado automaticamente para o(s) e-mail(s) cadastrado(s) no par\u00e2metro: ZZ_ECKDOC - Par\u00e2metros com e-mails separados por (;)</p>"},{"location":"xmle/manuais/webservice/#detalhamento-dos-servicos-observacoes","title":"Detalhamento dos Servi\u00e7os / Observa\u00e7\u00f5es","text":"<p>Atividades inclu\u00eddas:</p> <ul> <li> <p>Viabilizar a abertura e exibi\u00e7\u00e3o das informa\u00e7\u00f5es registradas com base na execu\u00e7\u00e3o, atrav\u00e9s do hyperlink que passa a ser formatado sob a chave que corresponde \u00e0 uma das colunas do e-mail com as informa\u00e7\u00f5es, da apura\u00e7\u00e3o checkdoc.</p> </li> <li> <p>Agregar \u00e0s informa\u00e7\u00f5es do e-mail de diverg\u00eancia emitido p\u00f3s apura\u00e7\u00e3o checkdoc. </p> </li> </ul>"},{"location":"xmle/manuais/webservice/#informacoes-tecnicas-relevantes","title":"Informa\u00e7\u00f5es t\u00e9cnicas relevantes","text":"<p>Par\u00e2metros envolvidos:</p> <ul> <li>ZZ_PATHWS - Par\u00e2metro para registro do path no Protheus_Data, do webservice, onde ser\u00e3o gerados os arquivos. </li> </ul> <p>Exemplo: \\web\\facile_checkdoc</p> <ul> <li>ZZ_DFWEBS - Par\u00e2metro para registro da url do servi\u00e7o HTTP/HTTPS do Protheus, direcionado \u00e0 pasta onde estar\u00e3o salvos os arquivos e que ser\u00e1 utilizado para carga do arquivo em navegador web (browse). </li> </ul> <p>Exemplo: http://192.168.200.171:8079/facile_checkdoc/</p> <ul> <li>ZZ_ECKDOC - Par\u00e2metros com e-mails que ir\u00e3o receber, separados por (;)</li> </ul> <p>Exemplo: compras@nomedaempresa.com.br;outroemail@nomedoemail.com.br </p> <p>ATEN\u00c7\u00c3O: \u00c9 necess\u00e1rio que a funcionalidade HTTP do Protheus esteja configurada e em execu\u00e7\u00e3o para o correto funcionamento dessa rotina.</p>"},{"location":"xmle/manuais/webservice/#configuracao-do-webservice-checkdoc","title":"Configura\u00e7\u00e3o do webservice Checkdoc","text":""},{"location":"xmle/manuais/webservice/#appserver_facileini","title":"Appserver_FACILE.ini","text":"<p>Incluir no servi\u00e7o Appserver.ini destinado ao FACILE XML-e (normalmente nomeado como appserver_Facile.ini, Appserver01...), na pasta do servi\u00e7o do Facile XML-e, o job PTXJ005.</p> <p>Ex. (em vermelho)</p> <p>AppServer01:</p> <pre><code>;;Job Respons\u00e1vel pelo Workflow do Checkdoc\n[PTXJ005]\nMAIN=U_PTXJ005\nENVIRONMENT=FACILE\nnparms=2\nParm1=01\nParm2=0101\n\n;;Tag respons\u00e1vel por inicializar e controlar os jobs\n[ONSTART]\nJOBS=PTXJ001,PTXJ003,PTXJ008,PTXJ005\nREFRESHRATE=4000\n</code></pre> <p>O que significa cada TAG?</p> <p>ENVIRONMENT     =&gt; Ambiente que o JOB ser\u00e1 executado                                 MAIN            =&gt; Nome do programa a ser chamado                                    nparms          =&gt; Quantidade de par\u00e2metro a serem utilizados                        Parm1           =&gt; Informe o c\u00f3digo da Empresa                                       Parm2           =&gt; Informe o c\u00f3digo da Filial                                        REFRESHRATE     =&gt; Intervalo de tempo, em segundos, para que o Job seja executado   </p> <p>Com base na execu\u00e7\u00e3o da rotina JOB, integrante do FACILE XML-e, para apura\u00e7\u00e3o de diverg\u00eancias nos registros identificados, passa a ser formatado um arquivo contendo as informa\u00e7\u00f5es da apura\u00e7\u00e3o.</p> <p>Este arquivo \u00e9 registrado em diret\u00f3rio espec\u00edfico ligado ao webservice \u2013 Protheus\u00ae.</p> <p> Figura 01: Diret\u00f3rio Webservice</p> <p>Ao receber o e-mail contendo as informa\u00e7\u00f5es de diverg\u00eancia, passe-se a observar e ter a a\u00e7\u00e3o de click na coluna: Chave.</p> <p>Ao clicar na informa\u00e7\u00e3o, ser\u00e1 aberto \u2013 em navegador WEB (browse), o arquivo contendo as informa\u00e7\u00f5es apuradas.</p> <p> Figura 02: Diverg\u00eancia encontrada</p> <p>Ao clicar em um dos links abrir\u00e1 sua consulta:</p> <p> Figura 03: Consulta da diverg\u00eancia</p>"},{"location":"xmle/manuais/webservice/#workflow-de-notificacao-checkdoc","title":"Workflow de notifica\u00e7\u00e3o Checkdoc","text":""},{"location":"xmle/manuais/webservice/#resumo","title":"Resumo","text":"<ol> <li>Enviar workflow com todas as chaves que est\u00e3o com diverg\u00eancia no CheckDoc e ainda n\u00e3o foram corrigidas;</li> <li>Criar par\u00e2metro para definir data inicial da busca.</li> </ol>"},{"location":"xmle/manuais/webservice/#detalhamento-dos-servicos","title":"Detalhamento dos Servi\u00e7os","text":"<p>Atividades inclu\u00eddas</p> <ul> <li>Possibilitar que os usu\u00e1rios envolvidos sejam constantemente lembrados dos problemas nas notas fiscais que precisam ser corrigidos</li> </ul>"},{"location":"xmle/manuais/webservice/#informacoes-tecnicas-relevantes_1","title":"Informa\u00e7\u00f5es t\u00e9cnicas / Relevantes","text":"<p>Par\u00e2metros envolvidos:</p> <ul> <li>ZZ_CHKRETR - Par\u00e2metro num\u00e9rico informando a quantidade de dias ser\u00e1 retrocedido para buscar as notas fiscais que continuam com falha no CheckDoc.</li> </ul> <p>Exemplo: 30</p>"},{"location":"xmle/manuais/webservice/#passo-a-passo","title":"Passo a passo","text":"<p>O workflow ser\u00e1 enviado atrav\u00e9s do job PTXJ005, que hoje j\u00e1 \u00e9 utilizado para realizar a primeira checagem do CheckDoc das notas fiscais baixadas do Sefaz.</p> <p>Para desativar o envio do workflow basta configurar o par\u00e2metro ZZ_CHKRETR com o valor 0 (zero).</p> -FIM-"},{"location":"xmle/manuais/xml-email/","title":"16 - Importar XML por e-mail","text":""},{"location":"xmle/manuais/xml-email/#importar-xml-por-e-mail","title":"Importar XML por e-mail","text":""},{"location":"xmle/manuais/xml-email/#wizard-de-configuracao","title":"Wizard de Configura\u00e7\u00e3o","text":"<p>Toda a configura\u00e7\u00e3o da ferramenta \u00e9 realizada atrav\u00e9s de um \u00fanico wizard, onde apenas os usu\u00e1rios do grupo de administradores do ERP possuem acesso.</p> <p>O acesso ao wizard se encontra na rotina principal da ferramenta, a Central XML-e (PTX0001).</p>"},{"location":"xmle/manuais/xml-email/#configuracao","title":"Configura\u00e7\u00e3o","text":"<p>Ao abrir o wizard de configura\u00e7\u00e3o, clique em \u201cAvan\u00e7ar\u201d na tela de Bem-vindo para acessar a primeira p\u00e1gina da configura\u00e7\u00e3o.</p> <p>Vamos as op\u00e7\u00f5es:</p> <p> Figura 1: Wizard de Configura\u00e7\u00e3o</p> <p>Clique em avan\u00e7ar.</p> <p>Configurar a Importa\u00e7\u00e3o do certificado digital para comunica\u00e7\u00e3o com o SEFAZ.</p> <p> Figura 2: Importa\u00e7\u00e3o do Certificado Digital</p> <p>Informe o caminho do arquivo do certificado digital (.PFX) e a sua senha de autentica\u00e7\u00e3o, processo parecido com o realizado na configura\u00e7\u00e3o do TSS.</p> <p>Caso n\u00e3o possua o .PFX ou tenha alguma dificuldade na importa\u00e7\u00e3o do certificado digital, poder\u00e1 ser utilizado os arquivo \u201c.PEM\u201d gerados pelo TSS, bastando informar o caminho dos arquivos nos seguintes par\u00e2metros:</p> <p>ZZ_CERTKEY: Caminho para o arquivo \u201ckey.pem\u201d no Protheus_Data.     Exemplo: \\FACILE\\9901_key.pem</p> <p>ZZ_CERTPRI: Caminho para o arquivo \u201ccert.pem\u201d no Protheus_Data.     Exemplo: \\FACILE\\9901_cert.pem</p> <p>ZZ_CERTCA: Caminho para o arquivo \u201cca.pem\u201d no Protheus_Data.     Exemplo: \\FACILE\\9901_ca.pem</p> <p>Clique em avan\u00e7ar.</p> <p> Figura 3: Configura\u00e7\u00e3o de monitoramento de e-mail</p> <p>Nesta p\u00e1gina ser\u00e1 poss\u00edvel configurar a busca do XML diretamente de um endere\u00e7o de e-mail, com isso a ferramenta ir\u00e1 realizar a busca de novas NF-e tanto o Sefaz, quanto o endere\u00e7o de e-mail.</p> <p>ZZ_MAILXML: Ativa a busca por XML no endere\u00e7o de e-mail.</p> <p>ZZ_POPEND: Informe o endere\u00e7o do Servidor POP do e-mail a ser monitorado (requer o par\u00e2metro ZZ_MAILXML ativado).</p> <p>ZZ_POPCNT: Informe o login para autentica\u00e7\u00e3o no Servidor POP do e-mail a ser monitorado (requer o par\u00e2metro ZZ_MAILXML ativado).</p> <p>ZZ_POPPSW: Informe a senha para autentica\u00e7\u00e3o no Servidor POP do e-mail a ser monitorado (requer o par\u00e2metro ZZ_MAILXML ativado).</p> <p>ZZ_POPSSL: Ative esse par\u00e2metro caso o Servidor POP utilize conex\u00e3o segura para autentica\u00e7\u00e3o (requer o par\u00e2metro ZZ_MAILXML ativado).</p> <p>ZZ_DELMAIL: Ative esse par\u00e2metro caso deseje que o e-mail seja exclu\u00eddo da caixa de entrada ap\u00f3s a importa\u00e7\u00e3o do mesmo (requer o par\u00e2metro ZZ_MAILXML ativado).</p> <p>Conclu\u00eddo.</p> <p>Recomendamos fechar o ERP e abrir novamente para que todas as altera\u00e7\u00f5es sejam efetivadas.</p>"},{"location":"xmle/manuais/xml-email/#particularidades-do-gmail","title":"Particularidades do Gmail","text":"<p>Para utiliza\u00e7\u00e3o do Gmail na aplica\u00e7\u00e3o de busca e-mail, \u00e9 necess\u00e1rio ter em mente que \u00e9 necess\u00e1rio realizar uma configura\u00e7\u00e3o distinta, mas que j\u00e1 consta documenta\u00e7\u00e3o na TOTVS. Segue abaixo a documenta\u00e7\u00e3o que trata a respeito da configura\u00e7\u00e3o do Gmail para o servi\u00e7o de importar XML por e-mail.</p> <p>Application Server - Uso de e-mail com GMail</p>"},{"location":"xmle/manuais/xml-email/#utilizacao","title":"Utiliza\u00e7\u00e3o","text":"<p>Atrav\u00e9s do Central XML-e, v\u00e1 em Outras A\u00e7\u00f5es/Buscar Xml e-mail. O sistema ir\u00e1 automaticamente baixar de acordo com o e-mail que foi configurado.</p> <p> Figura 4: Op\u00e7\u00e3o de Buscar Xml por E-mail</p> -FIM-"},{"location":"xmle/manuais/xml-sem-entrada/","title":"07 - Filtro de XML sem nota de entrada","text":""},{"location":"xmle/manuais/xml-sem-entrada/#filtro-de-xml-sem-nota-de-entrada","title":"Filtro de XML sem nota de entrada","text":""},{"location":"xmle/manuais/xml-sem-entrada/#criar-filtro-de-xml-sem-nota-de-entrada","title":"Criar filtro de XML sem nota de entrada","text":"<p>Na tela principal do FACILE central XML-e, clique na op\u00e7\u00e3o \u201cFiltrar\u201d no canto superior direito conforme destacado na imagem abaixo:</p> <p> Figura 1: Op\u00e7\u00e3o de Filtrar</p> <p>Na janela que abriu, clique em: \u201cCriar Filtro\u201d:</p> <p> Figura 2: Criar Filtro</p> <p>Na tela de filtros, configure conforme os passos destacados na imagem abaixo:</p> <p> Figura 3: Adicionar Filtro</p> <p>Marque a legenda criada, vai em \u201cOutras A\u00e7\u00f5es\u201d e clique em \u201cSalvar\u201d. Ap\u00f3s isso clique em \u201cAplicar filtros selecionados\u201d.</p> <p> Figura 4: Aplicar Filtro</p> -FIM-"}]}